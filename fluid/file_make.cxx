//
// "$Id: file.cxx 8870 2011-07-26 21:19:35Z matt $"
//
// Fluid file routines for the Fast Light Tool Kit (FLTK).
//
// You may find the basic read_* and write_* routines to
// be useful for other programs.  I have used them many times.
// They are somewhat similar to tcl, using matching { and }
// to quote strings.
//
// Copyright 1998-2010 by Bill Spitzak and others.
//
// This library is free software; you can redistribute it and/or
// modify it under the terms of the GNU Library General Public
// License as published by the Free Software Foundation; either
// version 2 of the License, or (at your option) any later version.
//
// This library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
// Library General Public License for more details.
//
// You should have received a copy of the GNU Library General Public
// License along with this library; if not, write to the Free Software
// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307
// USA.
//
// Please report all bugs and problems on the following page:
//
//     http://www.fltk.org/str.php
//

#include <stdio.h>
#include <stdlib.h>
#include <stdarg.h>
#include <ctype.h>
#include "Fl_Type.h"
#include "../fltk3/filename.h"

// ------------ file conversion ------------------------------------------------

extern const char *filename;

static int write_file(FILE *out, Fl_File_Type *file, const char *src_path, const char *tgt_path, const char *ext=0L) {
  char src[2048], tgt[2048];
  strcpy(src, src_path); strcat(src, file->filename());
  fltk3::filename_relative(tgt, 2048, src, tgt_path);
  if (ext) fltk3::filename_setext(tgt, 2048, ext);
  fprintf(out, "%s", tgt);
  return 0;
}

char target_has_cplusplus_code(Fl_Target_Type *tgt) {
  for (Fl_File_Type *file = Fl_File_Type::first_file(tgt); file; file = file->next_file(tgt)) {
    if (file->builds_in(FL_ENV_MAKE) && file->file_is_cplusplus_code())
      return 1;
  }
  return 0;
}

char target_has_c_code(Fl_Target_Type *tgt) {
  for (Fl_File_Type *file = Fl_File_Type::first_file(tgt); file; file = file->next_file(tgt)) {
    if (file->builds_in(FL_ENV_MAKE) && file->file_is_c_code())
      return 1;
  }
  return 0;
}

char target_has_objc_code(Fl_Target_Type *tgt) {
  for (Fl_File_Type *file = Fl_File_Type::first_file(tgt); file; file = file->next_file(tgt)) {
    if (file->builds_in(FL_ENV_MAKE) && file->file_is_objc_code())
      return 1;
  }
  return 0;
}

static int write_makeinclude_in(FILE *out, Fl_Workspace_Type *workspace, const char *path, const char *base_dir, const char *tgt_base, Fl_Target_Type *first_target) {
  fprintf(out, "#\n");
  fprintf(out, "# \"$Id: makeinclude.in 8740 2011-05-26 14:43:46Z matt $\"\n");
  fprintf(out, "#\n");
  fprintf(out, "# Make include file for the Fast Light Tool Kit (FLTK).\n");
  fprintf(out, "#\n");
  fprintf(out, "# Copyright 1998-2010 by Bill Spitzak and others.\n");
  fprintf(out, "#\n");
  fprintf(out, "# This library is free software; you can redistribute it and/or\n");
  fprintf(out, "# modify it under the terms of the GNU Library General Public\n");
  fprintf(out, "# License as published by the Free Software Foundation; either\n");
  fprintf(out, "# version 2 of the License, or (at your option) any later version.\n");
  fprintf(out, "#\n");
  fprintf(out, "# This library is distributed in the hope that it will be useful,\n");
  fprintf(out, "# but WITHOUT ANY WARRANTY; without even the implied warranty of\n");
  fprintf(out, "# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n");
  fprintf(out, "# Library General Public License for more details.\n");
  fprintf(out, "#\n");
  fprintf(out, "# You should have received a copy of the GNU Library General Public\n");
  fprintf(out, "# License along with this library; if not, write to the Free Software\n");
  fprintf(out, "# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307\n");
  fprintf(out, "# USA.\n");
  fprintf(out, "#\n");
  fprintf(out, "# Please report all bugs and problems on the following page:\n");
  fprintf(out, "#\n");
  fprintf(out, "#      http://www.fltk.org/str.php\n");
  fprintf(out, "#\n");
  fprintf(out, "\n");
  fprintf(out, "prefix\t\t= @prefix@\n");
  fprintf(out, "exec_prefix\t= @exec_prefix@\n");
  fprintf(out, "bindir\t\t= @bindir@\n");
  fprintf(out, "datadir\t\t= @datadir@\n");
  fprintf(out, "datarootdir\t= @datarootdir@\n");
  fprintf(out, "includedir\t= @includedir@\n");
  fprintf(out, "libdir\t\t= @libdir@\n");
  fprintf(out, "mandir\t\t= @mandir@\n");
  fprintf(out, "srcdir\t\t= @srcdir@\n");
  fprintf(out, "docdir\t\t= $(datadir)/doc/fltk\n");
  fprintf(out, "VPATH\t\t= @srcdir@\n");
  fprintf(out, "USEMMFILES  = @USEMMFILES@\n");
  fprintf(out, "# programs we use...\n");
  fprintf(out, "HTMLDOC\t\t= @HTMLDOC@\n");
  fprintf(out, "DOXYDOC\t\t= @DOXYDOC@\n");
  fprintf(out, "INSTALL\t\t= @INSTALL@\n");
  fprintf(out, "LN\t\t= ln -s\n");
  fprintf(out, "NROFF\t\t= @NROFF@\n");
  fprintf(out, "RM\t\t= rm -f\n");
  fprintf(out, "RMDIR\t\t= rm -rf\n");
  fprintf(out, "SHELL\t\t= /bin/sh\n");
  fprintf(out, "STRIP\t\t= strip\n");
  fprintf(out, "\n");
  fprintf(out, "# compiler names:\n");
  fprintf(out, "CXX\t\t= @CXX@\n");
  fprintf(out, "CC\t\t= @CC@\n");
  fprintf(out, "MAKEDEPEND\t= @MAKEDEPEND@\n");
  fprintf(out, "\n");
  fprintf(out, "# (Windows) resource compiler\n");
  fprintf(out, "RC\t\t= @RC@\n");
  fprintf(out, "\n");
  fprintf(out, "# flags for C++ compiler:\n");
  fprintf(out, "ARCHFLAGS\t= @ARCHFLAGS@\n");
  fprintf(out, "OPTIM\t\t= @OPTIM@\n");
  fprintf(out, "CFLAGS\t\t= $(OPTIM) @LARGEFILE@ @PTHREAD_FLAGS@ @CPPFLAGS@ @CFLAGS@\n");
  fprintf(out, "CXXFLAGS\t= $(OPTIM) @LARGEFILE@ @PTHREAD_FLAGS@ @CPPFLAGS@ @CXXFLAGS@ $(FLTKFLAGS)\n");
  fprintf(out, "\n");
  fprintf(out, "# program to make the archive:\n");
  fprintf(out, "LIBNAME\t\t= @LIBNAME@\n");
  fprintf(out, "FLLIBNAME\t= @FLLIBNAME@\n");
  fprintf(out, "GLLIBNAME\t= @GLLIBNAME@\n");
  fprintf(out, "IMGLIBNAME\t= @IMGLIBNAME@\n");
  fprintf(out, "CAIROLIBNAME\t= @CAIROLIBNAME@\n");
  fprintf(out, "LIBCOMMAND\t= @LIBCOMMAND@\n");
  fprintf(out, "LIBEXT\t\t= @LIBEXT@\n");
  fprintf(out, "RANLIB\t\t= @RANLIB@\n");
  fprintf(out, "DSONAME\t\t= @DSONAME@\n");
  fprintf(out, "FLDSONAME\t= @FLDSONAME@\n");
  fprintf(out, "GLDSONAME\t= @GLDSONAME@\n");
  fprintf(out, "IMGDSONAME\t= @IMGDSONAME@\n");
  fprintf(out, "CAIRODSONAME\t= @CAIRODSONAME@\n");
  fprintf(out, "DSOCOMMAND\t= @DSOCOMMAND@\n");
  fprintf(out, "\n");
  fprintf(out, "LIBBASENAME\t= @LIBBASENAME@\n");
  fprintf(out, "FLLIBBASENAME\t= @FLLIBBASENAME@\n");
  fprintf(out, "GLLIBBASENAME\t= @GLLIBBASENAME@\n");
  fprintf(out, "IMGLIBBASENAME\t= @IMGLIBBASENAME@\n");
  fprintf(out, "CAIROLIBBASENAME= @CAIROLIBBASENAME@\n");
  fprintf(out, "\n");
  fprintf(out, "# libraries to link with:\n");
  fprintf(out, "AUDIOLIBS\t= @AUDIOLIBS@\n");
  fprintf(out, "CAIROLIBS\t= @CAIROLIBS@\n");
  fprintf(out, "CAIROFLAGS\t= @CAIROFLAGS@\n");
  fprintf(out, "DSOFLAGS\t= -L. @DSOFLAGS@\n");
  fprintf(out, "LDFLAGS\t\t= $(OPTIM) @LDFLAGS@\n");
  fprintf(out, "LDLIBS\t\t= @LIBS@\n");
  fprintf(out, "GLDLIBS\t\t= @GLLIB@ @LIBS@\n");
  fprintf(out, "LINKFLTK\t= @LINKFLTK@\n");
  fprintf(out, "LINKFLTKGL\t= @LINKFLTKGL@\n");
  fprintf(out, "LINKFLTKIMG\t= @LINKFLTKIMG@ @LINKFLTK@ $(IMAGELIBS)\n");
  fprintf(out, "LINKFLTKCAIRO\t= @LINKFLTKCAIRO@ $(CAIROLIBS)\n");
  fprintf(out, "FLTKCAIROOPTION = @FLTKCAIROOPTION@\n");
  fprintf(out, "LINKSHARED\t= @DSOLINK@ @LINKSHARED@ $(IMAGELIBS) $(CAIROLIBS)\n");
  fprintf(out, "IMAGELIBS\t= -L../lib @IMAGELIBS@\n");
  fprintf(out, "\n");
  fprintf(out, "# image libraries to build...\n");
  fprintf(out, "IMAGEDIRS\t= @JPEG@ @ZLIB@ @PNG@\n");
  fprintf(out, "CAIRODIR\t= @CAIRODIR@\n");
  fprintf(out, "# The extension to use for executables...\n");
  fprintf(out, "EXEEXT\t\t= @EXEEXT@\n");
  fprintf(out, "\n");
  fprintf(out, "# Do we build the OpenGL demos?\n");
  fprintf(out, "GLDEMOS\t\t= @GLDEMOS@\n");
  fprintf(out, "\n");
  fprintf(out, "# Do we build the threads demo?\n");
  fprintf(out, "THREADS\t\t= @THREADS@\n");
  fprintf(out, "\n");
  fprintf(out, "# Name of FLUID executable we install\n");
  fprintf(out, "FLUID\t\t= @FLUID@$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "# Possible steps for OS X build only\n");
  fprintf(out, "OSX_ONLY\t= @OSX_ONLY@\n");
  fprintf(out, "\n");
  fprintf(out, "# Man page extensions...\n");
  fprintf(out, "CAT1EXT\t\t= @CAT1EXT@\n");
  fprintf(out, "CAT3EXT\t\t= @CAT3EXT@\n");
  fprintf(out, "CAT6EXT\t\t= @CAT6EXT@\n");
  fprintf(out, "\n");
  fprintf(out, "#\n");
  fprintf(out, "# Installation programs...\n");
  fprintf(out, "#\n");
  fprintf(out, "\n");
  fprintf(out, "INSTALL_BIN\t= $(INSTALL) -m 755\n");
  fprintf(out, "INSTALL_DATA\t= $(INSTALL) -m 644\n");
  fprintf(out, "INSTALL_DIR\t= $(INSTALL) -d \n");
  fprintf(out, "INSTALL_LIB\t= $(INSTALL) -m 755\n");
  fprintf(out, "INSTALL_MAN\t= $(INSTALL) -m 644\n");
  fprintf(out, "INSTALL_SCRIPT\t= $(INSTALL) -m 755\n");
  fprintf(out, "\n");
  fprintf(out, "# Additional GUI install/uninstall targets...\n");
  fprintf(out, "INSTALL_DESKTOP\t= @INSTALL_DESKTOP@\n");
  fprintf(out, "UNINSTALL_DESKTOP = @UNINSTALL_DESKTOP@\n");
  fprintf(out, "\n");
  fprintf(out, "# Be quiet when building...\n");
  fprintf(out, ".SILENT:\n");
  fprintf(out, "\n");
  fprintf(out, "# Build commands and filename extensions...\n");
  fprintf(out, ".SUFFIXES:\t.0 .1 .3 .6 .c .cxx .mm .h .fl .man .o .z $(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, ".o$(EXEEXT):\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) $< $(LINKFLTK) $(LDLIBS) -o $@\n");
  fprintf(out, "\n");
  fprintf(out, ".c.o:\n");
  fprintf(out, "\techo Compiling $<...\n");
  fprintf(out, "\t$(CC) -I.. $(ARCHFLAGS) @PNGINC@ @JPEGINC@ @ZLIBINC@ $(CFLAGS) -c $< -o $@\n");
  fprintf(out, "\n");
  fprintf(out, ".cxx.o:\n");
  fprintf(out, "\techo Compiling $<...\n");
  fprintf(out, "\t$(CXX) -I.. $(ARCHFLAGS) @PNGINC@ @JPEGINC@ @ZLIBINC@ $(CXXFLAGS) -c $< -o $@\n");
  fprintf(out, "\t\n");
  fprintf(out, ".mm.o:\n");
  fprintf(out, "\techo Compiling $<...\n");
  fprintf(out, "\t$(CXX) -I.. $(ARCHFLAGS) $(CXXFLAGS) -x objective-c++ -c $< -o $@\n");
  fprintf(out, "\n");
  fprintf(out, "\n");
  fprintf(out, ".man.0 .man.1 .man.3 .man.6:\n");
  fprintf(out, "\techo Formatting $<...\n");
  fprintf(out, "\trm -f $@\n");
  fprintf(out, "\t$(NROFF) -man $< >$@\n");
  fprintf(out, "\n");
  fprintf(out, ".man.z:\n");
  fprintf(out, "\techo Formatting $<...\n");
  fprintf(out, "\trm -f $@ t.z\n");
  fprintf(out, "\t$(NROFF) -man $< >t\n");
  fprintf(out, "\tpack -f t\n");
  fprintf(out, "\tmv t.z $@\n");
  fprintf(out, "\n");
  fprintf(out, "#\n");
  fprintf(out, "# End of \"$Id: makeinclude.in 8740 2011-05-26 14:43:46Z matt $\".\n");
  fprintf(out, "#\n");
  return 0;
}

static int write_configure_in(FILE *out, Fl_Workspace_Type *workspace, const char *path, const char *base_dir, const char *tgt_base, Fl_Target_Type *first_target) {
  fprintf(out, "dnl -*- sh -*-\n");
  fprintf(out, "dnl the \"configure\" script is made from this by running GNU \"autoconf\"\n");
  fprintf(out, "dnl\n");
  fprintf(out, "dnl \"$Id: configure.in 8740 2011-05-26 14:43:46Z matt $\"\n");
  fprintf(out, "dnl\n");
  fprintf(out, "dnl Configuration script for the Fast Light Tool Kit (FLTK).\n");
  fprintf(out, "dnl\n");
  fprintf(out, "dnl Copyright 1998-2010 by Bill Spitzak and others.\n");
  fprintf(out, "dnl\n");
  fprintf(out, "dnl This library is free software; you can redistribute it and/or\n");
  fprintf(out, "dnl modify it under the terms of the GNU Library General Public\n");
  fprintf(out, "dnl License as published by the Free Software Foundation; either\n");
  fprintf(out, "dnl version 2 of the License, or (at your option) any later version.\n");
  fprintf(out, "dnl\n");
  fprintf(out, "dnl This library is distributed in the hope that it will be useful,\n");
  fprintf(out, "dnl but WITHOUT ANY WARRANTY; without even the implied warranty of\n");
  fprintf(out, "dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n");
  fprintf(out, "dnl Library General Public License for more details.\n");
  fprintf(out, "dnl\n");
  fprintf(out, "dnl You should have received a copy of the GNU Library General Public\n");
  fprintf(out, "dnl License along with this library; if not, write to the Free Software\n");
  fprintf(out, "dnl Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307\n");
  fprintf(out, "dnl USA.\n");
  fprintf(out, "dnl\n");
  fprintf(out, "dnl Please report all bugs and problems on the following page:\n");
  fprintf(out, "dnl\n");
  fprintf(out, "dnl      http://www.fltk.org/str.php\n");
  fprintf(out, "dnl\n");
  fprintf(out, "\n");
  fprintf(out, "dnl We need at least autoconf 2.50...\n");
  fprintf(out, "AC_PREREQ(2.50)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Required file in package...\n");
  fprintf(out, "AC_INIT(src/Fl.cxx)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl So --with-archflags option is used during \"checking size of long\"\n");
  fprintf(out, "if test `uname` = Darwin; then\n");
  fprintf(out, "  if test \"x$with_archflags\" != x ; then\n");
  fprintf(out, "    CFLAGS=\"$CFLAGS $with_archflags\"\n");
  fprintf(out, "  fi\n");
  fprintf(out, "  USEMMFILES=\"Yes\"\n");
  fprintf(out, "else\n");
  fprintf(out, "  USEMMFILES=\"No\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "AC_SUBST(USEMMFILES)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl FLTK library versions...\n");
  fprintf(out, "FL_MAJOR_VERSION=1\n");
  fprintf(out, "FL_MINOR_VERSION=3\n");
  fprintf(out, "FL_PATCH_VERSION=0\n");
  fprintf(out, "FL_API_VERSION=${FL_MAJOR_VERSION}.${FL_MINOR_VERSION}\n");
  fprintf(out, "\n");
  fprintf(out, "AC_SUBST(FL_MAJOR_VERSION)\n");
  fprintf(out, "AC_SUBST(FL_MINOR_VERSION)\n");
  fprintf(out, "AC_SUBST(FL_PATCH_VERSION)\n");
  fprintf(out, "AC_SUBST(FL_API_VERSION)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Get the operating system and version number...\n");
  fprintf(out, "uname=`uname`\n");
  fprintf(out, "uversion=`uname -r | sed -e '1,$s/[[^0-9]]//g'`\n");
  fprintf(out, "if test \"x$uname\" = xIRIX64; then\n");
  fprintf(out, "    uname=\"IRIX\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "if test \"x$uname\" = x; then\n");
  fprintf(out, "    # Older MinGW doesn't provide any output when uname is run, even with \"-s\".\n");
  fprintf(out, "    # Current MinGW (as of Jan. 2011) however does, so this is not necessary anymore...\n");
  fprintf(out, "    uname=\"MINGW\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Do not automatically add \"-g\" to compiler options...\n");
  fprintf(out, "ARCHFLAGS=\"${ARCHFLAGS:=}\"\n");
  fprintf(out, "CFLAGS=\"${CFLAGS:=}\"\n");
  fprintf(out, "CPPFLAGS=\"${CPPFLAGS:=}\"\n");
  fprintf(out, "CXXFLAGS=\"${CXXFLAGS:=}\"\n");
  fprintf(out, "DSOFLAGS=\"${DSOFLAGS:=}\"\n");
  fprintf(out, "LDFLAGS=\"${LDFLAGS:=}\"\n");
  fprintf(out, "OPTIM=\"${OPTIM:=}\"\n");
  fprintf(out, "\n");
  fprintf(out, "AC_SUBST(ARCHFLAGS)\n");
  fprintf(out, "AC_SUBST(OPTIM)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl in case of cross-compiling mingw32 under linux we must change uname for Win32 GUI\n");
  fprintf(out, "dnl run ./configure --host=i686-pc-ming32 try use X11 without change uname\n");
  fprintf(out, "if test \"x$cross_compiling\" != xno ; then\n");
  fprintf(out, "  case $host_alias in\n");
  fprintf(out, "    *mingw*)\n");
  fprintf(out, "    uname=MINGW\n");
  fprintf(out, "    ;;\n");
  fprintf(out, "  esac\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "dnl OS-specific pre-tests...\n");
  fprintf(out, "dnl uname_GUI equals $uname unless we target Cygwin in combination with X11.\n");
  fprintf(out, "uname_GUI=$uname\n");
  fprintf(out, "case $uname in\n");
  fprintf(out, "    CYGWIN*)\n");
  fprintf(out, "        # Handle Cygwin option *first*, before all other tests.\n");
  fprintf(out, "\tAC_ARG_ENABLE(cygwin, [  --enable-cygwin         use the Cygwin libraries [(default=no)]])\n");
  fprintf(out, "\tAC_ARG_ENABLE(x11,    [  --enable-x11            use Cygwin with X11 [(default=no)]])\n");
  fprintf(out, "\tif test x$enable_cygwin != xyes; then\n");
  fprintf(out, "\t    # NOTE: We can't use ARCHFLAGS for this, since it does not work\n");
  fprintf(out, "\t    #       with some of the function tests - Cygwin uses a\n");
  fprintf(out, "\t    #       different C library...\n");
  fprintf(out, "\t    CFLAGS=\"$CFLAGS -mno-cygwin\"\n");
  fprintf(out, "\t    CPPFLAGS=\"$CPPFLAGS -mno-cygwin\"\n");
  fprintf(out, "\t    CXXFLAGS=\"$CXXFLAGS -mno-cygwin\"\n");
  fprintf(out, "\t    LDFLAGS=\"$LDFLAGS -mno-cygwin\"\n");
  fprintf(out, "\t    DSOFLAGS=\"$DSOFLAGS -mno-cygwin\"\n");
  fprintf(out, "\telse\n");
  fprintf(out, "\t    # we target Cygwin in combination with X11\n");
  fprintf(out, "\t    if test x$enable_x11 = xyes; then\n");
  fprintf(out, "\t\tuname_GUI=\"X11$uname\"\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\t;;\n");
  fprintf(out, "esac\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Define the libraries and link options we will need.\n");
  fprintf(out, "LINKFLTK=\"../lib/libfltk.a\"\n");
  fprintf(out, "LINKFLTKGL=\"../lib/libfltk_gl.a\"\n");
  fprintf(out, "LINKFLTKIMG=\"../lib/libfltk_images.a\"\n");
  fprintf(out, "GLDEMOS=\"gldemos\"\n");
  fprintf(out, "\n");
  fprintf(out, "LIBEXT=\".a\"\n");
  fprintf(out, "LIBNAME=\"../lib/libfltk.a\"\n");
  fprintf(out, "GLLIBNAME=\"../lib/libfltk_gl.a\"\n");
  fprintf(out, "IMGLIBNAME=\"../lib/libfltk_images.a\"\n");
  fprintf(out, "CAIROLIBNAME=\"../lib/libfltk_cairo.a\"\n");
  fprintf(out, "\n");
  fprintf(out, "LIBBASENAME=\"libfltk.a\"\n");
  fprintf(out, "GLLIBBASENAME=\"libfltk_gl.a\"\n");
  fprintf(out, "IMGLIBBASENAME=\"libfltk_images.a\"\n");
  fprintf(out, "CAIROLIBBASENAME=\"libfltk_cairo.a\"\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Check for Cairo library unless disabled...\n");
  fprintf(out, "CAIRODIR=\"\"\n");
  fprintf(out, "CAIROFLAGS=\"\"\n");
  fprintf(out, "LINKFLTKCAIRO=\"\"\n");
  fprintf(out, "FLTKCAIROOPTION=\"\"\n");
  fprintf(out, "CAIROLIBS=\"\"\n");
  fprintf(out, "\n");
  fprintf(out, "AC_ARG_ENABLE(cairoext,[  --enable-cairoext       use fltk code instrumentation for cairo extended use (default=no)])\n");
  fprintf(out, "AC_ARG_ENABLE(cairo,[  --enable-cairo          use lib Cairo  (default=no)])\n");
  fprintf(out, "\n");
  fprintf(out, "if test x$enable_cairoext = xyes; then\n");
  fprintf(out, "\t  AC_DEFINE(FLTK_USE_CAIRO)\n");
  fprintf(out, "\t  AC_DEFINE(FLTK_HAVE_CAIRO)\n");
  fprintf(out, "\t  dnl FIXME This part should be fixed so configure do not depend on\n");
  fprintf(out, "\t  dnl we do not rely on pkg-config .\n");
  fprintf(out, "\t  CAIRODIR=\"cairo\"\n");
  fprintf(out, "          CAIROFLAGS=\"`pkg-config --cflags cairo`\"\n");
  fprintf(out, "          CAIROLIBS=\"-lcairo -lpixman-1\"\n");
  fprintf(out, "          CXXFLAGS=\"$CAIROFLAGS $CXXFLAGS\"\n");
  fprintf(out, "\t  LINKFLTKCAIRO=\"../lib/libfltk_cairo.a\"\n");
  fprintf(out, "\t  FLTKCAIROOPTION=\"-L ../cairo -lfltk_cairo$SHAREDSUFFIX\"\n");
  fprintf(out, "\t  LIBS=\"$CAIROLIBS $LIBS\" \n");
  fprintf(out, "\t  dnl $LINKFLTKCAIRO \n");
  fprintf(out, "\t  LINKFLTK+=\" $LINKFLTKCAIRO\"\n");
  fprintf(out, "else \n");
  fprintf(out, "    if test x$enable_cairo = xyes; then\n");
  fprintf(out, "\t  AC_DEFINE(FLTK_HAVE_CAIRO)\n");
  fprintf(out, "\t  dnl FIXME This part should be fixed so configure do not depend on\n");
  fprintf(out, "\t  dnl we do not rely on pkg-config .\n");
  fprintf(out, "\t  CAIRODIR=\"cairo\"\n");
  fprintf(out, "          CAIROFLAGS=\"`pkg-config --cflags cairo`\"\n");
  fprintf(out, "          CAIROLIBS=\"-lcairo -lpixman-1\"\n");
  fprintf(out, "          CXXFLAGS=\"$CAIROFLAGS $CXXFLAGS\"\n");
  fprintf(out, "\t  LINKFLTKCAIRO=\"../lib/libfltk_cairo.a\"\n");
  fprintf(out, "\t  FLTKCAIROOPTION=\"-L ../cairo -lfltk_cairo$SHAREDSUFFIX\"\n");
  fprintf(out, "    fi\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "AC_SUBST(CAIRODIR)\n");
  fprintf(out, "AC_SUBST(CAIROFLAGS)\n");
  fprintf(out, "AC_SUBST(CAIROLIBS)\n");
  fprintf(out, "AC_SUBST(LINKFLTKCAIRO)\n");
  fprintf(out, "AC_SUBST(FLTKCAIROOPTION)\n");
  fprintf(out, "\n");
  fprintf(out, "\n");
  fprintf(out, "AC_SUBST(FLLIBNAME)\n");
  fprintf(out, "AC_SUBST(GLDEMOS)\n");
  fprintf(out, "AC_SUBST(GLLIBNAME)\n");
  fprintf(out, "AC_SUBST(IMGLIBNAME)\n");
  fprintf(out, "AC_SUBST(CAIROLIBNAME)\n");
  fprintf(out, "AC_SUBST(LIBEXT)\n");
  fprintf(out, "AC_SUBST(LIBNAME)\n");
  fprintf(out, "AC_SUBST(LINKFLTK)\n");
  fprintf(out, "AC_SUBST(LINKFLTKGL)\n");
  fprintf(out, "AC_SUBST(LINKFLTKIMG)\n");
  fprintf(out, "\n");
  fprintf(out, "AC_SUBST(LIBBASENAME)\n");
  fprintf(out, "AC_SUBST(FLLIBBASENAME)\n");
  fprintf(out, "AC_SUBST(GLLIBBASENAME)\n");
  fprintf(out, "AC_SUBST(IMGLIBBASENAME)\n");
  fprintf(out, "AC_SUBST(CAIROLIBBASENAME)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Handle compile-time options...\n");
  fprintf(out, "AC_ARG_ENABLE(debug, [  --enable-debug          turn on debugging [default=no]])\n");
  fprintf(out, "if test x$enable_debug = xyes; then\n");
  fprintf(out, "    DEBUGFLAG=\"-g \"\n");
  fprintf(out, "else\n");
  fprintf(out, "    DEBUGFLAG=\"\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "AC_ARG_ENABLE(cp936, [  --enable-cp936          turn on CP936 [default=no]])\n");
  fprintf(out, "if test x$enable_cp936 = xyes; then\n");
  fprintf(out, "    CFLAGS=\"$CFLAGS -DCP936\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "\n");
  fprintf(out, "AC_ARG_ENABLE(gl, [  --enable-gl             turn on OpenGL support [default=yes]])\n");
  fprintf(out, "\n");
  fprintf(out, "AC_ARG_ENABLE(shared, [  --enable-shared         turn on shared libraries [default=no]])\n");
  fprintf(out, "if test x$enable_shared = xyes; then\n");
  fprintf(out, "    PICFLAG=1\n");
  fprintf(out, "    SHAREDSUFFIX=\"\"\n");
  fprintf(out, "    FLUID=\"fluid-shared\"\n");
  fprintf(out, "\n");
  fprintf(out, "    case $uname in\n");
  fprintf(out, "\tDarwin*)\n");
  fprintf(out, "            DSONAME=\"libfltk.$FL_API_VERSION.dylib\"\n");
  fprintf(out, "            GLDSONAME=\"libfltk_gl.$FL_API_VERSION.dylib\"\n");
  fprintf(out, "            IMGDSONAME=\"libfltk_images.$FL_API_VERSION.dylib\"\n");
  fprintf(out, "            CAIRODSONAME=\"libfltk_cairo.$FL_API_VERSION.dylib\"\n");
  fprintf(out, "\t    DSOCOMMAND=\"\\$(CXX) \\$(ARCHFLAGS) \\$(DSOFLAGS) -dynamiclib -lc -o\"\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\n");
  fprintf(out, "\tSunOS* | UNIX_S*)\n");
  fprintf(out, "            DSONAME=\"libfltk.so.$FL_API_VERSION\"\n");
  fprintf(out, "            GLDSONAME=\"libfltk_gl.so.$FL_API_VERSION\"\n");
  fprintf(out, "            IMGDSONAME=\"libfltk_images.so.$FL_API_VERSION\"\n");
  fprintf(out, "            CAIRODSONAME=\"libfltk_cairo.so.$FL_API_VERSION\"\n");
  fprintf(out, "\t    DSOCOMMAND=\"\\$(CXX) \\$(DSOFLAGS) -h \\$@ \\$(LDLIBS) -G $DEBUGFLAG -o\"\n");
  fprintf(out, "\t    if test \"x$libdir\" != \"x/usr/lib\"; then\n");
  fprintf(out, "\t\t    DSOLINK=\"-R$libdir\"\n");
  fprintf(out, "            fi\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\tHP-UX*)\n");
  fprintf(out, "            DSONAME=\"libfltk.sl.$FL_API_VERSION\"\n");
  fprintf(out, "            GLDSONAME=\"libfltk_gl.sl.$FL_API_VERSION\"\n");
  fprintf(out, "            IMGDSONAME=\"libfltk_images.sl.$FL_API_VERSION\"\n");
  fprintf(out, "            CAIRODSONAME=\"libfltk_cairo.sl.$FL_API_VERSION\"\n");
  fprintf(out, "\t    DSOCOMMAND=\"ld \\$(DSOFLAGS) -b -z +h \\$@ $DEBUGFLAG -o\"\n");
  fprintf(out, "\t    if test \"x$libdir\" != \"x/usr/lib\"; then\n");
  fprintf(out, "\t\t    DSOLINK=\"-Wl,-rpath,$libdir\"\n");
  fprintf(out, "            fi\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\tIRIX*)\n");
  fprintf(out, "            DSONAME=\"libfltk.so.$FL_API_VERSION\"\n");
  fprintf(out, "            GLDSONAME=\"libfltk_gl.so.$FL_API_VERSION\"\n");
  fprintf(out, "            IMGDSONAME=\"libfltk_images.so.$FL_API_VERSION\"\n");
  fprintf(out, "            CAIRODSONAME=\"libfltk_cairo.so.$FL_API_VERSION\"\n");
  fprintf(out, "            DSOCOMMAND=\"\\$(CXX) \\$(DSOFLAGS) -Wl,-soname,\\$@,-set_version,sgi1.1 \\$(LDLIBS) -shared $DEBUGFLAG -o\"\n");
  fprintf(out, "\t    if test \"x$libdir\" != \"x/usr/lib\" -a \"x$libdir\" != \"x/usr/lib32\" -a \"x$libdir\" != \"x/usr/lib64\"; then\n");
  fprintf(out, "\t\t    DSOLINK=\"-Wl,-rpath,$libdir\"\n");
  fprintf(out, "            fi\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\tOSF1*)\n");
  fprintf(out, "            DSONAME=\"libfltk.so.$FL_API_VERSION\"\n");
  fprintf(out, "            GLDSONAME=\"libfltk_gl.so.$FL_API_VERSION\"\n");
  fprintf(out, "            IMGDSONAME=\"libfltk_images.so.$FL_API_VERSION\"\n");
  fprintf(out, "            CAIRODSONAME=\"libfltk_cairo.so.$FL_API_VERSION\"\n");
  fprintf(out, "            DSOCOMMAND=\"\\$(CXX) \\$(DSOFLAGS) -Wl,-soname,\\$@ \\$(LDLIBS) -shared $DEBUGFLAG -o\"\n");
  fprintf(out, "\t    if test \"x$libdir\" != \"x/usr/lib\" -a \"x$libdir\" != \"x/usr/lib32\"; then\n");
  fprintf(out, "\t\t    DSOLINK=\"-Wl,-rpath,$libdir\"\n");
  fprintf(out, "            fi\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\tLinux* | *BSD*)\n");
  fprintf(out, "            DSONAME=\"libfltk.so.$FL_API_VERSION\"\n");
  fprintf(out, "            GLDSONAME=\"libfltk_gl.so.$FL_API_VERSION\"\n");
  fprintf(out, "            IMGDSONAME=\"libfltk_images.so.$FL_API_VERSION\"\n");
  fprintf(out, "            CAIRODSONAME=\"libfltk_cairo.so.$FL_API_VERSION\"\n");
  fprintf(out, "            DSOCOMMAND=\"\\$(CXX) \\$(DSOFLAGS) -Wl,-soname,\\$@ \\$(LDLIBS) -shared -fPIC $DEBUGFLAG -o\"\n");
  fprintf(out, "\t    if test \"x$libdir\" != \"x/usr/lib\" -a \"x$libdir\" != \"x/usr/lib64\"; then\n");
  fprintf(out, "\t\t    DSOLINK=\"-Wl,-rpath,$libdir\"\n");
  fprintf(out, "            fi\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\tAIX*)\n");
  fprintf(out, "            DSONAME=\"libfltk_s.a\"\n");
  fprintf(out, "            GLDSONAME=\"libfltk_gl_s.a\"\n");
  fprintf(out, "            IMGDSONAME=\"libfltk_images_s.a\"\n");
  fprintf(out, "            CAIRODSONAME=\"libfltk_cairo_s.a\"\n");
  fprintf(out, "            DSOCOMMAND=\"\\$(CXX) \\$(DSOFLAGS) -Wl,-bexpall,-bM:SRE,-bnoentry -o\"\n");
  fprintf(out, "            SHAREDSUFFIX=\"_s\"\n");
  fprintf(out, "            ;;\n");
  fprintf(out, "        CYGWIN* | MINGW*)\n");
  fprintf(out, "\t    PICFLAG=0\n");
  fprintf(out, "\t    if test x$enable_cygwin != xyes; then\n");
  fprintf(out, "\t\tDSONAME=\"mgwfltknox-$FL_API_VERSION.dll\"\n");
  fprintf(out, "\t\tGLDSONAME=\"mgwfltknox_gl-$FL_API_VERSION.dll\"\n");
  fprintf(out, "\t\tIMGDSONAME=\"mgwfltknox_images-$FL_API_VERSION.dll\"\n");
  fprintf(out, "\t\tCAIRODSONAME=\"mgwfltknox_cairo-$FL_API_VERSION.dll\"\n");
  fprintf(out, "\t    else\n");
  fprintf(out, "\t\tif test x$enable_x11 = xyes; then\n");
  fprintf(out, "\t\t    DSONAME=\"cygfltk-$FL_API_VERSION.dll\"\n");
  fprintf(out, "\t\t    GLDSONAME=\"cygfltk_gl-$FL_API_VERSION.dll\"\n");
  fprintf(out, "\t\t    IMGDSONAME=\"cygfltk_images-$FL_API_VERSION.dll\"\n");
  fprintf(out, "\t\t    CAIRODSONAME=\"cygfltk_cairo-$FL_API_VERSION.dll\"\n");
  fprintf(out, "\t\telse\n");
  fprintf(out, "\t\t    DSONAME=\"cygfltknox-$FL_API_VERSION.dll\"\n");
  fprintf(out, "\t\t    GLDSONAME=\"cygfltknox_gl-$FL_API_VERSION.dll\"\n");
  fprintf(out, "\t\t    IMGDSONAME=\"cygfltknox_images-$FL_API_VERSION.dll\"\n");
  fprintf(out, "\t\t    CAIRODSONAME=\"cygfltknox_cairo-$FL_API_VERSION.dll\"\n");
  fprintf(out, "\t\tfi\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "\t    #-----------------------------------------------------------\n");
  fprintf(out, "\t    # -Wl,--enable-runtime-pseudo-reloc: See str 1585\n");
  fprintf(out, "\t    # appears to be necessary for older binutils versions < 2.16\n");
  fprintf(out, "\t    #-----------------------------------------------------------\n");
  fprintf(out, "            LDFLAGS=\"$LDFLAGS -Wl,--enable-auto-import -Wl,--enable-runtime-pseudo-reloc\"\n");
  fprintf(out, "\t    DSOCOMMAND=\"\\$(CXX) \\$(DSOFLAGS) -shared \\\n");
  fprintf(out, "\t    \t-Wl,--whole-archive -Wl,--export-all-symbols \\\n");
  fprintf(out, "\t\t-Wl,--enable-runtime-pseudo-reloc -Wl,--enable-auto-import \\\n");
  fprintf(out, "\t\t-Wl,--enable-auto-image-base -o \\$@\"\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\t*)\n");
  fprintf(out, "            AC_MSG_WARN(Shared libraries may not be supported.  Trying -shared option with compiler.)\n");
  fprintf(out, "            DSONAME=\"libfltk.so.$FL_API_VERSION\"\n");
  fprintf(out, "            GLDSONAME=\"libfltk_gl.so.$FL_API_VERSION\"\n");
  fprintf(out, "            IMGDSONAME=\"libfltk_images.so.$FL_API_VERSION\"\n");
  fprintf(out, "            CAIRODSONAME=\"libfltk_cairo.so.$FL_API_VERSION\"\n");
  fprintf(out, "            DSOCOMMAND=\"\\$(CXX) \\$(DSOFLAGS) -Wl,-soname,\\$@ \\$(LDLIBS) -shared $DEBUGFLAG -o\"\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "    esac\n");
  fprintf(out, "\n");
  fprintf(out, "    LINKSHARED=\"-L../src $FLTKCAIROOPTION -lfltk_images$SHAREDSUFFIX -lfltk$SHAREDSUFFIX\"\n");
  fprintf(out, "else\n");
  fprintf(out, "    DSOCOMMAND=\"echo\"\n");
  fprintf(out, "    DSOLINK=\"\"\n");
  fprintf(out, "    DSONAME=\"\"\n");
  fprintf(out, "    FLDSONAME=\"\"\n");
  fprintf(out, "    GLDSONAME=\"\"\n");
  fprintf(out, "    IMGDSONAME=\"\"\n");
  fprintf(out, "    CAIRODSONAME=\"\"\n");
  fprintf(out, "    PICFLAG=0\n");
  fprintf(out, "    SHAREDSUFFIX=\"\"\n");
  fprintf(out, "    FLUID=\"fluid\"\n");
  fprintf(out, "    LINKSHARED=\"$LINKFLTKCAIRO ../lib/libfltk_images.a ../lib/libfltk.a\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "AC_SUBST(DSOCOMMAND)\n");
  fprintf(out, "AC_SUBST(DSOFLAGS)\n");
  fprintf(out, "AC_SUBST(DSOLINK)\n");
  fprintf(out, "AC_SUBST(DSONAME)\n");
  fprintf(out, "AC_SUBST(FLDSONAME)\n");
  fprintf(out, "AC_SUBST(GLDSONAME)\n");
  fprintf(out, "AC_SUBST(IMGDSONAME)\n");
  fprintf(out, "AC_SUBST(CAIRODSONAME)\n");
  fprintf(out, "AC_SUBST(SHAREDSUFFIX)\n");
  fprintf(out, "AC_SUBST(LINKSHARED)\n");
  fprintf(out, "AC_SUBST(FLUID)\n");
  fprintf(out, "\n");
  fprintf(out, "AC_ARG_ENABLE(threads, [  --enable-threads        enable multi-threading support (default=yes)])\n");
  fprintf(out, "\n");
  fprintf(out, "AC_ARG_WITH(optim, [  --with-optim=\"flags\"    use custom optimization flags])\n");
  fprintf(out, "\n");
  fprintf(out, "AC_ARG_WITH(archflags, [  --with-archflags=\"flags\"\n");
  fprintf(out, "                          use custom architecture flags \n");
  fprintf(out, "\t\t\t  (possible Mac OS X values include -arch i386, -arch x86_64, -arch ppc)],\n");
  fprintf(out, "    ARCHFLAGS=\"$withval\")\n");
  fprintf(out, "case $uname in\n");
  fprintf(out, "    Darwin*)\n");
  fprintf(out, "# QD is not supported anymore since 1.3\n");
  fprintf(out, "\tAC_DEFINE(__APPLE_QUARTZ__)\n");
  fprintf(out, "\t;;\n");
  fprintf(out, "esac\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Find commands...\n");
  fprintf(out, "AC_PROG_CC\n");
  fprintf(out, "AC_PROG_CXX\n");
  fprintf(out, "AC_PROG_INSTALL\n");
  fprintf(out, "case $uname in\n");
  fprintf(out, "    OSF1*)\n");
  fprintf(out, "\tINSTALL=\"`pwd`/install-sh -c\"\n");
  fprintf(out, "\t;;\n");
  fprintf(out, "esac\n");
  fprintf(out, "if test \"$INSTALL\" = \"$ac_install_sh\"; then\n");
  fprintf(out, "    # Use full path to install-sh script...\n");
  fprintf(out, "    INSTALL=\"`pwd`/install-sh -c\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "AC_PATH_PROG(NROFF,nroff)\n");
  fprintf(out, "if test \"x$NROFF\" = \"x:\"; then\n");
  fprintf(out, "    # Try groff instead of nroff...\n");
  fprintf(out, "    AC_PATH_PROG(GROFF,groff)\n");
  fprintf(out, "    if test \"x$GROFF\" = \"x:\"; then\n");
  fprintf(out, "        NROFF=\"echo\"\n");
  fprintf(out, "    else\n");
  fprintf(out, "        NROFF=\"$GROFF -T ascii\"\n");
  fprintf(out, "    fi\n");
  fprintf(out, "fi\n");
  fprintf(out, "AC_PATH_PROG(HTMLDOC,htmldoc)\n");
  fprintf(out, "AC_PATH_PROG(DOXYDOC,doxygen)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl How do we make libraries?\n");
  fprintf(out, "AC_PROG_RANLIB\n");
  fprintf(out, "AC_PATH_TOOL(AR, ar)\n");
  fprintf(out, "\n");
  fprintf(out, "if test \"x$AR\" = \"x:\"; then\n");
  fprintf(out, "    AC_MSG_ERROR(Configure could not find the library archiver, aborting.)\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "if test \"x$RANLIB\" != \"x:\"; then\n");
  fprintf(out, "    LIBCOMMAND=\"$AR cr\"\n");
  fprintf(out, "else\n");
  fprintf(out, "    LIBCOMMAND=\"$AR crs\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "AC_SUBST(LIBCOMMAND)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl how to compile (Windows) resource files\n");
  fprintf(out, "dnl this will only be used to compile resources for Windows .exe files\n");
  fprintf(out, "AC_PATH_TOOL(RC,windres)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Architecture checks...\n");
  fprintf(out, "if test \"$uname\" != Darwin; then\n");
  fprintf(out, "  AC_C_BIGENDIAN\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "AC_CHECK_SIZEOF(short, 2)\n");
  fprintf(out, "AC_CHECK_SIZEOF(int, 4)\n");
  fprintf(out, "AC_CHECK_SIZEOF(long, 4)\n");
  fprintf(out, "if test $ac_cv_sizeof_short -eq 2; then\n");
  fprintf(out, "    AC_DEFINE(U16,unsigned short)\n");
  fprintf(out, "fi\n");
  fprintf(out, "if test $ac_cv_sizeof_int -eq 4; then\n");
  fprintf(out, "    AC_DEFINE(U32,unsigned)\n");
  fprintf(out, "else\n");
  fprintf(out, "    if test $ac_cv_sizeof_long -eq 4; then\n");
  fprintf(out, "        AC_DEFINE(U32,unsigned long)\n");
  fprintf(out, "    fi\n");
  fprintf(out, "fi\n");
  fprintf(out, "if test \"$uname\" != Darwin; then\n");
  fprintf(out, "\tif test $ac_cv_sizeof_int -eq 8; then\n");
  fprintf(out, "\t\tAC_DEFINE(U64,unsigned)\n");
  fprintf(out, "\telse\n");
  fprintf(out, "\t\tif test $ac_cv_sizeof_long -eq 8; then\n");
  fprintf(out, "\t\t\tAC_DEFINE(U64,unsigned long)\n");
  fprintf(out, "\t\tfi\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Does the C++ compiler support the bool type?\n");
  fprintf(out, "AC_CACHE_CHECK(whether the compiler recognizes bool as a built-in type,\n");
  fprintf(out, "    ac_cv_cxx_bool,[\n");
  fprintf(out, "\tAC_LANG_SAVE\n");
  fprintf(out, "\tAC_LANG_CPLUSPLUS\n");
  fprintf(out, "\tAC_TRY_COMPILE([\n");
  fprintf(out, "\t    int f(int  x){return 1;}\n");
  fprintf(out, "\t    int f(char x){return 1;}\n");
  fprintf(out, "\t    int f(bool x){return 1;}\n");
  fprintf(out, "\t],[\n");
  fprintf(out, "\t    bool b = true;\n");
  fprintf(out, "\t    return f(b);\n");
  fprintf(out, "\t], ac_cv_cxx_bool=yes, ac_cv_cxx_bool=no)\n");
  fprintf(out, "\tAC_LANG_RESTORE\n");
  fprintf(out, "    ])\n");
  fprintf(out, "\n");
  fprintf(out, "if test \"$ac_cv_cxx_bool\" != yes; then\n");
  fprintf(out, "    CXXFLAGS=\"-Dbool=char -Dfalse=0 -Dtrue=1 $CXXFLAGS\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Standard headers and functions...\n");
  fprintf(out, "AC_HEADER_DIRENT\n");
  fprintf(out, "AC_CHECK_HEADER(sys/select.h,AC_DEFINE(HAVE_SYS_SELECT_H))\n");
  fprintf(out, "AC_CHECK_HEADER(sys/stdtypes.h,AC_DEFINE(HAVE_SYS_SELECT_H))\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Do we have the POSIX compatible scandir() prototype?\n");
  fprintf(out, "AC_CACHE_CHECK([whether we have the POSIX compatible scandir() prototype],\n");
  fprintf(out, "    ac_cv_cxx_scandir_posix,[\n");
  fprintf(out, "\tAC_LANG_SAVE\n");
  fprintf(out, "\tAC_LANG_CPLUSPLUS\n");
  fprintf(out, "\tAC_TRY_COMPILE([\n");
  fprintf(out, "\t  #include <dirent.h>\n");
  fprintf(out, "\t  int func (const char *d, dirent ***list, void *sort) {\n");
  fprintf(out, "\t    int n = scandir(d, list, 0, (int(*)(const dirent **, const dirent **))sort);\n");
  fprintf(out, "\t  }\n");
  fprintf(out, "\t],[\n");
  fprintf(out, "\t], ac_cv_cxx_scandir_posix=yes, ac_cv_cxx_scandir_posix=no)\n");
  fprintf(out, "\tAC_LANG_RESTORE\n");
  fprintf(out, "    ])\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Define both HAVE_SCANDIR... macros, if the POSIX compatible function is\n");
  fprintf(out, "dnl available. Otherwise: check, whether any scandir prototype is available,\n");
  fprintf(out, "dnl but don't use it on SunOS and QNX because of an incompatibility in pre-Y2K\n");
  fprintf(out, "dnl SunOS scandir versions. We assume, though, that the POSIX compatible\n");
  fprintf(out, "dnl version on newer SunOS/Solaris versions works as expected.\n");
  fprintf(out, "if test \"$ac_cv_cxx_scandir_posix\" = yes; then\n");
  fprintf(out, "    AC_DEFINE(HAVE_SCANDIR)\n");
  fprintf(out, "    AC_DEFINE(HAVE_SCANDIR_POSIX)\n");
  fprintf(out, "else\n");
  fprintf(out, "    AC_CHECK_FUNC(scandir,\n");
  fprintf(out, "\tif test \"x$uname\" = xSunOS -o \"x$uname\" = xQNX; then\n");
  fprintf(out, "            AC_MSG_WARN(Not using $uname scandir emulation function.)\n");
  fprintf(out, "\telse\n");
  fprintf(out, "            AC_DEFINE(HAVE_SCANDIR)\n");
  fprintf(out, "        fi)\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "AC_CHECK_FUNC(vsnprintf,[\n");
  fprintf(out, "    case \"$uname\" in\n");
  fprintf(out, "    \tHP-UX*)\n");
  fprintf(out, "\t    if test \"$uversion\" = \"1020\"; then\n");
  fprintf(out, "\t        AC_MSG_WARN(Not using built-in vsnprintf function because you are running HP-UX 10.20.)\n");
  fprintf(out, "\t    else\n");
  fprintf(out, "        \tAC_DEFINE(HAVE_VSNPRINTF)\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\n");
  fprintf(out, "    \tOSF1*)\n");
  fprintf(out, "\t    if test \"$uversion\" = \"40\"; then\n");
  fprintf(out, "                AC_MSG_WARN(Not using built-in vsnprintf function because you are running Tru64 4.0.)\n");
  fprintf(out, "\t    else\n");
  fprintf(out, "        \tAC_DEFINE(HAVE_VSNPRINTF)\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\n");
  fprintf(out, "        *)\n");
  fprintf(out, "            AC_DEFINE(HAVE_VSNPRINTF)\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "    esac])\n");
  fprintf(out, "AC_CHECK_FUNC(snprintf,[\n");
  fprintf(out, "    case \"$uname\" in\n");
  fprintf(out, "    \tHP-UX*)\n");
  fprintf(out, "\t    if test \"$uversion\" = \"1020\"; then\n");
  fprintf(out, "\t        AC_MSG_WARN(Not using built-in snprintf function because you are running HP-UX 10.20.)\n");
  fprintf(out, "\t    else\n");
  fprintf(out, "        \tAC_DEFINE(HAVE_SNPRINTF)\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\n");
  fprintf(out, "    \tOSF1*)\n");
  fprintf(out, "\t    if test \"$uversion\" = \"40\"; then\n");
  fprintf(out, "                AC_MSG_WARN(Not using built-in snprintf function because you are running Tru64 4.0.)\n");
  fprintf(out, "\t    else\n");
  fprintf(out, "        \tAC_DEFINE(HAVE_SNPRINTF)\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\n");
  fprintf(out, "        *)\n");
  fprintf(out, "            AC_DEFINE(HAVE_SNPRINTF)\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "    esac])\n");
  fprintf(out, "AC_CHECK_HEADER(strings.h, AC_DEFINE(HAVE_STRINGS_H))\n");
  fprintf(out, "AC_CHECK_FUNCS(strcasecmp strlcat strlcpy)\n");
  fprintf(out, "\n");
  fprintf(out, "AC_CHECK_HEADER(locale.h, AC_DEFINE(HAVE_LOCALE_H))\n");
  fprintf(out, "AC_CHECK_FUNCS(localeconv)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl FLTK library uses math library functions...\n");
  fprintf(out, "AC_SEARCH_LIBS(pow, m)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Check for largefile support...\n");
  fprintf(out, "AC_SYS_LARGEFILE\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Define largefile options as needed...\n");
  fprintf(out, "LARGEFILE=\"\"\n");
  fprintf(out, "if test x$enable_largefile != xno; then\n");
  fprintf(out, "\tLARGEFILE=\"-D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE\"\n");
  fprintf(out, "\n");
  fprintf(out, "\tif test x$ac_cv_sys_large_files = x1; then\n");
  fprintf(out, "\t\tLARGEFILE=\"$LARGEFILE -D_LARGE_FILES\"\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "\tif test x$ac_cv_sys_file_offset_bits = x64; then\n");
  fprintf(out, "\t\tLARGEFILE=\"$LARGEFILE -D_FILE_OFFSET_BITS=64\"\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "fi\n");
  fprintf(out, "AC_SUBST(LARGEFILE)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Check for \"long long\" support...\n");
  fprintf(out, "AC_CACHE_CHECK(for long long int, ac_cv_c_long_long,\n");
  fprintf(out, "\t[if test \"$GCC\" = yes; then\n");
  fprintf(out, "\t\tac_cv_c_long_long=yes\n");
  fprintf(out, "\telse\n");
  fprintf(out, "\t\tAC_TRY_COMPILE(,[long long int i;],\n");
  fprintf(out, "\t\t\tac_cv_c_long_long=yes,\n");
  fprintf(out, "\t\t\tac_cv_c_long_long=no)\n");
  fprintf(out, "\tfi])\n");
  fprintf(out, "\n");
  fprintf(out, "if test $ac_cv_c_long_long = yes; then\n");
  fprintf(out, "\tAC_DEFINE(HAVE_LONG_LONG)\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "AC_CHECK_FUNC(strtoll, AC_DEFINE(HAVE_STRTOLL))\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Check for dlopen/dlsym...\n");
  fprintf(out, "AC_SEARCH_LIBS(dlsym, dl, AC_DEFINE(HAVE_DLSYM))\n");
  fprintf(out, "AC_CHECK_HEADER(dlfcn.h, AC_DEFINE(HAVE_DLFCN_H))\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Check for audio libraries...\n");
  fprintf(out, "AUDIOLIBS=\"\"\n");
  fprintf(out, "\n");
  fprintf(out, "case $uname in\n");
  fprintf(out, "    CYGWIN* | MINGW*)\n");
  fprintf(out, "\tdnl Cygwin environment...\n");
  fprintf(out, "\tAUDIOLIBS=\"-lwinmm\"\n");
  fprintf(out, "\t;;\n");
  fprintf(out, "\n");
  fprintf(out, "    Darwin*)\n");
  fprintf(out, "\tAUDIOLIBS=\"-framework CoreAudio\"\n");
  fprintf(out, "\t;;\n");
  fprintf(out, "\n");
  fprintf(out, "    *)\n");
  fprintf(out, "\tAC_CHECK_HEADER(alsa/asoundlib.h,\n");
  fprintf(out, "\t    AC_DEFINE(HAVE_ALSA_ASOUNDLIB_H)\n");
  fprintf(out, "\t    AUDIOLIBS=\"-lasound\")\n");
  fprintf(out, "        ;;\n");
  fprintf(out, "esac\n");
  fprintf(out, "\n");
  fprintf(out, "AC_SUBST(AUDIOLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Check for image libraries...\n");
  fprintf(out, "SAVELIBS=\"$LIBS\"\n");
  fprintf(out, "IMAGELIBS=\"\"\n");
  fprintf(out, "STATICIMAGELIBS=\"\"\n");
  fprintf(out, "\n");
  fprintf(out, "AC_SUBST(IMAGELIBS)\n");
  fprintf(out, "AC_SUBST(STATICIMAGELIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "# Handle the JPEG lib linking mode (use fltk local or system lib)\n");
  fprintf(out, "# If --enable-(resp. --disable-)localjpeg parameter is not set by user\n");
  fprintf(out, "# Then we check the JPEG lib usability, with result in sysjpeglib_ok variable\n");
  fprintf(out, "AC_ARG_ENABLE(localjpeg, [  --enable-localjpeg      use local JPEG library, default=auto])\n");
  fprintf(out, "# Check for System lib use if automatic mode or --disable-localjpeg is requested\n");
  fprintf(out, "sysjpeglib_ok=no\n");
  fprintf(out, "sysjpeginc_ok=no\n");
  fprintf(out, "if test x$enable_localjpeg != xyes; then\n");
  fprintf(out, "    AC_CHECK_LIB(jpeg,jpeg_CreateCompress,\n");
  fprintf(out, "\t[AC_CHECK_HEADER(jpeglib.h,\n");
  fprintf(out, "\t    sysjpeginc_ok=yes)\n");
  fprintf(out, "\t    if test x$sysjpeginc_ok = xyes; then\n");
  fprintf(out, "\t\tsysjpeglib_ok=yes\n");
  fprintf(out, "\t\tfi])\n");
  fprintf(out, "fi\n");
  fprintf(out, "# Now set the jpeg lib and include flags according to the requested mode and availability \n");
  fprintf(out, "if test x$enable_localjpeg = xyes -o x$sysjpeglib_ok = xno; then\n");
  fprintf(out, "    JPEGINC=\"-I../jpeg\"\n");
  fprintf(out, "    JPEG=\"jpeg\"\n");
  fprintf(out, "    IMAGELIBS=\"-lfltk_jpeg $IMAGELIBS\"\n");
  fprintf(out, "    STATICIMAGELIBS=\"\\$libdir/libfltk_jpeg.a $STATICIMAGELIBS\"\n");
  fprintf(out, "    AC_DEFINE(HAVE_LIBJPEG)\n");
  fprintf(out, "    #ac_cv_lib_jpeg_jpeg_CreateCompress=no # from ima: should not be necessary\n");
  fprintf(out, "    # Finally, warn user if system lib was requested but not found\n");
  fprintf(out, "    if test x$enable_localjpeg = xno; then\n");
  fprintf(out, "\tAC_MSG_WARN(Cannot find system jpeg lib or header: choosing the local lib mode.)\n");
  fprintf(out, "    fi\n");
  fprintf(out, "else\n");
  fprintf(out, "    JPEGINC=\"\"\n");
  fprintf(out, "    JPEG=\"\"\n");
  fprintf(out, "    IMAGELIBS=\"-ljpeg $IMAGELIBS\"\n");
  fprintf(out, "    STATICIMAGELIBS=\"-ljpeg $STATICIMAGELIBS\"\n");
  fprintf(out, "    AC_DEFINE(HAVE_LIBJPEG)\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "# Handle the ZLIB lib linking mode (use fltk local or system lib)\n");
  fprintf(out, "# If --enable-(resp. --disable-)localzlib parameter is not set by user\n");
  fprintf(out, "# Then we check the ZLIB lib usability, with result in syszlib_ok variable\n");
  fprintf(out, "AC_ARG_ENABLE(localzlib, [  --enable-localzlib      use local ZLIB library, default=auto])\n");
  fprintf(out, "# Check for System lib use if automatic mode or --disable-localzlib is requested\n");
  fprintf(out, "syszlib_ok=no\n");
  fprintf(out, "syszinc_ok=no\n");
  fprintf(out, "if test x$enable_localzlib != xyes; then\n");
  fprintf(out, "    AC_CHECK_LIB(z,gzgets,\n");
  fprintf(out, "\t[AC_CHECK_HEADER(zlib.h, \n");
  fprintf(out, "\t\tsyszinc_ok=yes)\n");
  fprintf(out, "\tif test x$syszinc_ok = xyes; then\n");
  fprintf(out, "\t    syszlib_ok=yes\n");
  fprintf(out, "\t    fi])\n");
  fprintf(out, "fi\n");
  fprintf(out, "# Now set the Z lib and include flags according to the requested mode and availability \n");
  fprintf(out, "if test x$enable_localzlib = xyes -o x$syszlib_ok = xno ; then\n");
  fprintf(out, "    ZLIBINC=\"-I../zlib\"\n");
  fprintf(out, "    ZLIB=\"zlib\"\n");
  fprintf(out, "    LIBS=\"-lfltk_z $LIBS\"\n");
  fprintf(out, "    IMAGELIBS=\"-lfltk_z $IMAGELIBS\"\n");
  fprintf(out, "    STATICIMAGELIBS=\"\\$libdir/libfltk_z.a $STATICIMAGELIBS\"\n");
  fprintf(out, "    AC_DEFINE(HAVE_LIBZ)\n");
  fprintf(out, "    ac_cv_lib_z_gzgets=no # fc: is still necessary ?\n");
  fprintf(out, "    # Finally, warn user if system lib was requested but not found\n");
  fprintf(out, "    if test x$enable_localzlib = xno; then\n");
  fprintf(out, "\tAC_MSG_WARN(Cannot find system z lib or header: choosing the local lib mode.)\n");
  fprintf(out, "    fi\n");
  fprintf(out, "else\n");
  fprintf(out, "    ZLIBINC=\"\"\n");
  fprintf(out, "    ZLIB=\"\"\n");
  fprintf(out, "    LIBS=\"-lz $LIBS\"\n");
  fprintf(out, "    IMAGELIBS=\"-lz $IMAGELIBS\"\n");
  fprintf(out, "    STATICIMAGELIBS=\"-lz $STATICIMAGELIBS\"\n");
  fprintf(out, "    AC_DEFINE(HAVE_LIBZ)\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "# Handle the PNG lib linking mode (use fltk local or system lib)\n");
  fprintf(out, "# If --enable-(resp. --disable-)localpng parameter is not set by user\n");
  fprintf(out, "# Then we check the png lib usability with result in syspng_lib variable\n");
  fprintf(out, "AC_ARG_ENABLE(localpng, [  --enable-localpng       use local PNG library, default=auto])\n");
  fprintf(out, "\n");
  fprintf(out, "# Now check if system lib is usable, we check Lib AND include availability with inc variant,\n");
  fprintf(out, "# but only, if the builtin lib is not requested\n");
  fprintf(out, "syspnglib_ok=no\n");
  fprintf(out, "syspnginc_ok=no\n");
  fprintf(out, "if test x$enable_localpng != xyes; then\n");
  fprintf(out, "  AC_CHECK_LIB(png, png_read_info, \n");
  fprintf(out, "    [AC_CHECK_HEADER(png.h, \n");
  fprintf(out, "\tAC_DEFINE(HAVE_PNG_H)\n");
  fprintf(out, "\tsyspnginc_ok=yes)\n");
  fprintf(out, "    AC_CHECK_HEADER(libpng/png.h, \n");
  fprintf(out, "\tAC_DEFINE(HAVE_LIBPNG_PNG_H)\n");
  fprintf(out, "\tsyspnginc_ok=yes)\n");
  fprintf(out, "    if test x$syspnginc_ok = xyes; then\n");
  fprintf(out, "\tsyspnglib_ok=yes\n");
  fprintf(out, "    fi])\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "# The following is executed if the lib was not found usable or if local lib is required explicitly\n");
  fprintf(out, "if test x$enable_localpng = xyes -o x$syspnglib_ok = xno ; then\n");
  fprintf(out, "    PNGINC=\"-I../png\"\n");
  fprintf(out, "    PNG=\"png\"\n");
  fprintf(out, "    IMAGELIBS=\"-lfltk_png $IMAGELIBS\"\n");
  fprintf(out, "    STATICIMAGELIBS=\"\\$libdir/libfltk_png.a $STATICIMAGELIBS\"\n");
  fprintf(out, "    AC_DEFINE(HAVE_LIBPNG)\n");
  fprintf(out, "    AC_DEFINE(HAVE_PNG_H)\n");
  fprintf(out, "    AC_DEFINE(HAVE_PNG_GET_VALID)\n");
  fprintf(out, "    AC_DEFINE(HAVE_PNG_SET_TRNS_TO_ALPHA)\n");
  fprintf(out, "    # Finally, warn user if system lib was requested but not found\n");
  fprintf(out, "    if test x$enable_localpng = xno; then\n");
  fprintf(out, "\tAC_MSG_WARN(Cannot find system png lib or header: choosing the local lib mode.)\n");
  fprintf(out, "    fi\n");
  fprintf(out, "else\n");
  fprintf(out, "    PNGINC=\"\"\n");
  fprintf(out, "    PNG=\"\"\n");
  fprintf(out, "    IMAGELIBS=\"-lpng $IMAGELIBS\"\n");
  fprintf(out, "    STATICIMAGELIBS=\"-lpng $STATICIMAGELIBS\"\n");
  fprintf(out, "    AC_DEFINE(HAVE_LIBPNG)\n");
  fprintf(out, "    AC_CHECK_LIB(png,png_get_valid, AC_DEFINE(HAVE_PNG_GET_VALID))\n");
  fprintf(out, "    AC_CHECK_LIB(png,png_set_tRNS_to_alpha, AC_DEFINE(HAVE_PNG_SET_TRNS_TO_ALPHA))\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "AC_SUBST(JPEG)\n");
  fprintf(out, "AC_SUBST(JPEGINC)\n");
  fprintf(out, "AC_SUBST(PNG)\n");
  fprintf(out, "AC_SUBST(PNGINC)\n");
  fprintf(out, "AC_SUBST(ZLIB)\n");
  fprintf(out, "AC_SUBST(ZLIBINC)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Restore original LIBS settings...\n");
  fprintf(out, "LIBS=\"$SAVELIBS\"\n");
  fprintf(out, "\n");
  fprintf(out, "dnl See if we need a .exe extension on executables...\n");
  fprintf(out, "AC_EXEEXT\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Check for pthreads for multi-threaded apps...\n");
  fprintf(out, "have_pthread=no\n");
  fprintf(out, "PTHREAD_FLAGS=\"\"\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Test whether we want to check for pthreads. We must not do it on Windows\n");
  fprintf(out, "dnl unless we run under Cygwin with --enable-cygwin, since we always use\n");
  fprintf(out, "dnl native threads on Windows (even if libpthread is available)\n");
  fprintf(out, "check_pthread=yes\n");
  fprintf(out, "case $uname in\n");
  fprintf(out, "    MINGW*)\n");
  fprintf(out, "\tcheck_pthread=no\n");
  fprintf(out, "\t;;\n");
  fprintf(out, "    CYGWIN*)\n");
  fprintf(out, "\tif test \"x$enable_cygwin\" != xyes; then\n");
  fprintf(out, "\t    check_pthread=no\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\t;;\n");
  fprintf(out, "    *)\n");
  fprintf(out, "\t;;\n");
  fprintf(out, "esac\n");
  fprintf(out, "\n");
  fprintf(out, "if test \"x$enable_threads\" != xno -a x$check_pthread = xyes; then\n");
  fprintf(out, "    AC_CHECK_HEADER(pthread.h, AC_DEFINE(HAVE_PTHREAD_H))\n");
  fprintf(out, "\n");
  fprintf(out, "    if test x$ac_cv_header_pthread_h = xyes; then\n");
  fprintf(out, "\tdnl Check various threading options for the platforms we support\n");
  fprintf(out, "\tfor flag in -lpthreads -lpthread -pthread; do\n");
  fprintf(out, "            AC_MSG_CHECKING([for pthread_create using $flag])\n");
  fprintf(out, "\t    SAVELIBS=\"$LIBS\"\n");
  fprintf(out, "\t    LIBS=\"$flag $LIBS\"\n");
  fprintf(out, "            AC_TRY_LINK([#include <pthread.h>],\n");
  fprintf(out, "\t\t[pthread_create(0, 0, 0, 0);],\n");
  fprintf(out, "        \thave_pthread=yes,\n");
  fprintf(out, "\t\tLIBS=\"$SAVELIBS\")\n");
  fprintf(out, "            AC_MSG_RESULT([$have_pthread])\n");
  fprintf(out, "\n");
  fprintf(out, "\t    if test $have_pthread = yes; then\n");
  fprintf(out, "\t        AC_DEFINE(HAVE_PTHREAD)\n");
  fprintf(out, "\t\tPTHREAD_FLAGS=\"-D_THREAD_SAFE -D_REENTRANT\"\n");
  fprintf(out, "\n");
  fprintf(out, "\t\t# Solaris requires -D_POSIX_PTHREAD_SEMANTICS to\n");
  fprintf(out, "\t\t# be POSIX-compliant... :(\n");
  fprintf(out, "\t\tif test $uname = SunOS; then\n");
  fprintf(out, "\t\t    PTHREAD_FLAGS=\"$PTHREAD_FLAGS -D_POSIX_PTHREAD_SEMANTICS\"\n");
  fprintf(out, "\t\tfi\n");
  fprintf(out, "\t\tbreak\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "\tdone\n");
  fprintf(out, "    fi\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "AC_SUBST(PTHREAD_FLAGS)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Define OS-specific stuff...\n");
  fprintf(out, "HLINKS=\n");
  fprintf(out, "OSX_ONLY=:\n");
  fprintf(out, "THREADS=\n");
  fprintf(out, "\n");
  fprintf(out, "AC_ARG_WITH(links, [  --with-links            make header links for common misspellings (default=no)])\n");
  fprintf(out, "\n");
  fprintf(out, "INSTALL_DESKTOP=\"\"\n");
  fprintf(out, "UNINSTALL_DESKTOP=\"\"\n");
  fprintf(out, "\n");
  fprintf(out, "case $uname_GUI in\n");
  fprintf(out, "    CYGWIN* | MINGW*)\n");
  fprintf(out, "\tdnl Cygwin environment, using windows GDI ...\n");
  fprintf(out, "\t# Recent versions of Cygwin are seriously broken and the size\n");
  fprintf(out, "\t# checks don't work because the shell puts out \\r\\n instead of\n");
  fprintf(out, "\t# \\n.  Here we just force U32 to be defined to \"unsigned\"...\n");
  fprintf(out, "        AC_DEFINE(U32,unsigned)\n");
  fprintf(out, "\tCFLAGS=\"-mwindows -DWIN32 -DUSE_OPENGL32 $CFLAGS\"\n");
  fprintf(out, "\tCXXFLAGS=\"-mwindows -DWIN32 -DUSE_OPENGL32 $CXXFLAGS\"\n");
  fprintf(out, "\tLDFLAGS=\"-mwindows $LDFLAGS\"\n");
  fprintf(out, "\tDSOFLAGS=\"-mwindows $DSOFLAGS\"\n");
  fprintf(out, "\tLIBS=\"$LIBS -lole32 -luuid -lcomctl32\"\n");
  fprintf(out, "\tif test \"x$with_optim\" = x; then\n");
  fprintf(out, "\t    dnl Avoid -Os optimization on Cygwin/MinGW\n");
  fprintf(out, "\t    with_optim=\"-O3\"\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "\tif test x$enable_gl != xno; then\n");
  fprintf(out, "\t    AC_CHECK_HEADER(GL/gl.h,\n");
  fprintf(out, "\t        AC_DEFINE(HAVE_GL)\n");
  fprintf(out, "\t\tGLLIB=\"-lopengl32\")\n");
  fprintf(out, "\t    AC_CHECK_HEADER(GL/glu.h,\n");
  fprintf(out, "        \tAC_DEFINE(HAVE_GL_GLU_H)\n");
  fprintf(out, "\t\tGLLIB=\"-lglu32 $GLLIB\")\n");
  fprintf(out, "\telse\n");
  fprintf(out, "\t    LINKFLTKGL=\"\"\n");
  fprintf(out, "\t    GLLIBNAME=\"\"\n");
  fprintf(out, "\t    GLDSONAME=\"\"\n");
  fprintf(out, "\t    GLDEMOS=\"\"\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "\tif test \"x$enable_threads\" != xno; then\n");
  fprintf(out, "\t    if test x$have_pthread = xyes; then\n");
  fprintf(out, "\t\tAC_DEFINE(HAVE_PTHREAD)\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "        fi\n");
  fprintf(out, "\n");
  fprintf(out, "\tTHREADS=\"threads$EXEEXT\"\n");
  fprintf(out, "\n");
  fprintf(out, "\t# Don't make symlinks since Windows is not case sensitive.\n");
  fprintf(out, "\tif test \"x$with_links\" != xyes; then\n");
  fprintf(out, "\t\tHLINKS=\"#\"\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\t;;\n");
  fprintf(out, "\n");
  fprintf(out, "    Darwin*)\n");
  fprintf(out, "        # MacOS X uses Cocoa for graphics.\n");
  fprintf(out, "        LIBS=\"$LIBS -framework Cocoa\"\n");
  fprintf(out, "\n");
  fprintf(out, "\tif test x$have_pthread = xyes; then\n");
  fprintf(out, "\t    AC_DEFINE(HAVE_PTHREAD)\n");
  fprintf(out, "\t    THREADS=\"threads$EXEEXT\"\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "\tif test x$enable_gl != xno; then\n");
  fprintf(out, "            AC_DEFINE(HAVE_GL)\n");
  fprintf(out, "            AC_DEFINE(HAVE_GL_GLU_H)\n");
  fprintf(out, "            GLLIB=\"-framework AGL -framework OpenGL -framework ApplicationServices\"\n");
  fprintf(out, "        else\n");
  fprintf(out, "\t    LINKFLTKGL=\"\"\n");
  fprintf(out, "\t    GLLIBNAME=\"\"\n");
  fprintf(out, "\t    GLDSONAME=\"\"\n");
  fprintf(out, "\t    GLDEMOS=\"\"\n");
  fprintf(out, "        fi\n");
  fprintf(out, "\n");
  fprintf(out, "\t# Don't make symlinks because HFS+ is not case sensitive...\n");
  fprintf(out, "\tif test \"x$with_links\" != xyes; then\n");
  fprintf(out, "\t\tHLINKS=\"#\"\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "\t# Some steps are only done for OS X package management\n");
  fprintf(out, "\tOSX_ONLY=\n");
  fprintf(out, "\n");
  fprintf(out, "\t# Install/Uninstall FLUID application\n");
  fprintf(out, "\tINSTALL_DESKTOP=\"install-osx\"\n");
  fprintf(out, "\tUNINSTALL_DESKTOP=\"uninstall-osx\"\n");
  fprintf(out, "\t;;\n");
  fprintf(out, "\n");
  fprintf(out, "    *)\n");
  fprintf(out, "\t# All others are UNIX/X11...\n");
  fprintf(out, "\t# This includes Cygwin target combined with X11\n");
  fprintf(out, "\tif test x$have_pthread = xyes; then\n");
  fprintf(out, "\t    AC_DEFINE(HAVE_PTHREAD)\n");
  fprintf(out, "\t    THREADS=\"threads$EXEEXT\"\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "\tdnl Check for X11...\n");
  fprintf(out, "\tAC_PATH_XTRA\n");
  fprintf(out, "\n");
  fprintf(out, "\tif test x$no_x = xyes; then\n");
  fprintf(out, "\t    AC_MSG_ERROR(Configure could not find required X11 libraries, aborting.)\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "\tif test \"x$X_PRE_LIBS\" != x; then\n");
  fprintf(out, "\t    AC_MSG_WARN(Ignoring libraries \\\"$X_PRE_LIBS\\\" requested by configure.)\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "\tLIBS=\"$LIBS -lX11 $X_EXTRA_LIBS\"\n");
  fprintf(out, "\tCFLAGS=\"$CFLAGS $X_CFLAGS\"\n");
  fprintf(out, "\tCXXFLAGS=\"$CXXFLAGS $X_CFLAGS\"\n");
  fprintf(out, "\tLDFLAGS=\"$X_LIBS $LDFLAGS\"\n");
  fprintf(out, "\tDSOFLAGS=\"$X_LIBS $DSOFLAGS\"\n");
  fprintf(out, "\tAC_DEFINE(USE_X11)\n");
  fprintf(out, "\tif test \"x$x_includes\" != x; then\n");
  fprintf(out, "\t    ac_cpp=\"$ac_cpp -I$x_includes\"\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "\tdnl Check for OpenGL unless disabled...\n");
  fprintf(out, "\tGLLIB=\n");
  fprintf(out, "\n");
  fprintf(out, "\tif test x$enable_gl != xno; then\n");
  fprintf(out, "\t    AC_SEARCH_LIBS(dlopen, dl)\n");
  fprintf(out, "\t    AC_CHECK_HEADER(GL/gl.h,\n");
  fprintf(out, "\t\tAC_CHECK_LIB(GL, glXMakeCurrent, AC_DEFINE(HAVE_GL) GLLIB=\"-lGL\",\n");
  fprintf(out, "\t\t    AC_CHECK_LIB(MesaGL,glXMakeCurrent, AC_DEFINE(HAVE_GL) GLLIB=\" -lMesaGL\",,\n");
  fprintf(out, "\t\t\t-lm),\n");
  fprintf(out, "\t\t    -lm)\n");
  fprintf(out, "\t\tAC_CHECK_LIB(GL, glXGetProcAddressARB,\n");
  fprintf(out, "\t\t             AC_DEFINE(HAVE_GLXGETPROCADDRESSARB),, -lm)\n");
  fprintf(out, "\t    )\n");
  fprintf(out, "\t    AC_CHECK_HEADER(GL/glu.h,\n");
  fprintf(out, "        \tAC_DEFINE(HAVE_GL_GLU_H)\n");
  fprintf(out, "\t\tif test x$ac_cv_lib_GL_glXMakeCurrent = xyes; then\n");
  fprintf(out, "\t\t    GLLIB=\"-lGLU $GLLIB\"\n");
  fprintf(out, "\t\tfi\n");
  fprintf(out, "\t\tif test x$ac_cv_lib_MesaGL_glXMakeCurrent = xyes; then\n");
  fprintf(out, "\t\t    GLLIB=\"-lMesaGLU $GLLIB\"\n");
  fprintf(out, "\t\tfi\n");
  fprintf(out, "\t    )\n");
  fprintf(out, "\n");
  fprintf(out, "\t    if test x$ac_cv_lib_GL_glXMakeCurrent != xyes -a x$ac_cv_lib_MesaGL_glXMakeCurrent != xyes; then\n");
  fprintf(out, "\t\t    LINKFLTKGL=\"\"\n");
  fprintf(out, "\t\t    GLLIBNAME=\"\"\n");
  fprintf(out, "\t\t    GLDSONAME=\"\"\n");
  fprintf(out, "\t\t    GLDEMOS=\"\"\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "\telse\n");
  fprintf(out, "\t    LINKFLTKGL=\"\"\n");
  fprintf(out, "\t    GLLIBNAME=\"\"\n");
  fprintf(out, "\t    GLDSONAME=\"\"\n");
  fprintf(out, "\t    GLDEMOS=\"\"\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "\tdnl Check for Xinerama support unless disabled...\n");
  fprintf(out, "        AC_ARG_ENABLE(xinerama, [  --enable-xinerama       turn on Xinerama support [default=yes]])\n");
  fprintf(out, "\n");
  fprintf(out, "\tif test x$enable_xinerama != xno; then\n");
  fprintf(out, "\t    AC_CHECK_LIB(Xinerama,XineramaIsActive,\n");
  fprintf(out, "\t\t    AC_DEFINE(HAVE_XINERAMA)\n");
  fprintf(out, "\t\t    LIBS=\"-lXinerama $LIBS\")\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "\tdnl Check for the Xft library unless disabled...\n");
  fprintf(out, "        AC_ARG_ENABLE(xft, [  --enable-xft            turn on Xft support [default=yes]])\n");
  fprintf(out, "\n");
  fprintf(out, "\tif test x$enable_xft != xno; then\n");
  fprintf(out, "            AC_PATH_PROG(FTCONFIG,freetype-config)\n");
  fprintf(out, "\n");
  fprintf(out, "\t    if test \"x$FTCONFIG\" != x; then\n");
  fprintf(out, "\t        CPPFLAGS=\"`$FTCONFIG --cflags` $CPPFLAGS\"\n");
  fprintf(out, "\t        CXXFLAGS=\"`$FTCONFIG --cflags` $CXXFLAGS\"\n");
  fprintf(out, "\n");
  fprintf(out, "\t        AC_CHECK_LIB(fontconfig, FcPatternCreate)\n");
  fprintf(out, "\t\tAC_CHECK_HEADER(X11/Xft/Xft.h,\n");
  fprintf(out, "\t\t    AC_CHECK_LIB(Xft, XftDrawCreate,\n");
  fprintf(out, "\t\t\tAC_DEFINE(USE_XFT)\n");
  fprintf(out, "\t\t\tLIBS=\"-lXft $LIBS\"))\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "\tdnl Check for the Xdbe extension unless disabled...\n");
  fprintf(out, "        AC_ARG_ENABLE(xdbe, [  --enable-xdbe           turn on Xdbe support [default=yes]])\n");
  fprintf(out, "\n");
  fprintf(out, "\tif test x$enable_xdbe != xno; then\n");
  fprintf(out, "\t    AC_CHECK_HEADER(X11/extensions/Xdbe.h, AC_DEFINE(HAVE_XDBE),,\n");
  fprintf(out, "\t        [#include <X11/Xlib.h>])\n");
  fprintf(out, "\t    AC_CHECK_LIB(Xext, XdbeQueryExtension,\n");
  fprintf(out, "\t\tLIBS=\"-lXext $LIBS\")\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "\tdnl Check for overlay visuals...\n");
  fprintf(out, "\tAC_PATH_PROG(XPROP, xprop)\n");
  fprintf(out, "\tAC_CACHE_CHECK(for X overlay visuals, ac_cv_have_overlay,\n");
  fprintf(out, "\t    if test \"x$XPROP\" != x; then\n");
  fprintf(out, "\t\tif $XPROP -root 2>/dev/null | grep -c \"SERVER_OVERLAY_VISUALS\" >/dev/null; then\n");
  fprintf(out, "        \t    ac_cv_have_overlay=yes\n");
  fprintf(out, "\t\telse\n");
  fprintf(out, "        \t    ac_cv_have_overlay=no\n");
  fprintf(out, "\t\tfi\n");
  fprintf(out, "\t    else\n");
  fprintf(out, "        \tac_cv_have_overlay=no\n");
  fprintf(out, "\t    fi)\n");
  fprintf(out, "\n");
  fprintf(out, "        if test x$ac_cv_have_overlay = xyes; then\n");
  fprintf(out, "\t    AC_DEFINE(HAVE_OVERLAY)\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "\t# Make symlinks since UNIX/Linux is case sensitive,\n");
  fprintf(out, "\t# but Cygwin in general not.\n");
  fprintf(out, "\tcase $uname in\n");
  fprintf(out, "\t    CYGWIN*)\n");
  fprintf(out, "\t\tHLINKS=\"#\"\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\t    *)\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\tesac\n");
  fprintf(out, "\t# Make symlinks since UNIX/Linux is case sensitive,\n");
  fprintf(out, "\t# but only if explicitly configured (default=no)\n");
  fprintf(out, "\tif test \"x$with_links\" != xyes; then\n");
  fprintf(out, "\t\tHLINKS=\"#\"\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "\t# Install/Uninstall FLUID application support files\n");
  fprintf(out, "\tINSTALL_DESKTOP=\"install-linux\"\n");
  fprintf(out, "\tUNINSTALL_DESKTOP=\"uninstall-linux\"\n");
  fprintf(out, "\t;;\n");
  fprintf(out, "esac\n");
  fprintf(out, "\n");
  fprintf(out, "AC_SUBST(GLDEMOS)\n");
  fprintf(out, "AC_SUBST(GLLIB)\n");
  fprintf(out, "AC_SUBST(HLINKS)\n");
  fprintf(out, "AC_SUBST(OSX_ONLY)\n");
  fprintf(out, "AC_SUBST(THREADS)\n");
  fprintf(out, "\n");
  fprintf(out, "AC_SUBST(INSTALL_DESKTOP)\n");
  fprintf(out, "AC_SUBST(UNINSTALL_DESKTOP)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Figure out the appropriate formatted man page extension...\n");
  fprintf(out, "case \"$uname\" in\n");
  fprintf(out, "    *BSD* | Darwin*)\n");
  fprintf(out, "\t# *BSD\n");
  fprintf(out, "\tCAT1EXT=0\n");
  fprintf(out, "\tCAT3EXT=0\n");
  fprintf(out, "\tCAT6EXT=0\n");
  fprintf(out, "\t;;\n");
  fprintf(out, "    IRIX*)\n");
  fprintf(out, "\t# SGI IRIX\n");
  fprintf(out, "\tCAT1EXT=z\n");
  fprintf(out, "\tCAT3EXT=z\n");
  fprintf(out, "\tCAT6EXT=z\n");
  fprintf(out, "\t;;\n");
  fprintf(out, "    *)\n");
  fprintf(out, "\t# All others\n");
  fprintf(out, "\tCAT1EXT=1\n");
  fprintf(out, "\tCAT3EXT=3\n");
  fprintf(out, "\tCAT6EXT=6\n");
  fprintf(out, "\t;;\n");
  fprintf(out, "esac\n");
  fprintf(out, "\n");
  fprintf(out, "AC_SUBST(CAT1EXT)\n");
  fprintf(out, "AC_SUBST(CAT3EXT)\n");
  fprintf(out, "AC_SUBST(CAT6EXT)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Fix \"mandir\" variable...\n");
  fprintf(out, "if test \"$mandir\" = \"\\${prefix}/man\" -a \"$prefix\" = \"/usr\"; then\n");
  fprintf(out, "    case \"$uname\" in\n");
  fprintf(out, "        *BSD* | Darwin* | Linux*)\n");
  fprintf(out, "            # *BSD, Darwin, and Linux\n");
  fprintf(out, "            mandir=\"\\${prefix}/share/man\"\n");
  fprintf(out, "            ;;\n");
  fprintf(out, "        IRIX*)\n");
  fprintf(out, "            # SGI IRIX\n");
  fprintf(out, "            mandir=\"\\${prefix}/share/catman\"\n");
  fprintf(out, "            ;;\n");
  fprintf(out, "    esac\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Fix \"libdir\" variable...\n");
  fprintf(out, "if test \"$prefix\" = NONE; then\n");
  fprintf(out, "    prefix=/usr/local\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "if test \"$exec_prefix\" = NONE; then\n");
  fprintf(out, "    exec_prefix=\"\\${prefix}\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "if test \"$uname\" = \"IRIX\" -a $uversion -ge 62 -a \"$libdir\" = \"\\${exec_prefix}/lib\" -a \"$exec_prefix\" = \"\\${prefix}\" -a \"$prefix\" = \"/usr\"; then\n");
  fprintf(out, "    libdir=\"/usr/lib32\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Define the command used to update the dependencies (this option\n");
  fprintf(out, "dnl mainly for FLTK core developers - not necessary for users)\n");
  fprintf(out, "MAKEDEPEND=\"\\$(CXX) -M\"\n");
  fprintf(out, "AC_SUBST(MAKEDEPEND)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Add warnings to compiler switches:\n");
  fprintf(out, "dnl do this last so messing with switches does not break tests\n");
  fprintf(out, "\n");
  fprintf(out, "if test -n \"$GCC\"; then\n");
  fprintf(out, "    # Show all standard warnings + unused variables, conversion errors,\n");
  fprintf(out, "    # and inlining problems when compiling...\n");
  fprintf(out, "    OPTIM=\"-Wall -Wunused -Wno-format-y2k $OPTIM\"\n");
  fprintf(out, "\n");
  fprintf(out, "    # The following additional warnings are useful for tracking down problems...\n");
  fprintf(out, "    #OPTIM=\"-Wshadow -Wconversion $OPTIM\"\n");
  fprintf(out, "\n");
  fprintf(out, "    # We know that Carbon is deprecated on OS X 10.4. To avoid hundreds of warnings\n");
  fprintf(out, "    # we will temporarily disable 'deprecated' warnings on OS X.\n");
  fprintf(out, "    if test \"$uname\" = \"Darwin\" -a $uversion -ge 800; then\n");
  fprintf(out, "        OPTIM=\"-Wno-deprecated-declarations $OPTIM\"\n");
  fprintf(out, "    fi\n");
  fprintf(out, "\n");
  fprintf(out, "    # Set the default compiler optimizations...\n");
  fprintf(out, "    if test -z \"$DEBUGFLAG\"; then\n");
  fprintf(out, "    \t#\n");
  fprintf(out, "\t# Note: Can't use -fomit-frame-pointer - prevents tools like\n");
  fprintf(out, "\t#       libsafe from working!\n");
  fprintf(out, "        #\n");
  fprintf(out, "\t#       Don't use -fforce-mem, -fforce-addr, or -fcaller-saves.\n");
  fprintf(out, "\t#       They all seem to make either no difference or enlarge\n");
  fprintf(out, "\t#       the code by a few hundred bytes.\n");
  fprintf(out, "        #\n");
  fprintf(out, "\t#       \"-Os\" seems to be the best compromise between speed and\n");
  fprintf(out, "\t#       code size.  \"-O3\" and higher seem to make no effective\n");
  fprintf(out, "\t#       difference in the speed of the code, but does bloat the\n");
  fprintf(out, "\t#       library 10+%%.\n");
  fprintf(out, "\t#\n");
  fprintf(out, "\n");
  fprintf(out, "        if test \"x$with_optim\" != x; then\n");
  fprintf(out, "\t    OPTIM=\"$with_optim $OPTIM\"\n");
  fprintf(out, "\telse\n");
  fprintf(out, "            OPTIM=\"-Os $OPTIM\"\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "    fi\n");
  fprintf(out, "\n");
  fprintf(out, "    # Generate position-independent code when needed...\n");
  fprintf(out, "    if test $PICFLAG = 1; then\n");
  fprintf(out, "    \tOPTIM=\"$OPTIM -fPIC\"\n");
  fprintf(out, "    fi\n");
  fprintf(out, "\n");
  fprintf(out, "    # See if GCC supports -fno-exceptions...\n");
  fprintf(out, "    AC_MSG_CHECKING(if GCC supports -fno-exceptions)\n");
  fprintf(out, "    OLDCFLAGS=\"$CFLAGS\"\n");
  fprintf(out, "    CFLAGS=\"$CFLAGS -fno-exceptions\"\n");
  fprintf(out, "    AC_TRY_COMPILE(,,\n");
  fprintf(out, "\tOPTIM=\"$OPTIM -fno-exceptions\"\n");
  fprintf(out, "\tAC_MSG_RESULT(yes),\n");
  fprintf(out, "\tAC_MSG_RESULT(no))\n");
  fprintf(out, "    CFLAGS=\"$OLDCFLAGS\"\n");
  fprintf(out, "\n");
  fprintf(out, "    # See if GCC supports -fno-strict-aliasing...\n");
  fprintf(out, "    AC_MSG_CHECKING(if GCC supports -fno-strict-aliasing)\n");
  fprintf(out, "    OLDCFLAGS=\"$CFLAGS\"\n");
  fprintf(out, "    CFLAGS=\"$CFLAGS -fno-strict-aliasing\"\n");
  fprintf(out, "    AC_TRY_COMPILE(,,\n");
  fprintf(out, "\tOPTIM=\"$OPTIM -fno-strict-aliasing\"\n");
  fprintf(out, "\tAC_MSG_RESULT(yes),\n");
  fprintf(out, "\tAC_MSG_RESULT(no))\n");
  fprintf(out, "    CFLAGS=\"$OLDCFLAGS\"\n");
  fprintf(out, "\n");
  fprintf(out, "    # See if we are running Solaris; if so, try the -fpermissive option...\n");
  fprintf(out, "    # This option is required on some versions of Solaris to work around\n");
  fprintf(out, "    # bugs in the X headers up through Solaris 7.\n");
  fprintf(out, "    #\n");
  fprintf(out, "    # Unlike the other compiler/optimization settings, this one is placed\n");
  fprintf(out, "    # in CFLAGS and CXXFLAGS so that fltk-config will provide the option\n");
  fprintf(out, "    # to clients - otherwise client apps will not compile properly...\n");
  fprintf(out, "    if test \"$uname\" = SunOS; then\n");
  fprintf(out, "\tAC_MSG_CHECKING(if GCC supports -fpermissive)\n");
  fprintf(out, "\n");
  fprintf(out, "\tOLDCFLAGS=\"$CFLAGS\"\n");
  fprintf(out, "\tCFLAGS=\"$CFLAGS -fpermissive\"\n");
  fprintf(out, "\tAC_TRY_COMPILE(,,\n");
  fprintf(out, "\t    CXXFLAGS=\"$CXXFLAGS -fpermissive\"\n");
  fprintf(out, "\t    AC_MSG_RESULT(yes),\n");
  fprintf(out, "\t    CFLAGS=\"$OLDCFLAGS\"\n");
  fprintf(out, "\t    AC_MSG_RESULT(no))\n");
  fprintf(out, "    fi\n");
  fprintf(out, "else\n");
  fprintf(out, "    case \"$uname\" in\n");
  fprintf(out, "        IRIX*)\n");
  fprintf(out, "\t    # Running some flavor of IRIX; see which version and\n");
  fprintf(out, "\t    # set things up according...\n");
  fprintf(out, "\t    if test \"$uversion\" -ge 62; then\n");
  fprintf(out, "\t        # We are running IRIX 6.2 or higher; uncomment the following\n");
  fprintf(out, "\t\t# lines if you don't have IDO 7.2 or higher:\n");
  fprintf(out, "\t\t#\n");
  fprintf(out, "\t\t#     CXX=\"CC -n32 -mips3\"\n");
  fprintf(out, "\t\t#     CC=\"cc -n32 -mips3\"\n");
  fprintf(out, "\t\t#     LD=\"ld -n32 -mips3\"\n");
  fprintf(out, "\t\t#     MAKEDEPEND=\"CC -M\"\n");
  fprintf(out, "\n");
  fprintf(out, "\t\tif test \"x`grep abi=n32 /etc/compiler.defaults`\" = x; then\n");
  fprintf(out, "\t\t\tAC_MSG_WARN(FOR BEST RESULTS BEFORE COMPILING: setenv SGI_ABI \\\"-n32 -mips3\\\")\n");
  fprintf(out, "\t\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "        \tOPTIM=\"-fullwarn $OPTIM\"\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "\t    if test -z \"$DEBUGFLAG\"; then\n");
  fprintf(out, "        \tif test \"x$with_optim\" != x; then\n");
  fprintf(out, "\t\t    OPTIM=\"$with_optim $OPTIM\"\n");
  fprintf(out, "\t\telse\n");
  fprintf(out, "        \t    OPTIM=\"-O2 $OPTIM\"\n");
  fprintf(out, "\t\t    if test $uversion -gt 62; then\n");
  fprintf(out, "        \t        OPTIM=\"-OPT:Olimit=4000 $OPTIM\"\n");
  fprintf(out, "\t            fi\n");
  fprintf(out, "\t\tfi\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\tHP-UX*)\n");
  fprintf(out, "\t    # Running HP-UX; these options should work for the HP compilers.\n");
  fprintf(out, "\t    if test -z \"$DEBUGFLAG\"; then\n");
  fprintf(out, "        \tif test \"x$with_optim\" != x; then\n");
  fprintf(out, "\t\t    OPTIM=\"$with_optim $OPTIM\"\n");
  fprintf(out, "\t\telse\n");
  fprintf(out, "        \t    OPTIM=\"+O2 $OPTIM\"\n");
  fprintf(out, "\t\tfi\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "\n");
  fprintf(out, "\t    if test $PICFLAG = 1; then\n");
  fprintf(out, "\t\tOPTIM=\"+z $OPTIM\"\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "\n");
  fprintf(out, "\t    CXXFLAGS=\"$CXXFLAGS +W336,501,736,740,749,829\"\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\tOSF1*)\n");
  fprintf(out, "\t    # Running Digital/Tru64 UNIX; these options should work for the\n");
  fprintf(out, "\t    # Digital/Compaq/NewHP compilers.\n");
  fprintf(out, "\t    if test -z \"$DEBUGFLAG\"; then\n");
  fprintf(out, "        \tif test \"x$with_optim\" != x; then\n");
  fprintf(out, "\t\t    OPTIM=\"$with_optim $OPTIM\"\n");
  fprintf(out, "\t\telse\n");
  fprintf(out, "        \t    OPTIM=\"-O2 $OPTIM\"\n");
  fprintf(out, "\t\tfi\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\tSunOS*)\n");
  fprintf(out, "\t    # Solaris\n");
  fprintf(out, "\t    if test -z \"$DEBUGFLAG\"; then\n");
  fprintf(out, "        \tif test \"x$with_optim\" != x; then\n");
  fprintf(out, "\t\t    OPTIM=\"$with_optim $OPTIM\"\n");
  fprintf(out, "\t\telse\n");
  fprintf(out, "        \t    OPTIM=\"-xO3 $OPTIM\"\n");
  fprintf(out, "\t\tfi\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "\n");
  fprintf(out, "\t    if test $PICFLAG = 1; then\n");
  fprintf(out, "\t\tOPTIM=\"-KPIC $OPTIM\"\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\tAIX*)\n");
  fprintf(out, "\t    if test -z \"$DEBUGFLAG\"; then\n");
  fprintf(out, "        \tif test \"x$with_optim\" != x; then\n");
  fprintf(out, "\t\t    OPTIM=\"$with_optim $OPTIM\"\n");
  fprintf(out, "\t\telse\n");
  fprintf(out, "        \t    OPTIM=\"-O2 $OPTIM\"\n");
  fprintf(out, "\t\tfi\n");
  fprintf(out, "\t    fi\n");
  fprintf(out, "\n");
  fprintf(out, "\t    AC_MSG_WARN(The AIX C and C++ compilers are known not to correctly compile the FLTK library.)\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "\t*)\n");
  fprintf(out, "\t    # Running some other operating system; inform the user they\n");
  fprintf(out, "\t    # should contribute the necessary options via the STR form..\n");
  fprintf(out, "\t    AC_MSG_WARN(Building FLTK with default compiler optimizations)\n");
  fprintf(out, "\t    AC_MSG_WARN(Send the FLTK developers your uname and compiler options via http://www.fltk.org/str.php)\n");
  fprintf(out, "\t    ;;\n");
  fprintf(out, "    esac\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "OPTIM=\"$DEBUGFLAG $OPTIM\"\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Take archflags away from CFLAGS (makefiles use ARCHFLAGS explicitly)\n");
  fprintf(out, "if test `uname` = Darwin; then\n");
  fprintf(out, "  if test \"x$with_archflags\" != x ; then\n");
  fprintf(out, "    CFLAGS=\"`echo $CFLAGS | sed -e \"s/$with_archflags//g\"`\"\n");
  fprintf(out, "  fi\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Define the FLTK documentation directory...\n");
  fprintf(out, "case $uname in\n");
  fprintf(out, "  MINGW*)\n");
  fprintf(out, "     # Determine the path where MSys has /usr installed\n");
  fprintf(out, " \tmsyspath=`mount | grep '\\/usr' | grep -v '\\/usr\\/bin' | cut -d ' ' -f -1 | sed -e 's/\\\\\\/\\// g'`\n");
  fprintf(out, "     # Then substitute that in the WIN32 path instead of /usr\n");
  fprintf(out, " \tAC_DEFINE_UNQUOTED(FLTK_DOCDIR, \"$msyspath/local/share/doc/fltk\")\n");
  fprintf(out, "    ;;\n");
  fprintf(out, "  *)\n");
  fprintf(out, "    if test x$prefix = xNONE; then\n");
  fprintf(out, "\tAC_DEFINE_UNQUOTED(FLTK_DOCDIR, \"/usr/local/share/doc/fltk\")\n");
  fprintf(out, "    else\n");
  fprintf(out, "\tAC_DEFINE_UNQUOTED(FLTK_DOCDIR, \"$prefix/share/doc/fltk\")\n");
  fprintf(out, "    fi\n");
  fprintf(out, "    ;;\n");
  fprintf(out, "esac\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Define the FLTK data directory...\n");
  fprintf(out, "if test x$prefix = xNONE; then\n");
  fprintf(out, "    AC_DEFINE_UNQUOTED(FLTK_DATADIR, \"/usr/local/share/fltk\")\n");
  fprintf(out, "else\n");
  fprintf(out, "    AC_DEFINE_UNQUOTED(FLTK_DATADIR, \"$prefix/share/fltk\")\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Summarize results of configure tests...\n");
  fprintf(out, "echo \"\"\n");
  fprintf(out, "echo \"Configuration Summary\"\n");
  fprintf(out, "echo \"-------------------------------------------------------------------------\"\n");
  fprintf(out, "\n");
  fprintf(out, "case $uname_GUI in\n");
  fprintf(out, "    CYGWIN* | MINGW*)\n");
  fprintf(out, "        graphics=\"GDI\"\n");
  fprintf(out, "\t;;\n");
  fprintf(out, "    Darwin*)\n");
  fprintf(out, "        graphics=\"Quartz\"\n");
  fprintf(out, "        ;;\n");
  fprintf(out, "    *)\n");
  fprintf(out, "        graphics=\"X11\"\n");
  fprintf(out, "\tif test x$enable_xft != xno; then\n");
  fprintf(out, "\t    graphics=\"$graphics+Xft\"\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$enable_xdbe != xno; then\n");
  fprintf(out, "\t    graphics=\"$graphics+Xdbe\"\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$enable_xinerama != xno; then\n");
  fprintf(out, "\t    graphics=\"$graphics+Xinerama\"\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "        ;;\n");
  fprintf(out, "esac\n");
  fprintf(out, "\n");
  fprintf(out, "echo \"    Directories: prefix=$prefix\"\n");
  fprintf(out, "echo \"                 bindir=$bindir\"\n");
  fprintf(out, "echo \"                 datadir=$datadir\"\n");
  fprintf(out, "echo \"                 datarootdir=$datarootdir\"\n");
  fprintf(out, "echo \"                 exec_prefix=$exec_prefix\"\n");
  fprintf(out, "echo \"                 includedir=$includedir\"\n");
  fprintf(out, "echo \"                 libdir=$libdir\"\n");
  fprintf(out, "echo \"                 mandir=$mandir\"\n");
  fprintf(out, "case $uname in\n");
  fprintf(out, "  MINGW*)\n");
  fprintf(out, "    echo \"                 MSys docpath=$msyspath/local/share/doc/fltk\"\n");
  fprintf(out, "  ;;\n");
  fprintf(out, "esac\n");
  fprintf(out, "echo \"       Graphics: $graphics\"\n");
  fprintf(out, "\n");
  fprintf(out, "if test x$JPEG = x; then\n");
  fprintf(out, "    echo \"Image Libraries: JPEG=System\"\n");
  fprintf(out, "else\n");
  fprintf(out, "    echo \"Image Libraries: JPEG=Builtin\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "if test x$PNG = x; then\n");
  fprintf(out, "    echo \"                 PNG=System\"\n");
  fprintf(out, "else\n");
  fprintf(out, "    echo \"                 PNG=Builtin\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "if test x$ZLIB = x; then\n");
  fprintf(out, "    echo \"                 ZLIB=System\"\n");
  fprintf(out, "else\n");
  fprintf(out, "    echo \"                 ZLIB=Builtin\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "if test x$enable_cairo = xyes; then\n");
  fprintf(out, "    echo \"                 CAIRO=lib\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "if test x$enable_cairoext = xyes; then\n");
  fprintf(out, "    echo \"                 CAIRO=internal_use\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "\n");
  fprintf(out, "if test x$enable_largefile != xno; then\n");
  fprintf(out, "    echo \"    Large Files: YES\"\n");
  fprintf(out, "else\n");
  fprintf(out, "    echo \"    Large Files: NO\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "if test x$GLDEMOS = x; then\n");
  fprintf(out, "    echo \"         OpenGL: NO\"\n");
  fprintf(out, "else\n");
  fprintf(out, "    echo \"         OpenGL: YES\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "if test x$THREADS = x; then\n");
  fprintf(out, "    echo \"        Threads: NO\"\n");
  fprintf(out, "else\n");
  fprintf(out, "    echo \"        Threads: YES\"\n");
  fprintf(out, "fi\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Write all of the files...\n");
  fprintf(out, "AC_CONFIG_HEADER(config.h:configh.in)\n");
  fprintf(out, "AC_OUTPUT(makeinclude fltk.list fltk-config fltk.spec FL/Makefile)\n");
  fprintf(out, "\n");
  fprintf(out, "dnl Make sure the fltk-config script is executable...\n");
  fprintf(out, "chmod +x fltk-config\n");
  fprintf(out, "\n");
  fprintf(out, "dnl\n");
  fprintf(out, "dnl End of \"$Id: configure.in 8740 2011-05-26 14:43:46Z matt $\".\n");
  fprintf(out, "dnl\n");
  return 0;
}

static int write_fluid_makefile(FILE *out, Fl_Workspace_Type *workspace, const char *path, const char *base_dir, const char *tgt_base, Fl_Target_Type *first_target) {
  fprintf(out, "#\n");
  fprintf(out, "# \"$Id: Makefile 8947 2011-08-13 12:01:15Z matt $\"\n");
  fprintf(out, "#\n");
  fprintf(out, "# FLUID makefile for the Fast Light Tool Kit (FLTK).\n");
  fprintf(out, "#\n");
  fprintf(out, "# Copyright 1998-2011 by Bill Spitzak and others.\n");
  fprintf(out, "#\n");
  fprintf(out, "# This library is free software; you can redistribute it and/or\n");
  fprintf(out, "# modify it under the terms of the GNU Library General Public\n");
  fprintf(out, "# License as published by the Free Software Foundation; either\n");
  fprintf(out, "# version 2 of the License, or (at your option) any later version.\n");
  fprintf(out, "#\n");
  fprintf(out, "# This library is distributed in the hope that it will be useful,\n");
  fprintf(out, "# but WITHOUT ANY WARRANTY; without even the implied warranty of\n");
  fprintf(out, "# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n");
  fprintf(out, "# Library General Public License for more details.\n");
  fprintf(out, "#\n");
  fprintf(out, "# You should have received a copy of the GNU Library General Public\n");
  fprintf(out, "# License along with this library; if not, write to the Free Software\n");
  fprintf(out, "# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307\n");
  fprintf(out, "# USA.\n");
  fprintf(out, "#\n");
  fprintf(out, "# Please report all bugs and problems on the following page:\n");
  fprintf(out, "#\n");
  fprintf(out, "#      http://www.fltk.org/str.php\n");
  fprintf(out, "#\n");
  fprintf(out, "\n");
  fprintf(out, "CPPFILES =  \\\n");
  fprintf(out, "\tCodeEditor.cxx \\\n");
  fprintf(out, "\tFl_Function_Type.cxx \\\n");
  fprintf(out, "\tFl_Group_Type.cxx \\\n");
  fprintf(out, "\tFl_Menu_Type.cxx \\\n");
  fprintf(out, "\tFl_Type.cxx \\\n");
  fprintf(out, "\tFl_Widget_Type.cxx \\\n");
  fprintf(out, "\tFl_Window_Type.cxx \\\n");
  fprintf(out, "\tFluid_Image.cxx \\\n");
  fprintf(out, "\tabout_panel.cxx \\\n");
  fprintf(out, "\talign_widget.cxx \\\n");
  fprintf(out, "\talignment_panel.cxx \\\n");
  fprintf(out, "\tcode.cxx \\\n");
  fprintf(out, "\tfactory.cxx \\\n");
  fprintf(out, "\tfile.cxx \\\n");
  fprintf(out, "\tfile_cmake.cxx \\\n");
  fprintf(out, "\tfile_make.cxx \\\n");
  fprintf(out, "\tfile_visualc_6.cxx \\\n");
  fprintf(out, "\tfile_visualc_2008.cxx \\\n");
  fprintf(out, "\tfile_visualc_2010.cxx \\\n");
  fprintf(out, "\tfile_xcode.cxx \\\n");
  fprintf(out, "\tfluid.cxx \\\n");
  fprintf(out, "\tfunction_panel.cxx \\\n");
  fprintf(out, "\ttemplate_panel.cxx \\\n");
  fprintf(out, "\tundo.cxx \\\n");
  fprintf(out, "\twidget_panel.cxx \\\n");
  fprintf(out, "\tworkspace_panel.cxx\n");
  fprintf(out, "\n");
  fprintf(out, "################################################################\n");
  fprintf(out, "\n");
  fprintf(out, "OBJECTS = $(CPPFILES:.cxx=.o)\n");
  fprintf(out, "\n");
  fprintf(out, "include ../makeinclude\n");
  fprintf(out, "\n");
  fprintf(out, "all:\t$(FLUID) fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "fluid$(EXEEXT):\t\t$(OBJECTS) $(LIBNAME) $(FLLIBNAME) \\\n");
  fprintf(out, "\t\t\t$(IMGLIBNAME)\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ $(OBJECTS) $(LINKFLTKFORMS) $(LINKFLTKIMG) $(LDLIBS)\n");
  fprintf(out, "\t$(OSX_ONLY) $(INSTALL_BIN) fluid fluid.app/Contents/MacOS\n");
  fprintf(out, "\n");
  fprintf(out, "fluid-shared$(EXEEXT):\t$(OBJECTS) ../src/$(DSONAME) ../src/$(FLDSONAME) \\\n");
  fprintf(out, "\t\t\t../src/$(IMGDSONAME)\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ $(OBJECTS) $(LINKSHARED) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "clean:\n");
  fprintf(out, "\t-$(RM) *.o core.* *~ *.bck *.bck\n");
  fprintf(out, "\t-$(RM) core fluid$(EXEEXT) fluid-shared$(EXEEXT)\n");
  fprintf(out, "\t-$(RM) fluid.app/Contents/MacOS/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "depend:\t$(CPPFILES)\n");
  fprintf(out, "\tmakedepend -Y -I.. -f makedepend $(CPPFILES)\n");
  fprintf(out, "\n");
  fprintf(out, "# Automatically generated dependencies...\n");
  fprintf(out, "include makedepend\n");
  fprintf(out, "\n");
  fprintf(out, "install: all\n");
  fprintf(out, "\techo \"Installing FLUID in $(DESTDIR)$(bindir)...\"\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)$(bindir)\n");
  fprintf(out, "\t$(INSTALL_BIN) $(FLUID) $(DESTDIR)$(bindir)/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "install-linux:\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/usr/share/applications\n");
  fprintf(out, "\t$(INSTALL_DATA) fluid.desktop  $(DESTDIR)/usr/share/applications\n");
  fprintf(out, "\tfor size in 16 32 48 64 128; do \\\n");
  fprintf(out, "\t\tif test ! -d $(DESTDIR)/usr/share/icons/hicolor/$${size}x$${size}/apps; then \\\n");
  fprintf(out, "\t\t\t$(INSTALL_DIR) $(DESTDIR)/usr/share/icons/hicolor/$${size}x$${size}/apps; \\\n");
  fprintf(out, "\t\tfi; \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) icons/fluid-$$size.png $(DESTDIR)/usr/share/icons/hicolor/$${size}x$${size}/apps/fluid.png; \\\n");
  fprintf(out, "\tdone\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/usr/share/mimelnk/application\n");
  fprintf(out, "\t$(INSTALL_DATA) x-fluid.desktop  $(DESTDIR)/usr/share/mimelnk/application\n");
  fprintf(out, "\n");
  fprintf(out, "install-osx:\n");
  fprintf(out, "\techo Installing Fluid in $(DESTDIR)/Applications...\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/Applications/fluid.app\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/Applications/fluid.app/Contents\n");
  fprintf(out, "\t$(INSTALL_DATA) fluid.app/Contents/Info.plist $(DESTDIR)/Applications/fluid.app/Contents/Info.plist\n");
  fprintf(out, "\t$(INSTALL_DATA) fluid.app/Contents/PkgInfo $(DESTDIR)/Applications/fluid.app/Contents/PkgInfo\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/Applications/fluid.app/Contents/MacOS\n");
  fprintf(out, "\t$(RM) $(DESTDIR)/Applications/fluid.app/Contents/MacOS/fluid\n");
  fprintf(out, "\t$(LN) $(bindir)/fluid $(DESTDIR)/Applications/fluid.app/Contents/MacOS/fluid\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/Applications/fluid.app/Contents/Resources\n");
  fprintf(out, "\t$(INSTALL_DATA) fluid.app/Contents/Resources/fluid.icns $(DESTDIR)/Applications/fluid.app/Contents/Resources\n");
  fprintf(out, "\n");
  fprintf(out, "uninstall:\n");
  fprintf(out, "\t$(RM) $(DESTDIR)$(bindir)/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "uninstall-linux:\n");
  fprintf(out, "\t$(RM) $(DESTDIR)/usr/share/applications/fluid.desktop\n");
  fprintf(out, "\t$(RM) $(DESTDIR)/usr/share/icons/hicolor/*/fluid.png\n");
  fprintf(out, "\t$(RM) $(DESTDIR)/usr/share/mimelnk/application/x-fluid.desktop\n");
  fprintf(out, "\n");
  fprintf(out, "uninstall-osx:\n");
  fprintf(out, "\t$(RM) -r $(DESTDIR)/Applications/fluid.app\n");
  fprintf(out, "\n");
  fprintf(out, "\n");
  fprintf(out, "#\n");
  fprintf(out, "# Note: The rebuild target can only be used if you have the original .fl\n");
  fprintf(out, "#       files.  This is normally only used by the FLTK maintainers...\n");
  fprintf(out, "#\n");
  fprintf(out, "\n");
  fprintf(out, "rebuild:\n");
  fprintf(out, "\t./fluid -c about_panel.fl\n");
  fprintf(out, "\t./fluid -c alignment_panel.fl\n");
  fprintf(out, "\t./fluid -c function_panel.fl\n");
  fprintf(out, "\t./fluid -c print_panel.fl\n");
  fprintf(out, "\t./fluid -c template_panel.fl\n");
  fprintf(out, "\t./fluid -c widget_panel.fl\n");
  fprintf(out, "\n");
  fprintf(out, "#\n");
  fprintf(out, "# End of \"$Id: Makefile 8947 2011-08-13 12:01:15Z matt $\".\n");
  fprintf(out, "#\n");
  return 0;
}

static int write_fltk_makefile(FILE *out, Fl_Workspace_Type *workspace, const char *path, const char *base_dir, const char *tgt_base, Fl_Target_Type *first_target) {
  fprintf(out, "#\n");
  fprintf(out, "# \"$Id: Makefile 8899 2011-08-02 10:05:56Z matt $\"\n");
  fprintf(out, "#\n");
  fprintf(out, "# Library makefile for the Fast Light Tool Kit (FLTK).\n");
  fprintf(out, "#\n");
  fprintf(out, "# Copyright 1998-2010 by Bill Spitzak and others.\n");
  fprintf(out, "#\n");
  fprintf(out, "# This library is free software; you can redistribute it and/or\n");
  fprintf(out, "# modify it under the terms of the GNU Library General Public\n");
  fprintf(out, "# License as published by the Free Software Foundation; either\n");
  fprintf(out, "# version 2 of the License, or (at your option) any later version.\n");
  fprintf(out, "#\n");
  fprintf(out, "# This library is distributed in the hope that it will be useful,\n");
  fprintf(out, "# but WITHOUT ANY WARRANTY; without even the implied warranty of\n");
  fprintf(out, "# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n");
  fprintf(out, "# Library General Public License for more details.\n");
  fprintf(out, "#\n");
  fprintf(out, "# You should have received a copy of the GNU Library General Public\n");
  fprintf(out, "# License along with this library; if not, write to the Free Software\n");
  fprintf(out, "# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307\n");
  fprintf(out, "# USA.\n");
  fprintf(out, "#\n");
  fprintf(out, "# Please report all bugs and problems on the following page:\n");
  fprintf(out, "#\n");
  fprintf(out, "#      http://www.fltk.org/str.php\n");
  fprintf(out, "#\n");
  fprintf(out, "\n");
  fprintf(out, "CPPFILES =  \\\n");
  fprintf(out, "\tFl.cxx \\\n");
  fprintf(out, "\tFl_Adjuster.cxx \\\n");
  fprintf(out, "\tFl_Bitmap.cxx \\\n");
  fprintf(out, "\tFl_Box.cxx \\\n");
  fprintf(out, "\tFl_Browser.cxx \\\n");
  fprintf(out, "\tFl_Browser_.cxx \\\n");
  fprintf(out, "\tFl_Browser_load.cxx \\\n");
  fprintf(out, "\tFl_Button.cxx \\\n");
  fprintf(out, "\tFl_Chart.cxx \\\n");
  fprintf(out, "\tFl_Check_Browser.cxx \\\n");
  fprintf(out, "\tFl_Check_Button.cxx \\\n");
  fprintf(out, "\tFl_Choice.cxx \\\n");
  fprintf(out, "\tFl_Clock.cxx \\\n");
  fprintf(out, "\tFl_Color_Chooser.cxx \\\n");
  fprintf(out, "\tFl_Counter.cxx \\\n");
  fprintf(out, "\tFl_Device.cxx \\\n");
  fprintf(out, "\tFl_Dial.cxx \\\n");
  fprintf(out, "\tFl_Double_Window.cxx \\\n");
  fprintf(out, "\tFl_File_Browser.cxx \\\n");
  fprintf(out, "\tFl_File_Chooser.cxx \\\n");
  fprintf(out, "\tFl_File_Chooser2.cxx \\\n");
  fprintf(out, "\tFl_File_Icon.cxx \\\n");
  fprintf(out, "\tFl_File_Input.cxx \\\n");
  fprintf(out, "\tFl_Group.cxx \\\n");
  fprintf(out, "\tFl_Help_View.cxx \\\n");
  fprintf(out, "\tFl_Image.cxx \\\n");
  fprintf(out, "\tFl_Input.cxx \\\n");
  fprintf(out, "\tFl_Input_.cxx \\\n");
  fprintf(out, "\tFl_Light_Button.cxx \\\n");
  fprintf(out, "\tFl_Menu.cxx \\\n");
  fprintf(out, "\tFl_Menu_.cxx \\\n");
  fprintf(out, "\tFl_Menu_Bar.cxx \\\n");
  fprintf(out, "\tFl_Menu_Button.cxx \\\n");
  fprintf(out, "\tFl_Menu_Window.cxx \\\n");
  fprintf(out, "\tFl_Menu_add.cxx \\\n");
  fprintf(out, "\tFl_Menu_global.cxx \\\n");
  fprintf(out, "\tFl_Multi_Label.cxx \\\n");
  fprintf(out, "\tFl_Native_File_Chooser.cxx \\\n");
  fprintf(out, "\tFl_Overlay_Window.cxx \\\n");
  fprintf(out, "\tFl_Pack.cxx \\\n");
  fprintf(out, "\tFl_Paged_Device.cxx \\\n");
  fprintf(out, "\tFl_Pixmap.cxx \\\n");
  fprintf(out, "\tFl_Positioner.cxx \\\n");
  fprintf(out, "\tFl_Printer.cxx \\\n");
  fprintf(out, "\tFl_Preferences.cxx \\\n");
  fprintf(out, "\tFl_Progress.cxx \\\n");
  fprintf(out, "\tFl_Repeat_Button.cxx \\\n");
  fprintf(out, "\tFl_Return_Button.cxx \\\n");
  fprintf(out, "\tFl_Roller.cxx \\\n");
  fprintf(out, "\tFl_Round_Button.cxx \\\n");
  fprintf(out, "\tFl_Scroll.cxx \\\n");
  fprintf(out, "\tFl_Scrollbar.cxx \\\n");
  fprintf(out, "\tFl_Shared_Image.cxx \\\n");
  fprintf(out, "\tFl_Single_Window.cxx \\\n");
  fprintf(out, "\tFl_Slider.cxx \\\n");
  fprintf(out, "\tFl_Sys_Menu_Bar.cxx \\\n");
  fprintf(out, "\tFl_Table.cxx \\\n");
  fprintf(out, "\tFl_Table_Row.cxx \\\n");
  fprintf(out, "\tFl_Tabs.cxx \\\n");
  fprintf(out, "\tFl_Text_Buffer.cxx \\\n");
  fprintf(out, "\tFl_Text_Display.cxx \\\n");
  fprintf(out, "\tFl_Text_Editor.cxx \\\n");
  fprintf(out, "\tFl_Tile.cxx \\\n");
  fprintf(out, "\tFl_Tiled_Image.cxx \\\n");
  fprintf(out, "\tFl_Tooltip.cxx \\\n");
  fprintf(out, "\tFl_Tree.cxx \\\n");
  fprintf(out, "\tFl_Tree_Item.cxx \\\n");
  fprintf(out, "\tFl_Tree_Item_Array.cxx \\\n");
  fprintf(out, "\tFl_Tree_Prefs.cxx \\\n");
  fprintf(out, "\tFl_Valuator.cxx \\\n");
  fprintf(out, "\tFl_Value_Input.cxx \\\n");
  fprintf(out, "\tFl_Value_Output.cxx \\\n");
  fprintf(out, "\tFl_Value_Slider.cxx \\\n");
  fprintf(out, "\tFl_Widget.cxx \\\n");
  fprintf(out, "\tFl_Window.cxx \\\n");
  fprintf(out, "\tFl_Window_fullscreen.cxx \\\n");
  fprintf(out, "\tFl_Window_hotspot.cxx \\\n");
  fprintf(out, "\tFl_Window_iconize.cxx \\\n");
  fprintf(out, "\tFl_Wizard.cxx \\\n");
  fprintf(out, "\tFl_XBM_Image.cxx \\\n");
  fprintf(out, "\tFl_XPM_Image.cxx \\\n");
  fprintf(out, "\tFl_abort.cxx \\\n");
  fprintf(out, "\tFl_add_idle.cxx \\\n");
  fprintf(out, "\tFl_arg.cxx \\\n");
  fprintf(out, "\tFl_compose.cxx \\\n");
  fprintf(out, "\tFl_display.cxx \\\n");
  fprintf(out, "\tFl_get_key.cxx \\\n");
  fprintf(out, "\tFl_get_system_colors.cxx \\\n");
  fprintf(out, "\tFl_grab.cxx \\\n");
  fprintf(out, "\tFl_lock.cxx \\\n");
  fprintf(out, "\tFl_own_colormap.cxx \\\n");
  fprintf(out, "\tFl_visual.cxx \\\n");
  fprintf(out, "\tFl_x.cxx \\\n");
  fprintf(out, "\tfilename_absolute.cxx \\\n");
  fprintf(out, "\tfilename_expand.cxx \\\n");
  fprintf(out, "\tfilename_ext.cxx \\\n");
  fprintf(out, "\tfilename_isdir.cxx \\\n");
  fprintf(out, "\tfilename_list.cxx \\\n");
  fprintf(out, "\tfilename_match.cxx \\\n");
  fprintf(out, "\tfilename_setext.cxx \\\n");
  fprintf(out, "\tfl_arc.cxx \\\n");
  fprintf(out, "\tfl_arci.cxx \\\n");
  fprintf(out, "\tfl_ask.cxx \\\n");
  fprintf(out, "\tfl_boxtype.cxx \\\n");
  fprintf(out, "\tfl_call_main.cxx \\\n");
  fprintf(out, "\tfl_color.cxx \\\n");
  fprintf(out, "\tfl_cursor.cxx \\\n");
  fprintf(out, "\tfl_curve.cxx \\\n");
  fprintf(out, "\tfl_diamond_box.cxx \\\n");
  fprintf(out, "\tfl_dnd.cxx \\\n");
  fprintf(out, "\tfl_draw.cxx \\\n");
  fprintf(out, "\tfl_draw_image.cxx \\\n");
  fprintf(out, "\tfl_draw_pixmap.cxx \\\n");
  fprintf(out, "\tfl_encoding_latin1.cxx \\\n");
  fprintf(out, "\tfl_encoding_mac_roman.cxx \\\n");
  fprintf(out, "\tfl_engraved_label.cxx \\\n");
  fprintf(out, "\tfl_file_dir.cxx \\\n");
  fprintf(out, "\tfl_font.cxx \\\n");
  fprintf(out, "\tfl_gtk.cxx \\\n");
  fprintf(out, "\tfl_labeltype.cxx \\\n");
  fprintf(out, "\tfl_line_style.cxx \\\n");
  fprintf(out, "\tfl_open_uri.cxx \\\n");
  fprintf(out, "\tfl_oval_box.cxx \\\n");
  fprintf(out, "\tfl_overlay.cxx \\\n");
  fprintf(out, "\tfl_overlay_visual.cxx \\\n");
  fprintf(out, "\tfl_plastic.cxx \\\n");
  fprintf(out, "\tfl_read_image.cxx \\\n");
  fprintf(out, "\tfl_rect.cxx \\\n");
  fprintf(out, "\tfl_round_box.cxx \\\n");
  fprintf(out, "\tfl_rounded_box.cxx \\\n");
  fprintf(out, "\tfl_scroll_area.cxx \\\n");
  fprintf(out, "\tfl_set_font.cxx \\\n");
  fprintf(out, "\tfl_set_fonts.cxx \\\n");
  fprintf(out, "\tfl_shadow_box.cxx \\\n");
  fprintf(out, "\tfl_shortcut.cxx \\\n");
  fprintf(out, "\tfl_show_colormap.cxx \\\n");
  fprintf(out, "\tfl_symbols.cxx \\\n");
  fprintf(out, "\tfl_utf8.cxx \\\n");
  fprintf(out, "\tfl_utf.cxx \\\n");
  fprintf(out, "\tfl_vertex.cxx \\\n");
  fprintf(out, "\tnumericsort.cxx \\\n");
  fprintf(out, "\tps_image.cxx \\\n");
  fprintf(out, "\tscandir.cxx \\\n");
  fprintf(out, "\tscreen_xywh.cxx\n");
  fprintf(out, "\t\n");
  fprintf(out, "OBJCPPFILES =  \\\n");
  fprintf(out, "\tFl_cocoa.mm \\\n");
  fprintf(out, "\tFl_Native_File_Chooser_MAC.mm \\\n");
  fprintf(out, "\tFl_Quartz_Printer.mm\n");
  fprintf(out, "\t\n");
  fprintf(out, "GLCPPFILES = \\\n");
  fprintf(out, "\tFl_Gl_Choice.cxx \\\n");
  fprintf(out, "\tFl_Gl_Overlay.cxx \\\n");
  fprintf(out, "\tFl_Gl_Device_Plugin.cxx \\\n");
  fprintf(out, "\tFl_Gl_Window.cxx \\\n");
  fprintf(out, "\tfreeglut_geometry.cxx \\\n");
  fprintf(out, "\tfreeglut_stroke_mono_roman.cxx \\\n");
  fprintf(out, "\tfreeglut_stroke_roman.cxx \\\n");
  fprintf(out, "\tfreeglut_teapot.cxx \\\n");
  fprintf(out, "\tgl_draw.cxx \\\n");
  fprintf(out, "\tgl_start.cxx \\\n");
  fprintf(out, "\tglut_compatability.cxx \\\n");
  fprintf(out, "\tglut_font.cxx\n");
  fprintf(out, "\n");
  fprintf(out, "IMGCPPFILES = \\\n");
  fprintf(out, "\tfl_images_core.cxx \\\n");
  fprintf(out, "\tFl_BMP_Image.cxx \\\n");
  fprintf(out, "\tFl_File_Icon2.cxx \\\n");
  fprintf(out, "\tFl_GIF_Image.cxx \\\n");
  fprintf(out, "\tFl_Help_Dialog.cxx \\\n");
  fprintf(out, "\tFl_JPEG_Image.cxx \\\n");
  fprintf(out, "\tFl_PNG_Image.cxx \\\n");
  fprintf(out, "\tFl_PNM_Image.cxx\n");
  fprintf(out, "\n");
  fprintf(out, "CFILES =  \\\n");
  fprintf(out, "\tflstring.c \\\n");
  fprintf(out, "\tvsnprintf.c \\\n");
  fprintf(out, "\txutf8/case.c \\\n");
  fprintf(out, "\txutf8/is_right2left.c \\\n");
  fprintf(out, "\txutf8/is_spacing.c \\\n");
  fprintf(out, "\txutf8/keysym2Ucs.c \\\n");
  fprintf(out, "\txutf8/utf8Input.c \\\n");
  fprintf(out, "\txutf8/utf8Utils.c \\\n");
  fprintf(out, "\txutf8/utf8Wrap.c\n");
  fprintf(out, "\n");
  fprintf(out, "################################################################\n");
  fprintf(out, "FLTKFLAGS = -DFL_LIBRARY\n");
  fprintf(out, "include ../makeinclude\n");
  fprintf(out, "\n");
  fprintf(out, "MMFILES = $(shell if test $(USEMMFILES) = Yes; then echo $(OBJCPPFILES); fi)\n");
  fprintf(out, "\n");
  fprintf(out, "OBJECTS =  $(MMFILES:.mm=.o) $(CPPFILES:.cxx=.o) $(CFILES:.c=.o)\n");
  fprintf(out, "GLOBJECTS = $(GLCPPFILES:.cxx=.o)\n");
  fprintf(out, "FLOBJECTS = $(FLCPPFILES:.cxx=.o)\n");
  fprintf(out, "IMGOBJECTS = $(IMGCPPFILES:.cxx=.o)\n");
  fprintf(out, "\n");
  fprintf(out, "all:\t$(LIBNAME) $(DSONAME) \\\n");
  fprintf(out, "\t$(FLLIBNAME) $(FLDSONAME) \\\n");
  fprintf(out, "\t$(GLLIBNAME) $(GLDSONAME) \\\n");
  fprintf(out, "\t$(IMGLIBNAME) $(IMGDSONAME) \n");
  fprintf(out, "\n");
  fprintf(out, "$(LIBNAME): $(OBJECTS)\n");
  fprintf(out, "\techo $(LIBCOMMAND) $@ ...\n");
  fprintf(out, "\t$(RM) $@\n");
  fprintf(out, "\t$(LIBCOMMAND) $@ $(OBJECTS)\n");
  fprintf(out, "\t$(RANLIB) $@\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk.so.1.3: $(OBJECTS)\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ $(OBJECTS)\n");
  fprintf(out, "\t$(RM) libfltk.so\n");
  fprintf(out, "\t$(LN) libfltk.so.1.3 libfltk.so\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk.sl.1.3: $(OBJECTS)\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ $(OBJECTS)\n");
  fprintf(out, "\t$(RM) libfltk.sl\n");
  fprintf(out, "\t$(LN) libfltk.sl.1.3 libfltk.sl\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk.1.3.dylib: $(OBJECTS)\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ \\\n");
  fprintf(out, "\t\t-install_name $(libdir)/$@ \\\n");
  fprintf(out, "\t\t-current_version 1.3.0 \\\n");
  fprintf(out, "\t\t-compatibility_version 1.3.0 \\\n");
  fprintf(out, "\t\t$(OBJECTS) $(LDLIBS)\n");
  fprintf(out, "\t$(RM) libfltk.dylib\n");
  fprintf(out, "\t$(LN) libfltk.1.3.dylib libfltk.dylib\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk_s.a: $(OBJECTS)\n");
  fprintf(out, "\techo $(DSOCOMMAND) libfltk_s.o ...\n");
  fprintf(out, "\t$(DSOCOMMAND) libfltk_s.o $(OBJECTS) $(IMAGELIBS)\n");
  fprintf(out, "\techo $(LIBCOMMAND) libfltk_s.a libfltk_s.o\n");
  fprintf(out, "\t$(RM) $@\n");
  fprintf(out, "\t$(LIBCOMMAND) libfltk_s.a libfltk_s.o\n");
  fprintf(out, "\t$(CHMOD) +x libfltk_s.a\n");
  fprintf(out, "\n");
  fprintf(out, "$(FLLIBNAME): $(FLOBJECTS)\n");
  fprintf(out, "\techo $(LIBCOMMAND) $@ ...\n");
  fprintf(out, "\t$(RM) $@\n");
  fprintf(out, "\t$(LIBCOMMAND) $@ $(FLOBJECTS)\n");
  fprintf(out, "\t$(RANLIB) $@\n");
  fprintf(out, "\n");
  fprintf(out, "$(GLLIBNAME): $(GLOBJECTS)\n");
  fprintf(out, "\techo $(LIBCOMMAND) $@ ...\n");
  fprintf(out, "\t$(RM) $@\n");
  fprintf(out, "\t$(LIBCOMMAND) $@ $(GLOBJECTS)\n");
  fprintf(out, "\t$(RANLIB) $@\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk_gl.so.1.3: $(GLOBJECTS) libfltk.so.1.3\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ $(GLOBJECTS) -L. -lfltk\n");
  fprintf(out, "\t$(RM) libfltk_gl.so\n");
  fprintf(out, "\t$(LN) libfltk_gl.so.1.3 libfltk_gl.so\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk_gl.sl.1.3: $(GLOBJECTS) libfltk.sl.1.3\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ $(GLOBJECTS) -L. -lfltk\n");
  fprintf(out, "\t$(RM) libfltk_gl.sl\n");
  fprintf(out, "\t$(LN) libfltk_gl.sl.1.3 libfltk_gl.sl\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk_gl.1.3.dylib: $(GLOBJECTS) libfltk.1.3.dylib\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ \\\n");
  fprintf(out, "\t\t-install_name $(libdir)/$@ \\\n");
  fprintf(out, "\t\t-current_version 1.3.0 \\\n");
  fprintf(out, "\t\t-compatibility_version 1.3.0 \\\n");
  fprintf(out, "\t\t$(GLOBJECTS) -L. $(GLDLIBS) -lfltk\n");
  fprintf(out, "\t$(RM) libfltk_gl.dylib\n");
  fprintf(out, "\t$(LN) libfltk_gl.1.3.dylib libfltk_gl.dylib\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk_gl_s.a: $(GLOBJECTS)\n");
  fprintf(out, "\techo $(DSOCOMMAND) libfltk_gl_s.o ...\n");
  fprintf(out, "\t$(DSOCOMMAND) libfltk_gl_s.o $(GLOBJECTS)\n");
  fprintf(out, "\techo $(LIBCOMMAND) libfltk_gl_s.a libfltk_gl_s.o\n");
  fprintf(out, "\t$(RM) $@\n");
  fprintf(out, "\t$(LIBCOMMAND) libfltk_gl_s.a libfltk_gl_s.o\n");
  fprintf(out, "\t$(CHMOD) +x libfltk_gl_s.a\n");
  fprintf(out, "\n");
  fprintf(out, "$(IMGLIBNAME): $(IMGOBJECTS)\n");
  fprintf(out, "\techo $(LIBCOMMAND) $@ ...\n");
  fprintf(out, "\t$(RM) $@\n");
  fprintf(out, "\t$(LIBCOMMAND) $@ $(IMGOBJECTS)\n");
  fprintf(out, "\t$(RANLIB) $@\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk_images.so.1.3: $(IMGOBJECTS) libfltk.so.1.3\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ $(IMGOBJECTS) -L. $(IMAGELIBS) -lfltk\n");
  fprintf(out, "\t$(RM) libfltk_images.so\n");
  fprintf(out, "\t$(LN) libfltk_images.so.1.3 libfltk_images.so\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk_images.sl.1.3: $(IMGOBJECTS) libfltk.sl.1.3\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ $(IMGOBJECTS) -L. $(IMAGELIBS) -lfltk\n");
  fprintf(out, "\t$(RM) libfltk_images.sl\n");
  fprintf(out, "\t$(LN) libfltk_images.sl.1.3 libfltk_images.sl\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk_images.1.3.dylib: $(IMGOBJECTS) libfltk.1.3.dylib\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ \\\n");
  fprintf(out, "\t\t-install_name $(libdir)/$@ \\\n");
  fprintf(out, "\t\t-current_version 1.3.0 \\\n");
  fprintf(out, "\t\t-compatibility_version 1.3.0 \\\n");
  fprintf(out, "\t\t$(IMGOBJECTS)  -L. $(LDLIBS) $(IMAGELIBS) -lfltk\n");
  fprintf(out, "\t$(RM) libfltk_images.dylib\n");
  fprintf(out, "\t$(LN) libfltk_images.1.3.dylib libfltk_images.dylib\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk_images_s.a: $(IMGOBJECTS)\n");
  fprintf(out, "\techo $(DSOCOMMAND) libfltk_images_s.o ...\n");
  fprintf(out, "\t$(DSOCOMMAND) libfltk_images_s.o $(IMGOBJECTS)\n");
  fprintf(out, "\techo $(LIBCOMMAND) libfltk_images_s.a libfltk_images_s.o\n");
  fprintf(out, "\t$(RM) $@\n");
  fprintf(out, "\t$(LIBCOMMAND) libfltk_images_s.a libfltk_images_s.o\n");
  fprintf(out, "\t$(CHMOD) +x libfltk_images_s.a\n");
  fprintf(out, "\n");
  fprintf(out, "#-----------------------------------------------------------------\n");
  fprintf(out, "# - the import libraries libfltk*.dll.a and the .dll files\n");
  fprintf(out, "#   are created from the libfltk*.a files. They are built\n");
  fprintf(out, "#   into the src dir.\n");
  fprintf(out, "# - The _images, _gl and dlls must be linked\n");
  fprintf(out, "#   against the import libraries in the src dir.\n");
  fprintf(out, "#-----------------------------------------------------------------\n");
  fprintf(out, "\n");
  fprintf(out, "#-----------------------------------------------------------------\n");
  fprintf(out, "# cygwin GDI shared libraries\n");
  fprintf(out, "#-----------------------------------------------------------------\n");
  fprintf(out, "\n");
  fprintf(out, "cygfltknox-1.3.dll: $(LIBNAME)\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(LIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(LIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk.dll.a $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "cygfltknox_gl-1.3.dll: $(GLLIBNAME) cygfltknox-1.3.dll\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(GLLIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(GLLIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk_gl.dll.a \\\n");
  fprintf(out, "\t\t-L. -lfltk $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "cygfltknox_images-1.3.dll: $(IMGLIBNAME) cygfltknox-1.3.dll\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(IMGLIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(IMGLIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk_images.dll.a \\\n");
  fprintf(out, "\t\t-L. -lfltk -Wl,--exclude-libs -Wl,libfltk_png.a \\\n");
  fprintf(out, "\t\t\t$(IMAGELIBS) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "#-----------------------------------------------------------------\n");
  fprintf(out, "# cygwin X11 shared libraries\n");
  fprintf(out, "#-----------------------------------------------------------------\n");
  fprintf(out, "\n");
  fprintf(out, "cygfltk-1.3.dll: $(LIBNAME)\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(LIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(LIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk.dll.a $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "cygfltk_gl-1.3.dll: $(GLLIBNAME) cygfltk-1.3.dll\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(GLLIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(GLLIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk_gl.dll.a \\\n");
  fprintf(out, "\t\t-L. -lfltk $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "cygfltk_images-1.3.dll: $(IMGLIBNAME) cygfltk-1.3.dll\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(IMGLIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(IMGLIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk_images.dll.a \\\n");
  fprintf(out, "\t\t-L. -lfltk -Wl,--exclude-libs -Wl,libfltk_png.a \\\n");
  fprintf(out, "\t\t\t$(IMAGELIBS) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "mgwfltknox-1.3.dll: $(LIBNAME)\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(LIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(LIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk.dll.a $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "mgwfltknox_gl-1.3.dll: $(GLLIBNAME) mgwfltknox-1.3.dll\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(GLLIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(GLLIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk_gl.dll.a \\\n");
  fprintf(out, "\t\t-L. -lfltk $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "#-----------------------------------------------------\n");
  fprintf(out, "# See STR #1585 for --exclude-libs\n");
  fprintf(out, "#-----------------------------------------------------\n");
  fprintf(out, "\n");
  fprintf(out, "mgwfltknox_images-1.3.dll: $(IMGLIBNAME) mgwfltknox-1.3.dll\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(IMGLIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(IMGLIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk_images.dll.a \\\n");
  fprintf(out, "\t\t-L. -lfltk -Wl,--exclude-libs -Wl,libfltk_png.a \\\n");
  fprintf(out, "\t\t\t$(IMAGELIBS) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "clean:\n");
  fprintf(out, "\t-$(RM) *.o xutf8/*.o *.dll.a core.* *~ *.bak *.bck\n");
  fprintf(out, "\t-$(RM) $(DSONAME) $(FLDSONAME) $(GLDSONAME) $(IMGDSONAME) \\\n");
  fprintf(out, "\t\t$(LIBNAME) $(FLLIBNAME) $(GLLIBNAME) \\\n");
  fprintf(out, "\t\t$(IMGLIBNAME) \\\n");
  fprintf(out, "\t\tlibfltk.so libfltk_gl.so libfltk_images.so \\\n");
  fprintf(out, "\t\tlibfltk.sl libfltk_gl.sl libfltk_images.sl \\\n");
  fprintf(out, "\t\tlibfltk.dylib \\\n");
  fprintf(out, "\t\tlibfltk_gl.dylib libfltk_images.dylib \\\n");
  fprintf(out, "\t\tcmap core\n");
  fprintf(out, "\n");
  fprintf(out, "depend:\t$(CPPFILES) $(MMFILES) $(FLCPPFILES) $(GLCPPFILES) $(IMGCPPFILES) $(CFILES)\n");
  fprintf(out, "\tmakedepend -Y -I.. -f makedepend $(CPPFILES) $(MMFILES) $(FLCPPFILES) \\\n");
  fprintf(out, "\t\t$(GLCPPFILES) $(IMGCPPFILES) $(CFILES)\n");
  fprintf(out, "\n");
  fprintf(out, "# Automatically generated dependencies... generated on a Linux/Unix host !\n");
  fprintf(out, "include makedepend\n");
  fprintf(out, "\n");
  fprintf(out, "# These dependencies aren't part of the makedepend file since\n");
  fprintf(out, "# they are part of the WIN32 and MacOS code base...\n");
  fprintf(out, "# Please add only non-Linux/Unix files or such that are optional\n");
  fprintf(out, "# (like \"*xft*\") here:\n");
  fprintf(out, "Fl_get_key.o:\tFl_get_key_mac.cxx Fl_get_key_win32.cxx\n");
  fprintf(out, "Fl_Native_File_Chooser.o : Fl_Native_File_Chooser_WIN32.cxx\n");
  fprintf(out, "Fl_Native_File_Chooser_MAC.o:\tFl_Native_File_Chooser_MAC.mm\n");
  fprintf(out, "Fl.o:\t\tFl_win32.cxx\n");
  fprintf(out, "Fl_cocoa.o:\tFl_cocoa.mm\n");
  fprintf(out, "fl_color.o:\tfl_color_mac.cxx fl_color_win32.cxx\n");
  fprintf(out, "fl_dnd.o:\tfl_dnd_win32.cxx fl_dnd_x.cxx\n");
  fprintf(out, "fl_draw_image.o: fl_draw_image_mac.cxx fl_draw_image_win32.cxx\n");
  fprintf(out, "fl_font.o:\tfl_font_mac.cxx fl_font_x.cxx fl_font_xft.cxx fl_font_win32.cxx\n");
  fprintf(out, "fl_read_image.o: fl_read_image_mac.cxx fl_read_image_win32.cxx\n");
  fprintf(out, "fl_set_fonts.o:\tfl_set_fonts_mac.cxx fl_set_fonts_x.cxx \\\n");
  fprintf(out, "\t\tfl_set_fonts_xft.cxx fl_set_fonts_win32.cxx\n");
  fprintf(out, "Fl_Printer.o: Fl_GDI_Printer.cxx Fl_PostScript.cxx\n");
  fprintf(out, "Fl_Quartz_Printer.o:\tFl_Quartz_Printer.mm\n");
  fprintf(out, "fl_arci.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_arg.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_ask.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Bitmap.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_color.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_cursor.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_dnd.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Double_Window.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_draw_image.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_draw_image_mac.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_draw_image_win32.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_draw_pixmap.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_encoding_latin1.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_encoding_mac_roman.o:   ../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_File_Chooser2.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_font.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_get_key.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_get_system_colors.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Gl_Choice.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Gl_Overlay.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Gl_Window.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_grab.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Image.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_line_style.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Menu_Window.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_overlay.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_overlay_visual.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Overlay_Window.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_own_colormap.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Pixmap.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Printer.o:  ../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_read_image.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_read_image_mac.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_read_image_win32.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_rect.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_scroll_area.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_set_font.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_set_fonts.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_shortcut.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_vertex.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_visual.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Window_fullscreen.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Window_iconize.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_x.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "gl_draw.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "gl_start.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "\n");
  fprintf(out, "################################################################\n");
  fprintf(out, "\n");
  fprintf(out, "install: $(LIBNAME) $(DSONAME) \\\n");
  fprintf(out, "\t$(FLLIBNAME) $(FLDSONAME) \\\n");
  fprintf(out, "\t$(GLLIBNAME) $(GLDSONAME) \\\n");
  fprintf(out, "\t$(IMGLIBNAME) $(IMGDSONAME) \n");
  fprintf(out, "\techo \"Installing libraries in $(DESTDIR)$(libdir)...\"\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)$(libdir)\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)$(bindir)\n");
  fprintf(out, "\t$(RM) $(DESTDIR)$(libdir)/$(LIBBASENAME)\n");
  fprintf(out, "\t$(INSTALL_LIB) $(LIBNAME) $(DESTDIR)$(libdir)\n");
  fprintf(out, "\t$(INSTALL_LIB) $(FLLIBNAME) $(DESTDIR)$(libdir)\n");
  fprintf(out, "\t$(INSTALL_LIB) $(IMGLIBNAME) $(DESTDIR)$(libdir)\n");
  fprintf(out, "\t$(RANLIB) $(DESTDIR)$(libdir)/$(LIBBASENAME)\n");
  fprintf(out, "\t$(RANLIB) $(DESTDIR)$(libdir)/$(FLLIBBASENAME)\n");
  fprintf(out, "\tif test x$(GLLIBNAME) != x; then \\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) $(GLLIBNAME) $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(RANLIB) $(DESTDIR)$(libdir)/$(GLLIBBASENAME); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\t$(RANLIB) $(DESTDIR)$(libdir)/$(IMGLIBBASENAME)\n");
  fprintf(out, "\tif test x$(DSONAME) = xlibfltk.so.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.so*;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk.so.1.3 $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk.so.1.3 $(DESTDIR)$(libdir)/libfltk.so;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(DSONAME) = xlibfltk.sl.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.sl*;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk.sl.1.3 $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk.sl.1.3 $(DESTDIR)$(libdir)/libfltk.sl;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(DSONAME) = xlibfltk.1.3.dylib; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.*dylib;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk.1.3.dylib $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk.1.3.dylib $(DESTDIR)$(libdir)/libfltk.dylib;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(DSONAME) = xlibfltk_s.a; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_s.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_s.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(DSONAME) = xcygfltknox-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(DSONAME);\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) $(DSONAME) $(DESTDIR)$(bindir); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.dll.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk.dll.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(DSONAME) = xmgwfltknox-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(DSONAME);\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) $(DSONAME) $(DESTDIR)$(bindir); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.dll.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk.dll.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(GLDSONAME) = xlibfltk_gl.so.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.so*;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_gl.so.1.3 $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk_gl.so.1.3 $(DESTDIR)$(libdir)/libfltk_gl.so;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(GLDSONAME) = xlibfltk_gl.sl.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.sl*;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_gl.sl.1.3 $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk_gl.sl.1.3 $(DESTDIR)$(libdir)/libfltk_gl.sl;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(GLDSONAME) = xlibfltk_gl.1.3.dylib; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.*dylib;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_gl.1.3.dylib $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk_gl.1.3.dylib $(DESTDIR)$(libdir)/libfltk_gl.dylib;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(GLDSONAME) = xlibfltk_gl_s.a; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl_s.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_gl_s.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(GLDSONAME) = xcygfltknox_gl-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(GLDSONAME);\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) $(GLDSONAME) $(DESTDIR)$(bindir); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.dll.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_gl.dll.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(GLDSONAME) = xmgwfltknox_gl-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(GLDSONAME);\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) $(GLDSONAME) $(DESTDIR)$(bindir); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.dll.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_gl.dll.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(IMGDSONAME) = xlibfltk_images.so.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.so*;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_images.so.1.3 $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk_images.so.1.3 $(DESTDIR)$(libdir)/libfltk_images.so;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(IMGDSONAME) = xlibfltk_images.sl.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.sl*;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_images.sl.1.3 $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk_images.sl.1.3 $(DESTDIR)$(libdir)/libfltk_images.sl;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(IMGDSONAME) = xlibfltk_images.1.3.dylib; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.*dylib;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_images.1.3.dylib $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk_images.1.3.dylib $(DESTDIR)$(libdir)/libfltk_images.dylib;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(IMGDSONAME) = xlibfltk_images_s.a; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images_s.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_images_s.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(IMGDSONAME) = xcygfltknox_images-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(IMGDSONAME); \\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) $(IMGDSONAME) $(DESTDIR)$(bindir); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.dll.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_images.dll.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(IMGDSONAME) = xmgwfltknox_images-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(IMGDSONAME); \\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) $(IMGDSONAME) $(DESTDIR)$(bindir); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.dll.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_images.dll.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "\n");
  fprintf(out, "uninstall:\n");
  fprintf(out, "\techo \"Uninstalling libraries...\"\n");
  fprintf(out, "\t$(RM) $(DESTDIR)$(libdir)/$(LIBBASENAME)\n");
  fprintf(out, "\tif test x$(DSONAME) = xlibfltk.so.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.so*;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(DSONAME) = xlibfltk.sl.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.sl*;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(DSONAME) = xlibfltk.1.3.dylib; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.*dylib;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(DSONAME) = xlibfltk_s.a; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_s.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(DSONAME) = xcygfltknox-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(DSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(DSONAME) = xcygfltk-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(DSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(DSONAME) = xmgwfltknox-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(DSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\t$(RM) $(DESTDIR)$(libdir)/$(FLLIBBASENAME);\n");
  fprintf(out, "\tif test x$(GLLIBNAME) != x; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/$(GLLIBBASENAME);\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(GLDSONAME) = xlibfltk_gl.so.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.so*;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(GLDSONAME) = xlibfltk_gl.sl.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.sl*;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(GLDSONAME) = xlibfltk_gl.1.3.dylib; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.*dylib;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(GLDSONAME) = xlibfltk_gl_s.a; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl_s.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(GLDSONAME) = xcygfltknox_gl-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(GLDSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(GLDSONAME) = xcygfltk_gl-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(GLDSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(GLDSONAME) = xmgwfltknox_gl-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(GLDSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(IMGLIBNAME) != x; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/$(IMGLIBBASENAME);\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(IMGDSONAME) = xlibfltk_images.so.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.so*;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(IMGDSONAME) = xlibfltk_images.sl.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.sl*;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(IMGDSONAME) = xlibfltk_images.1.3.dylib; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.*dylib;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(IMGDSONAME) = xlibfltk_images_s.a; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images_s.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(IMGDSONAME) = xcygfltknox_images-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(IMGDSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(IMGDSONAME) = xcygfltk_images-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(IMGDSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(IMGDSONAME) = xmgwfltknox_images-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(IMGDSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "#\n");
  fprintf(out, "# End of \"$Id: Makefile 8899 2011-08-02 10:05:56Z matt $\".\n");
  fprintf(out, "#\n");
  fprintf(out, "# DO NOT DELETE\n");
  return 0;
}

static int write_test_makefile(FILE *out, Fl_Workspace_Type *workspace, const char *path, const char *base_dir, const char *tgt_base, Fl_Target_Type *first_target) {
  fprintf(out, "#\n");
  fprintf(out, "# \"$Id: Makefile 8740 2011-05-26 14:43:46Z matt $\"\n");
  fprintf(out, "#\n");
  fprintf(out, "# Test/example program makefile for the Fast Light Tool Kit (FLTK).\n");
  fprintf(out, "#\n");
  fprintf(out, "# Copyright 1998-2010 by Bill Spitzak and others.\n");
  fprintf(out, "#\n");
  fprintf(out, "# This library is free software; you can redistribute it and/or\n");
  fprintf(out, "# modify it under the terms of the GNU Library General Public\n");
  fprintf(out, "# License as published by the Free Software Foundation; either\n");
  fprintf(out, "# version 2 of the License, or (at your option) any later version.\n");
  fprintf(out, "#\n");
  fprintf(out, "# This library is distributed in the hope that it will be useful,\n");
  fprintf(out, "# but WITHOUT ANY WARRANTY; without even the implied warranty of\n");
  fprintf(out, "# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n");
  fprintf(out, "# Library General Public License for more details.\n");
  fprintf(out, "#\n");
  fprintf(out, "# You should have received a copy of the GNU Library General Public\n");
  fprintf(out, "# License along with this library; if not, write to the Free Software\n");
  fprintf(out, "# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307\n");
  fprintf(out, "# USA.\n");
  fprintf(out, "#\n");
  fprintf(out, "# Please report all bugs and problems on the following page:\n");
  fprintf(out, "#\n");
  fprintf(out, "#      http://www.fltk.org/str.php\n");
  fprintf(out, "#\n");
  fprintf(out, "\n");
  fprintf(out, "include ../makeinclude\n");
  fprintf(out, "\n");
  fprintf(out, "CPPFILES =\\\n");
  fprintf(out, "\tunittests.cxx \\\n");
  fprintf(out, "\tadjuster.cxx \\\n");
  fprintf(out, "\tarc.cxx \\\n");
  fprintf(out, "\task.cxx \\\n");
  fprintf(out, "\tbitmap.cxx \\\n");
  fprintf(out, "\tblocks.cxx \\\n");
  fprintf(out, "\tboxtype.cxx \\\n");
  fprintf(out, "\tbrowser.cxx \\\n");
  fprintf(out, "\tbutton.cxx \\\n");
  fprintf(out, "\tbuttons.cxx \\\n");
  fprintf(out, "\tcairo_test.cxx \\\n");
  fprintf(out, "\tcheckers.cxx \\\n");
  fprintf(out, "\tclock.cxx \\\n");
  fprintf(out, "\tcolbrowser.cxx \\\n");
  fprintf(out, "\tcolor_chooser.cxx \\\n");
  fprintf(out, "\tcube.cxx \\\n");
  fprintf(out, "\tCubeMain.cxx \\\n");
  fprintf(out, "\tCubeView.cxx \\\n");
  fprintf(out, "\tcursor.cxx \\\n");
  fprintf(out, "\tcurve.cxx \\\n");
  fprintf(out, "\tdemo.cxx \\\n");
  fprintf(out, "\tdevice.cxx \\\n");
  fprintf(out, "\tdoublebuffer.cxx \\\n");
  fprintf(out, "\teditor.cxx \\\n");
  fprintf(out, "\tfast_slow.cxx \\\n");
  fprintf(out, "\tfile_chooser.cxx \\\n");
  fprintf(out, "\tfonts.cxx \\\n");
  fprintf(out, "\tfractals.cxx \\\n");
  fprintf(out, "\tfullscreen.cxx \\\n");
  fprintf(out, "\tgl_overlay.cxx \\\n");
  fprintf(out, "\tglpuzzle.cxx \\\n");
  fprintf(out, "\thello.cxx \\\n");
  fprintf(out, "\thelp.cxx \\\n");
  fprintf(out, "\ticonize.cxx \\\n");
  fprintf(out, "\timage.cxx \\\n");
  fprintf(out, "\tinactive.cxx \\\n");
  fprintf(out, "\tinput.cxx \\\n");
  fprintf(out, "\tinput_choice.cxx \\\n");
  fprintf(out, "\tkeyboard.cxx \\\n");
  fprintf(out, "\tlabel.cxx \\\n");
  fprintf(out, "\tline_style.cxx \\\n");
  fprintf(out, "\tlist_visuals.cxx \\\n");
  fprintf(out, "\tmandelbrot.cxx \\\n");
  fprintf(out, "\tmenubar.cxx \\\n");
  fprintf(out, "\tmessage.cxx \\\n");
  fprintf(out, "\tminimum.cxx \\\n");
  fprintf(out, "\tnative-filechooser.cxx \\\n");
  fprintf(out, "\tnavigation.cxx \\\n");
  fprintf(out, "\toutput.cxx \\\n");
  fprintf(out, "\toverlay.cxx \\\n");
  fprintf(out, "\tpack.cxx \\\n");
  fprintf(out, "\tpixmap_browser.cxx \\\n");
  fprintf(out, "\tpixmap.cxx \\\n");
  fprintf(out, "\tpreferences.cxx \\\n");
  fprintf(out, "\tdevice.cxx \\\n");
  fprintf(out, "\tradio.cxx \\\n");
  fprintf(out, "\tresizebox.cxx \\\n");
  fprintf(out, "\tresize.cxx \\\n");
  fprintf(out, "\trotated_text.cxx \\\n");
  fprintf(out, "\tscroll.cxx \\\n");
  fprintf(out, "\tshape.cxx \\\n");
  fprintf(out, "\tsubwindow.cxx \\\n");
  fprintf(out, "\tsudoku.cxx \\\n");
  fprintf(out, "\tsymbols.cxx \\\n");
  fprintf(out, "\ttable.cxx \\\n");
  fprintf(out, "\ttabs.cxx \\\n");
  fprintf(out, "\tthreads.cxx \\\n");
  fprintf(out, "\ttile.cxx \\\n");
  fprintf(out, "\ttiled_image.cxx \\\n");
  fprintf(out, "\ttree.cxx \\\n");
  fprintf(out, "\tvaluators.cxx \\\n");
  fprintf(out, "\tutf8.cxx\n");
  fprintf(out, "\n");
  fprintf(out, "ALL =\t\\\n");
  fprintf(out, "\tunittests$(EXEEXT) \\\n");
  fprintf(out, "\tadjuster$(EXEEXT) \\\n");
  fprintf(out, "\tarc$(EXEEXT) \\\n");
  fprintf(out, "\task$(EXEEXT) \\\n");
  fprintf(out, "\tbitmap$(EXEEXT) \\\n");
  fprintf(out, "\tblocks$(EXEEXT) \\\n");
  fprintf(out, "\tboxtype$(EXEEXT) \\\n");
  fprintf(out, "\tbrowser$(EXEEXT) \\\n");
  fprintf(out, "\tbutton$(EXEEXT) \\\n");
  fprintf(out, "\tbuttons$(EXEEXT) \\\n");
  fprintf(out, "\tcairo_test$(EXEEXT) \\\n");
  fprintf(out, "\tcheckers$(EXEEXT) \\\n");
  fprintf(out, "\tclock$(EXEEXT) \\\n");
  fprintf(out, "\tcolbrowser$(EXEEXT) \\\n");
  fprintf(out, "\tcolor_chooser$(EXEEXT) \\\n");
  fprintf(out, "\tcursor$(EXEEXT) \\\n");
  fprintf(out, "\tcurve$(EXEEXT) \\\n");
  fprintf(out, "\tdemo$(EXEEXT) \\\n");
  fprintf(out, "\tdevice$(EXEEXT) \\\n");
  fprintf(out, "\tdoublebuffer$(EXEEXT) \\\n");
  fprintf(out, "\teditor$(EXEEXT) \\\n");
  fprintf(out, "\tfast_slow$(EXEEXT) \\\n");
  fprintf(out, "\tfile_chooser$(EXEEXT) \\\n");
  fprintf(out, "\tfonts$(EXEEXT) \\\n");
  fprintf(out, "\thello$(EXEEXT) \\\n");
  fprintf(out, "\thelp$(EXEEXT) \\\n");
  fprintf(out, "\ticonize$(EXEEXT) \\\n");
  fprintf(out, "\timage$(EXEEXT) \\\n");
  fprintf(out, "\tinactive$(EXEEXT) \\\n");
  fprintf(out, "\tinput$(EXEEXT) \\\n");
  fprintf(out, "\tinput_choice$(EXEEXT) \\\n");
  fprintf(out, "\tkeyboard$(EXEEXT) \\\n");
  fprintf(out, "\tlabel$(EXEEXT) \\\n");
  fprintf(out, "\tline_style$(EXEEXT) \\\n");
  fprintf(out, "\tlist_visuals$(EXEEXT) \\\n");
  fprintf(out, "\tmandelbrot$(EXEEXT) \\\n");
  fprintf(out, "\tmenubar$(EXEEXT) \\\n");
  fprintf(out, "\tmessage$(EXEEXT) \\\n");
  fprintf(out, "\tminimum$(EXEEXT) \\\n");
  fprintf(out, "\tnative-filechooser$(EXEEXT) \\\n");
  fprintf(out, "\tnavigation$(EXEEXT) \\\n");
  fprintf(out, "\toutput$(EXEEXT) \\\n");
  fprintf(out, "\toverlay$(EXEEXT) \\\n");
  fprintf(out, "\tpack$(EXEEXT) \\\n");
  fprintf(out, "\tpixmap$(EXEEXT) \\\n");
  fprintf(out, "\tpixmap_browser$(EXEEXT) \\\n");
  fprintf(out, "\tpreferences$(EXEEXT) \\\n");
  fprintf(out, "\tdevice$(EXEEXT) \\\n");
  fprintf(out, "\tradio$(EXEEXT) \\\n");
  fprintf(out, "\tresize$(EXEEXT) \\\n");
  fprintf(out, "\tresizebox$(EXEEXT) \\\n");
  fprintf(out, "\trotated_text$(EXEEXT) \\\n");
  fprintf(out, "\tscroll$(EXEEXT) \\\n");
  fprintf(out, "\tsubwindow$(EXEEXT) \\\n");
  fprintf(out, "\tsudoku$(EXEEXT) \\\n");
  fprintf(out, "\tsymbols$(EXEEXT) \\\n");
  fprintf(out, "\ttable$(EXEEXT) \\\n");
  fprintf(out, "\ttabs$(EXEEXT) \\\n");
  fprintf(out, "\t$(THREADS) \\\n");
  fprintf(out, "\ttile$(EXEEXT) \\\n");
  fprintf(out, "\ttiled_image$(EXEEXT) \\\n");
  fprintf(out, "\ttree$(EXEEXT) \\\n");
  fprintf(out, "\tvaluators$(EXEEXT) \\\n");
  fprintf(out, "\tcairotest$(EXEEXT) \\\n");
  fprintf(out, "\tutf8$(EXEEXT) \n");
  fprintf(out, "\n");
  fprintf(out, "\n");
  fprintf(out, "GLALL = \\\n");
  fprintf(out, "\tcube$(EXEEXT) \\\n");
  fprintf(out, "\tCubeView$(EXEEXT) \\\n");
  fprintf(out, "\tfractals$(EXEEXT) \\\n");
  fprintf(out, "\tfullscreen$(EXEEXT) \\\n");
  fprintf(out, "\tgl_overlay$(EXEEXT) \\\n");
  fprintf(out, "\tglpuzzle$(EXEEXT) \\\n");
  fprintf(out, "\tshape$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "all:\t$(ALL) $(GLDEMOS)\n");
  fprintf(out, "\n");
  fprintf(out, "gldemos:\t$(GLALL)\n");
  fprintf(out, "\n");
  fprintf(out, "depend:\t$(CPPFILES)\n");
  fprintf(out, "\tmakedepend -Y -I.. -f makedepend $(CPPFILES)\n");
  fprintf(out, "\n");
  fprintf(out, "# Automatically generated dependencies...\n");
  fprintf(out, "include makedepend\n");
  fprintf(out, "\n");
  fprintf(out, "clean:\n");
  fprintf(out, "\t$(RM) $(ALL) $(GLALL) core\n");
  fprintf(out, "\t$(RM) *.o core.* *~ *.bck *.bak\n");
  fprintf(out, "\t$(RM) CubeViewUI.cxx CubeViewUI.h\n");
  fprintf(out, "\t$(RM) fast_slow.cxx fast_slow.h\n");
  fprintf(out, "\t$(RM) inactive.cxx inactive.h\n");
  fprintf(out, "\t$(RM) keyboard_ui.cxx keyboard_ui.h\n");
  fprintf(out, "\t$(RM) mandelbrot_ui.cxx mandelbrot_ui.h\n");
  fprintf(out, "\t$(RM) preferences.cxx preferences.h\n");
  fprintf(out, "\t$(RM) radio.cxx radio.h\n");
  fprintf(out, "\t$(RM) resize.cxx resize.h\n");
  fprintf(out, "\t$(RM) tabs.cxx tabs.h\n");
  fprintf(out, "\t$(RM) tree.cxx tree.h\n");
  fprintf(out, "\t$(RM) valuators.cxx valuators.h\n");
  fprintf(out, "\t$(OSX_ONLY) $(RM) blocks.app/Contents/MacOS/blocks$(EXEEXT)\n");
  fprintf(out, "\t$(OSX_ONLY) $(RM) checkers.app/Contents/MacOS/checkers$(EXEEXT)\n");
  fprintf(out, "\t$(OSX_ONLY) $(RM) sudoku.app/Contents/MacOS/sudoku$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "install:\tall\n");
  fprintf(out, "\techo \"Installing example programs to $(DESTDIR)$(docdir)/examples...\"\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)$(docdir)/examples\n");
  fprintf(out, "\tfor file in *.h *.cxx *.fl demo.menu; do \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) $$file $(DESTDIR)$(docdir)/examples; \\\n");
  fprintf(out, "\tdone\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)$(docdir)/examples/pixmaps\n");
  fprintf(out, "\tfor file in pixmaps/*.xbm pixmaps/*.xpm; do \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) $$file $(DESTDIR)$(docdir)/examples/pixmaps; \\\n");
  fprintf(out, "\tdone\n");
  fprintf(out, "\n");
  fprintf(out, "install-linux:\n");
  fprintf(out, "\techo Installing games to $(DESTDIR)$(bindir)...\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)$(bindir)\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/usr/share/applications\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/usr/share/icons/hicolor/32x32/apps\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/usr/share/icons/hicolor/128x128/apps\n");
  fprintf(out, "\tfor game in blocks checkers sudoku; do \\\n");
  fprintf(out, "\t\t$(INSTALL_BIN) $$game $(DESTDIR)$(bindir); \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) desktop/$$game.desktop  $(DESTDIR)/usr/share/applications; \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) desktop/$$game-32.png $(DESTDIR)/usr/share/icons/hicolor/32x32/apps/$$game.png; \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) desktop/$$game-128.png $(DESTDIR)/usr/share/icons/hicolor/128x128/apps/$$game.png; \\\n");
  fprintf(out, "\tdone\n");
  fprintf(out, "\n");
  fprintf(out, "install-osx:\n");
  fprintf(out, "\techo Installing games in $(DESTDIR)/Applications...\n");
  fprintf(out, "\tfor game in blocks checkers sudoku; do \\\n");
  fprintf(out, "\t\tif test ! -d $(DESTDIR)/Applications/$$game.app; then \\\n");
  fprintf(out, "\t\t\t$(INSTALL_DIR) $(DESTDIR)/Applications/$$game.app; \\\n");
  fprintf(out, "\t\t\t$(INSTALL_DIR) $(DESTDIR)/Applications/$$game.app/Contents; \\\n");
  fprintf(out, "\t\t\t$(INSTALL_DIR) $(DESTDIR)/Applications/$$game.app/Contents/MacOS; \\\n");
  fprintf(out, "\t\t\t$(INSTALL_DIR) $(DESTDIR)/Applications/$$game.app/Contents/Resources; \\\n");
  fprintf(out, "\t\tfi; \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) $$game.app/Contents/Info.plist $(DESTDIR)/Applications/$$game.app/Contents; \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) $$game.app/Contents/PkgInfo $(DESTDIR)/Applications/$$game.app/Contents; \\\n");
  fprintf(out, "\t\t$(INSTALL_BIN) $$game.app/Contents/MacOS/$$game $(DESTDIR)/Applications/$$game.app/Contents/MacOS; \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) $$game.app/Contents/Resources/$$game.icns $(DESTDIR)/Applications/$$game.app/Contents/Resources; \\\n");
  fprintf(out, "\tdone\n");
  fprintf(out, "\n");
  fprintf(out, "uninstall:\n");
  fprintf(out, "\techo \"Removing examples programs from $(DESTDIR)$(docdir)/examples...\"\n");
  fprintf(out, "\t-$(RMDIR) $(DESTDIR)$(docdir)/examples\n");
  fprintf(out, "\n");
  fprintf(out, "uninstall-linux:\n");
  fprintf(out, "\techo Removing games from $(DESTDIR)$(bindir)...\n");
  fprintf(out, "\tfor game in blocks checkers sudoku; do \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$$game; \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)/usr/share/applications/$$game.desktop; \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)/usr/share/icons/hicolor/32x32/apps/$$game.png; \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)/usr/share/icons/hicolor/128x128/apps/$$game.png; \\\n");
  fprintf(out, "\tdone\n");
  fprintf(out, "\n");
  fprintf(out, "uninstall-osx:\n");
  fprintf(out, "\techo Removing games from $(DESTDIR)/Applications...\n");
  fprintf(out, "\t$(RMDIR) $(DESTDIR)/Applications/blocks.app\n");
  fprintf(out, "\t$(RMDIR) $(DESTDIR)/Applications/checkers.app\n");
  fprintf(out, "\t$(RMDIR) $(DESTDIR)/Applications/sudoku.app\n");
  fprintf(out, "\n");
  fprintf(out, "# FLUID file rules\n");
  fprintf(out, ".fl.cxx .fl.h:\t../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\techo Generating $@ and header from $<...\n");
  fprintf(out, "\t../fluid/fluid$(EXEEXT) -c $<\n");
  fprintf(out, "\n");
  fprintf(out, "# All demos depend on the FLTK library...\n");
  fprintf(out, "$(ALL): $(LIBNAME)\n");
  fprintf(out, "\n");
  fprintf(out, "# General demos...\n");
  fprintf(out, "unittests$(EXEEXT): unittests.o\n");
  fprintf(out, "\n");
  fprintf(out, "unittests.cxx: unittest_about.cxx unittest_points.cxx unittest_lines.cxx unittest_circles.cxx \\\n");
  fprintf(out, "\tunittest_rects.cxx unittest_text.cxx unittest_viewport.cxx unittest_images.cxx\n");
  fprintf(out, "\n");
  fprintf(out, "adjuster$(EXEEXT): adjuster.o\n");
  fprintf(out, "\n");
  fprintf(out, "arc$(EXEEXT): arc.o\n");
  fprintf(out, "\n");
  fprintf(out, "ask$(EXEEXT): ask.o\n");
  fprintf(out, "\n");
  fprintf(out, "bitmap$(EXEEXT): bitmap.o\n");
  fprintf(out, "\n");
  fprintf(out, "boxtype$(EXEEXT): boxtype.o\n");
  fprintf(out, "\n");
  fprintf(out, "browser$(EXEEXT): browser.o\n");
  fprintf(out, "\n");
  fprintf(out, "button$(EXEEXT): button.o\n");
  fprintf(out, "\n");
  fprintf(out, "buttons$(EXEEXT): buttons.o\n");
  fprintf(out, "\n");
  fprintf(out, "blocks$(EXEEXT): blocks.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) blocks.o -o $@ $(AUDIOLIBS) $(LINKFLTK) $(LDLIBS)\n");
  fprintf(out, "\t$(OSX_ONLY) $(INSTALL_BIN) blocks$(EXEEXT) blocks.app/Contents/MacOS\n");
  fprintf(out, "\n");
  fprintf(out, "checkers$(EXEEXT): checkers.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) checkers.o -o $@ $(LINKFLTK) $(LDLIBS)\n");
  fprintf(out, "\t$(OSX_ONLY) $(INSTALL_BIN) checkers$(EXEEXT) checkers.app/Contents/MacOS\n");
  fprintf(out, "\n");
  fprintf(out, "clock$(EXEEXT): clock.o\n");
  fprintf(out, "\n");
  fprintf(out, "colbrowser$(EXEEXT): colbrowser.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ colbrowser.o $(LINKFLTK) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "color_chooser$(EXEEXT): color_chooser.o\n");
  fprintf(out, "\n");
  fprintf(out, "cursor$(EXEEXT): cursor.o\n");
  fprintf(out, "\n");
  fprintf(out, "curve$(EXEEXT): curve.o\n");
  fprintf(out, "\n");
  fprintf(out, "demo$(EXEEXT): demo.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ demo.o $(LINKFLTK) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "device$(EXEEXT): device.o $(IMGLIBNAME)\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) device.o -o $@ $(LINKFLTKIMG) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "doublebuffer$(EXEEXT): doublebuffer.o\n");
  fprintf(out, "\n");
  fprintf(out, "editor$(EXEEXT): editor.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) editor.o -o $@ $(LINKFLTKIMG) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "fast_slow$(EXEEXT): fast_slow.o\n");
  fprintf(out, "fast_slow.cxx:\tfast_slow.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "file_chooser$(EXEEXT): file_chooser.o $(IMGLIBNAME)\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) file_chooser.o -o $@ $(LINKFLTKIMG) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "fonts$(EXEEXT): fonts.o\n");
  fprintf(out, "\n");
  fprintf(out, "hello$(EXEEXT): hello.o\n");
  fprintf(out, "\n");
  fprintf(out, "help$(EXEEXT): help.o $(IMGLIBNAME)\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) help.o -o $@ $(LINKFLTKIMG) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "iconize$(EXEEXT): iconize.o\n");
  fprintf(out, "\n");
  fprintf(out, "image$(EXEEXT): image.o\n");
  fprintf(out, "\n");
  fprintf(out, "inactive$(EXEEXT): inactive.o\n");
  fprintf(out, "inactive.cxx:\tinactive.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "input$(EXEEXT): input.o\n");
  fprintf(out, "\n");
  fprintf(out, "input_choice$(EXEEXT): input_choice.o\n");
  fprintf(out, "\n");
  fprintf(out, "keyboard$(EXEEXT): keyboard_ui.o keyboard.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ keyboard.o keyboard_ui.o $(LINKFLTK) $(LDLIBS)\n");
  fprintf(out, "keyboard_ui.o:\tkeyboard_ui.h\n");
  fprintf(out, "keyboard_ui.cxx:\tkeyboard_ui.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "label$(EXEEXT): label.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ label.o $(LINKFLTK) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "line_style$(EXEEXT): line_style.o\n");
  fprintf(out, "\n");
  fprintf(out, "list_visuals$(EXEEXT): list_visuals.o\n");
  fprintf(out, "\n");
  fprintf(out, "mandelbrot$(EXEEXT): mandelbrot_ui.o mandelbrot.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ mandelbrot.o mandelbrot_ui.o $(LINKFLTK) $(LDLIBS)\n");
  fprintf(out, "mandelbrot_ui.o:\tmandelbrot_ui.h\n");
  fprintf(out, "mandelbrot_ui.cxx:\tmandelbrot_ui.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "menubar$(EXEEXT): menubar.o\n");
  fprintf(out, "\n");
  fprintf(out, "message$(EXEEXT): message.o\n");
  fprintf(out, "\n");
  fprintf(out, "minimum$(EXEEXT): minimum.o\n");
  fprintf(out, "\n");
  fprintf(out, "native-filechooser$(EXEEXT): native-filechooser.o $(IMGLIBNAME)\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) native-filechooser.o -o $@ $(LINKFLTKIMG) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "navigation$(EXEEXT): navigation.o\n");
  fprintf(out, "\n");
  fprintf(out, "output$(EXEEXT): output.o $(FLLIBNAME)\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ output.o $(LINKFLTK) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "overlay$(EXEEXT): overlay.o\n");
  fprintf(out, "\n");
  fprintf(out, "pack$(EXEEXT): pack.o\n");
  fprintf(out, "\n");
  fprintf(out, "pixmap$(EXEEXT): pixmap.o\n");
  fprintf(out, "\n");
  fprintf(out, "pixmap_browser$(EXEEXT): pixmap_browser.o $(IMGLIBNAME)\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) pixmap_browser.o -o $@ $(LINKFLTKIMG) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "preferences$(EXEEXT):\tpreferences.o\n");
  fprintf(out, "preferences.cxx:\tpreferences.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "device$(EXEEXT): device.o\n");
  fprintf(out, "\n");
  fprintf(out, "radio$(EXEEXT): radio.o\n");
  fprintf(out, "radio.cxx:\tradio.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "resize$(EXEEXT): resize.o\n");
  fprintf(out, "resize.cxx:\tresize.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "resizebox$(EXEEXT): resizebox.o\n");
  fprintf(out, "\n");
  fprintf(out, "rotated_text$(EXEEXT): rotated_text.o\n");
  fprintf(out, "\n");
  fprintf(out, "scroll$(EXEEXT): scroll.o\n");
  fprintf(out, "\n");
  fprintf(out, "subwindow$(EXEEXT): subwindow.o\n");
  fprintf(out, "\n");
  fprintf(out, "sudoku: sudoku.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) sudoku.o -o $@ $(AUDIOLIBS) $(LINKFLTKIMG) $(LDLIBS)\n");
  fprintf(out, "\t$(OSX_ONLY) $(INSTALL_BIN) sudoku$(EXEEXT) sudoku.app/Contents/MacOS\n");
  fprintf(out, "\n");
  fprintf(out, "sudoku.exe: sudoku.o sudoku.rc\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(RC) sudoku.rc sudokures.o\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) sudoku.o sudokures.o -o $@ $(AUDIOLIBS) $(LINKFLTKIMG) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "symbols$(EXEEXT): symbols.o\n");
  fprintf(out, "\n");
  fprintf(out, "table$(EXEEXT): table.o\n");
  fprintf(out, "\n");
  fprintf(out, "tabs$(EXEEXT): tabs.o\n");
  fprintf(out, "tabs.cxx:\ttabs.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "threads$(EXEEXT): threads.o\n");
  fprintf(out, "# This ensures that we have this dependency even if threads are not\n");
  fprintf(out, "# enabled in the current tree...\n");
  fprintf(out, "threads.o:\tthreads.h\n");
  fprintf(out, "\n");
  fprintf(out, "tile$(EXEEXT): tile.o\n");
  fprintf(out, "\n");
  fprintf(out, "tiled_image$(EXEEXT): tiled_image.o\n");
  fprintf(out, "\n");
  fprintf(out, "tree$(EXEEXT): tree.o\n");
  fprintf(out, "tree.cxx:\ttree.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "valuators$(EXEEXT): valuators.o\n");
  fprintf(out, "valuators.cxx:\tvaluators.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "# All OpenGL demos depend on the FLTK and FLTK_GL libraries...\n");
  fprintf(out, "$(GLALL): $(LIBNAME) $(GLLIBNAME)\n");
  fprintf(out, "\n");
  fprintf(out, "# OpenGL demos...\n");
  fprintf(out, "CubeView$(EXEEXT): CubeMain.o CubeView.o CubeViewUI.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ \\\n");
  fprintf(out, "\t\tCubeMain.o CubeView.o CubeViewUI.o \\\n");
  fprintf(out, "\t\t$(LINKFLTKGL) $(LINKFLTK) $(GLDLIBS)\n");
  fprintf(out, "CubeMain.o: CubeViewUI.h CubeView.h CubeViewUI.cxx\n");
  fprintf(out, "CubeView.o: CubeView.h\n");
  fprintf(out, "CubeViewUI.o:\tCubeViewUI.cxx CubeViewUI.h\n");
  fprintf(out, "CubeViewUI.cxx:\tCubeViewUI.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "cube$(EXEEXT): cube.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ cube.o $(LINKFLTKGL) $(LINKFLTK) $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "fractals$(EXEEXT): fractals.o fracviewer.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ fractals.o fracviewer.o $(LINKFLTKGL) $(LINKFLTK) $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "fullscreen$(EXEEXT): fullscreen.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ fullscreen.o $(LINKFLTKGL) $(LINKFLTK) $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "glpuzzle$(EXEEXT): glpuzzle.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ glpuzzle.o $(LINKFLTKGL) $(LINKFLTK) $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "gl_overlay$(EXEEXT): gl_overlay.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ gl_overlay.o $(LINKFLTKGL) $(LINKFLTK) $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "shape$(EXEEXT): shape.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ shape.o $(LINKFLTKGL) $(LINKFLTK) $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "cairo_test$(EXEEXT): cairo_test.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(CAIROFLAGS) $(LDFLAGS) -o $@ cairo_test.o $(LINKFLTK) $(LINKFLTKCAIRO) $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "#\n");
  fprintf(out, "# End of \"$Id: Makefile 8740 2011-05-26 14:43:46Z matt $\".\n");
  fprintf(out, "#\n");
  return 0;
}


// =============================================================================



#if 0
static int write_fluid_makefile(FILE *out, Fl_Workspace_Type *workspace, const char *path, const char *base_dir, const char *tgt_base, Fl_Target_Type *first_target) {
  
  fprintf(out, "#\n");
  fprintf(out, "# \"$Id: Makefile 8966 2011-08-15 14:23:40Z matt $\"\n");
  fprintf(out, "#\n");
  fprintf(out, "# FLUID makefile for the Fast Light Tool Kit (FLTK).\n");
  fprintf(out, "#\n");
  fprintf(out, "# Copyright 1998-2011 by Bill Spitzak and others.\n");
  fprintf(out, "#\n");
  fprintf(out, "# This library is free software; you can redistribute it and/or\n");
  fprintf(out, "# modify it under the terms of the GNU Library General Public\n");
  fprintf(out, "# License as published by the Free Software Foundation; either\n");
  fprintf(out, "# version 2 of the License, or (at your option) any later version.\n");
  fprintf(out, "#\n");
  fprintf(out, "# This library is distributed in the hope that it will be useful,\n");
  fprintf(out, "# but WITHOUT ANY WARRANTY; without even the implied warranty of\n");
  fprintf(out, "# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n");
  fprintf(out, "# Library General Public License for more details.\n");
  fprintf(out, "#\n");
  fprintf(out, "# You should have received a copy of the GNU Library General Public\n");
  fprintf(out, "# License along with this library; if not, write to the Free Software\n");
  fprintf(out, "# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307\n");
  fprintf(out, "# USA.\n");
  fprintf(out, "#\n");
  fprintf(out, "# Please report all bugs and problems on the following page:\n");
  fprintf(out, "#\n");
  fprintf(out, "#      http://www.fltk.org/str.php\n");
  fprintf(out, "#\n");
  
  Fl_Target_Type *tgt = first_target; // currently we support only a single target in this module
  
  fprintf(out, "\n");
  fprintf(out, "CPPFILES =");
  
  for (Fl_File_Type *file = Fl_File_Type::first_file(tgt); file; file = file->next_file(tgt)) {
    if (file->builds_in(FL_ENV_MAKE)) {
      if (file->file_is_fluid_ui() || file->file_is_code()) {
        fprintf(out, " \\\n\t");
        write_file(out, file, base_dir, tgt_base, ".cxx");
      }
    }
  }
  fprintf(out, "\n\n");
  
  fprintf(out, "################################################################\n");
  fprintf(out, "\n");
  fprintf(out, "OBJECTS = $(CPPFILES:.cxx=.o)\n");
  fprintf(out, "\n");
  fprintf(out, "include ../makeinclude\n");
  fprintf(out, "\n");
  
  fprintf(out, "all:\t$(%s) fluid$(EXEEXT)\n", tgt->caps_name()); // name() is mixed case :-(
  fprintf(out, "\n");
  
  fprintf(out, "fluid$(EXEEXT):\t\t$(OBJECTS) $(FLTK_LIBNAME) \\\n");
  fprintf(out, "\t\t\t$(FLTK_IMAGES_LIBNAME)\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ $(OBJECTS) $(LINKFLTKFORMS) $(LINK_FLTK_IMAGES) $(LDLIBS)\n");
  fprintf(out, "\t$(OSX_ONLY) $(INSTALL_BIN) fluid fluid.app/Contents/MacOS\n");
  fprintf(out, "\n");
  fprintf(out, "fluid-shared$(EXEEXT):\t$(OBJECTS) ../src/$(FLTK_DSONAME) \\\n");
  fprintf(out, "\t\t\t../src/$(FLTK_IMAGES_DSONAME)\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ $(OBJECTS) $(LINKSHARED) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "clean:\n");
  fprintf(out, "\t-$(RM) *.o core.* *~ *.bck *.bck\n");
  fprintf(out, "\t-$(RM) core fluid$(EXEEXT) fluid-shared$(EXEEXT)\n");
  fprintf(out, "\t-$(RM) fluid.app/Contents/MacOS/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "depend:\t$(CPPFILES)\n");
  fprintf(out, "\tmakedepend -Y -I.. -f makedepend $(CPPFILES)\n");
  fprintf(out, "\n");
  fprintf(out, "# Automatically generated dependencies...\n");
  fprintf(out, "include makedepend\n");
  fprintf(out, "\n");
  fprintf(out, "install: all\n");
  fprintf(out, "\techo \"Installing FLUID in $(DESTDIR)$(bindir)...\"\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)$(bindir)\n");
  fprintf(out, "\t$(INSTALL_BIN) $(FLUID) $(DESTDIR)$(bindir)/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "install-linux:\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/usr/share/applications\n");
  fprintf(out, "\t$(INSTALL_DATA) fluid.desktop  $(DESTDIR)/usr/share/applications\n");
  fprintf(out, "\tfor size in 16 32 48 64 128; do \\\n");
  fprintf(out, "\t\tif test ! -d $(DESTDIR)/usr/share/icons/hicolor/$${size}x$${size}/apps; then \\\n");
  fprintf(out, "\t\t\t$(INSTALL_DIR) $(DESTDIR)/usr/share/icons/hicolor/$${size}x$${size}/apps; \\\n");
  fprintf(out, "\t\tfi; \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) icons/fluid-$$size.png $(DESTDIR)/usr/share/icons/hicolor/$${size}x$${size}/apps/fluid.png; \\\n");
  fprintf(out, "\tdone\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/usr/share/mimelnk/application\n");
  fprintf(out, "\t$(INSTALL_DATA) x-fluid.desktop  $(DESTDIR)/usr/share/mimelnk/application\n");
  fprintf(out, "\n");
  fprintf(out, "install-osx:\n");
  fprintf(out, "\techo Installing Fluid in $(DESTDIR)/Applications...\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/Applications/fluid.app\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/Applications/fluid.app/Contents\n");
  fprintf(out, "\t$(INSTALL_DATA) fluid.app/Contents/Info.plist $(DESTDIR)/Applications/fluid.app/Contents/Info.plist\n");
  fprintf(out, "\t$(INSTALL_DATA) fluid.app/Contents/PkgInfo $(DESTDIR)/Applications/fluid.app/Contents/PkgInfo\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/Applications/fluid.app/Contents/MacOS\n");
  fprintf(out, "\t$(RM) $(DESTDIR)/Applications/fluid.app/Contents/MacOS/fluid\n");
  fprintf(out, "\t$(LN) $(bindir)/fluid $(DESTDIR)/Applications/fluid.app/Contents/MacOS/fluid\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/Applications/fluid.app/Contents/Resources\n");
  fprintf(out, "\t$(INSTALL_DATA) fluid.app/Contents/Resources/fluid.icns $(DESTDIR)/Applications/fluid.app/Contents/Resources\n");
  fprintf(out, "\n");
  fprintf(out, "uninstall:\n");
  fprintf(out, "\t$(RM) $(DESTDIR)$(bindir)/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "uninstall-linux:\n");
  fprintf(out, "\t$(RM) $(DESTDIR)/usr/share/applications/fluid.desktop\n");
  fprintf(out, "\t$(RM) $(DESTDIR)/usr/share/icons/hicolor/*/fluid.png\n");
  fprintf(out, "\t$(RM) $(DESTDIR)/usr/share/mimelnk/application/x-fluid.desktop\n");
  fprintf(out, "\n");
  fprintf(out, "uninstall-osx:\n");
  fprintf(out, "\t$(RM) -r $(DESTDIR)/Applications/fluid.app\n");
  fprintf(out, "\n");
  fprintf(out, "\n");
  fprintf(out, "#\n");
  fprintf(out, "# Note: The rebuild target can only be used if you have the original .fl\n");
  fprintf(out, "#       files.  This is normally only used by the FLTK maintainers...\n");
  fprintf(out, "#\n");
  fprintf(out, "\n");
  fprintf(out, "rebuild:\n");
  fprintf(out, "\t./fluid -c about_panel.fl\n");
  fprintf(out, "\t./fluid -c alignment_panel.fl\n");
  fprintf(out, "\t./fluid -c function_panel.fl\n");
  fprintf(out, "\t./fluid -c print_panel.fl\n");
  fprintf(out, "\t./fluid -c template_panel.fl\n");
  fprintf(out, "\t./fluid -c widget_panel.fl\n");
  fprintf(out, "\n");
  fprintf(out, "#\n");
  fprintf(out, "# End of \"$Id: Makefile 8966 2011-08-15 14:23:40Z matt $\".\n");
  fprintf(out, "#\n");

  return 0;
}

static int write_fltk_makefile(FILE *out, Fl_Workspace_Type *workspace, const char *path, const char *base_dir, const char *tgt_base, Fl_Target_Type *first_target) {
  
  Fl_Target_Type *tgt;
  
  fprintf(out, "#\n");
  fprintf(out, "# \"$Id: Makefile.tmpl 8897 2011-08-02 09:27:30Z matt $\"\n");
  fprintf(out, "#\n");
  fprintf(out, "# Library makefile for the Fast Light Tool Kit (FLTK).\n");
  fprintf(out, "#\n");
  fprintf(out, "# Copyright 1998-2010 by Bill Spitzak and others.\n");
  fprintf(out, "#\n");
  fprintf(out, "# This library is free software; you can redistribute it and/or\n");
  fprintf(out, "# modify it under the terms of the GNU Library General Public\n");
  fprintf(out, "# License as published by the Free Software Foundation; either\n");
  fprintf(out, "# version 2 of the License, or (at your option) any later version.\n");
  fprintf(out, "#\n");
  fprintf(out, "# This library is distributed in the hope that it will be useful,\n");
  fprintf(out, "# but WITHOUT ANY WARRANTY; without even the implied warranty of\n");
  fprintf(out, "# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n");
  fprintf(out, "# Library General Public License for more details.\n");
  fprintf(out, "#\n");
  fprintf(out, "# You should have received a copy of the GNU Library General Public\n");
  fprintf(out, "# License along with this library; if not, write to the Free Software\n");
  fprintf(out, "# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307\n");
  fprintf(out, "# USA.\n");
  fprintf(out, "#\n");
  fprintf(out, "# Please report all bugs and problems on the following page:\n");
  fprintf(out, "#\n");
  fprintf(out, "#      http://www.fltk.org/str.php\n");
  fprintf(out, "#\n");
  fprintf(out, "\n");
  
  // list all CPP files for all targets
  for (tgt = first_target; tgt; tgt = tgt->next_target(workspace)) {
    if (tgt->builds_in(FL_ENV_MAKE) && strcmp(tgt->makefile_path(), path)==0 && target_has_cplusplus_code(tgt)) {
      fprintf(out, "%s_CPPFILES =", tgt->caps_name());
      Fl_File_Type *file;
      for (file = Fl_File_Type::first_file(tgt); file; file = file->next_file(tgt)) {
        if (file->builds_in(FL_ENV_MAKE) && file->file_is_cplusplus_code()) {
          fprintf(out, " \\\n\t");
          write_file(out, file, base_dir, tgt_base);
        }
      }
      fprintf(out, "\n\n");
    }
  }

  // list all ObjC files for all targets
  for (tgt = first_target; tgt; tgt = tgt->next_target(workspace)) {
    if (tgt->builds_in(FL_ENV_MAKE) && strcmp(tgt->makefile_path(), path)==0 && target_has_objc_code(tgt)) {
      fprintf(out, "%s_OBJCPPFILES =", tgt->caps_name());
      Fl_File_Type *file;
      for (file = Fl_File_Type::first_file(tgt); file; file = file->next_file(tgt)) {
        if (file->builds_in(FL_ENV_MAKE) && file->file_is_objc_code()) {
          fprintf(out, " \\\n\t");
          write_file(out, file, base_dir, tgt_base);
        }
      }
      fprintf(out, "\n\n");
    }
  }
  
  // list all C files for all targets
  for (tgt = first_target; tgt; tgt = tgt->next_target(workspace)) {
    if (tgt->builds_in(FL_ENV_MAKE) && strcmp(tgt->makefile_path(), path)==0 && target_has_c_code(tgt)) {
      fprintf(out, "%s_CFILES =", tgt->caps_name());
      Fl_File_Type *file;
      for (file = Fl_File_Type::first_file(tgt); file; file = file->next_file(tgt)) {
        if (file->builds_in(FL_ENV_MAKE) && file->file_is_c_code()) {
          fprintf(out, " \\\n\t");
          write_file(out, file, base_dir, tgt_base);
        }
      }
      fprintf(out, "\n\n");
    }
  }
  
  fprintf(out, "################################################################\n");
  fprintf(out, "FLTKFLAGS = -DFL_LIBRARY\n");
  fprintf(out, "include ../makeinclude\n");
  fprintf(out, "\n");
  
  // ObjC files only compile on OS X:
  for (tgt = first_target; tgt; tgt = tgt->next_target(workspace)) {
    if (tgt->builds_in(FL_ENV_MAKE) && strcmp(tgt->makefile_path(), path)==0 && target_has_objc_code(tgt)) {
      fprintf(out, "%s_MMFILES = $(shell if test $(USEMMFILES) = Yes; then echo $(%s_OBJCPPFILES); fi)\n", tgt->caps_name(), tgt->caps_name());
    }
  }
  fprintf(out, "\n");
  
  for (tgt = first_target; tgt; tgt = tgt->next_target(workspace)) {
    if (tgt->builds_in(FL_ENV_MAKE) && strcmp(tgt->makefile_path(), path)==0) {
      fprintf(out, "%s_OBJECTS =", tgt->caps_name());
      if (target_has_cplusplus_code(tgt)) {
        fprintf(out, " $(%s_CPPFILES:.cxx=.o)", tgt->caps_name());
      }
      if (target_has_objc_code(tgt)) {
        fprintf(out, " $(%s_MMFILES:.mm=.o)", tgt->caps_name());
      }
      if (target_has_c_code(tgt)) {
        fprintf(out, " $(%s_CFILES:.c=.o)", tgt->caps_name());
      }
      fprintf(out, "\n");
    }
  }
  fprintf(out, "\n");
  
  fprintf(out, "all:\t$(FLTK_LIBNAME) $(FLTK_DSONAME) \\\n");
  fprintf(out, "\t$(FLTK_GL_LIBNAME) $(FLTK_GL_DSONAME) \\\n");
  fprintf(out, "\t$(FLTK_IMAGES_LIBNAME) $(FLTK_IMAGES_DSONAME) \n");
  fprintf(out, "\n");
  
  for (tgt = first_target; tgt; tgt = tgt->next_target(workspace)) {
    if (tgt->builds_in(FL_ENV_MAKE) && strcmp(tgt->makefile_path(), path)==0) {
      fprintf(out, "$(%s_LIBNAME): $(%s_OBJECTS)\n", tgt->caps_name(), tgt->caps_name());
      fprintf(out, "\techo $(LIBCOMMAND) $@ ...\n");
      fprintf(out, "\t$(RM) $@\n");
      fprintf(out, "\t$(LIBCOMMAND) $@ $(%s_OBJECTS)\n", tgt->caps_name());
      fprintf(out, "\t$(RANLIB) $@\n");
      fprintf(out, "\n");
    }
  }
  
  fprintf(out, "libfltk.so.1.3: $(FLTK_OBJECTS)\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ $(FLTK_OBJECTS)\n");
  fprintf(out, "\t$(RM) libfltk.so\n");
  fprintf(out, "\t$(LN) libfltk.so.1.3 libfltk.so\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk.sl.1.3: $(FLTK_OBJECTS)\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ $(FLTK_OBJECTS)\n");
  fprintf(out, "\t$(RM) libfltk.sl\n");
  fprintf(out, "\t$(LN) libfltk.sl.1.3 libfltk.sl\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk.1.3.dylib: $(FLTK_OBJECTS)\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ \\\n");
  fprintf(out, "\t\t-install_name $(libdir)/$@ \\\n");
  fprintf(out, "\t\t-current_version 1.3.0 \\\n");
  fprintf(out, "\t\t-compatibility_version 1.3.0 \\\n");
  fprintf(out, "\t\t$(FLTK_OBJECTS) $(LDLIBS)\n");
  fprintf(out, "\t$(RM) libfltk.dylib\n");
  fprintf(out, "\t$(LN) libfltk.1.3.dylib libfltk.dylib\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk_s.a: $(FLTK_OBJECTS)\n");
  fprintf(out, "\techo $(DSOCOMMAND) libfltk_s.o ...\n");
  fprintf(out, "\t$(DSOCOMMAND) libfltk_s.o $(FLTK_OBJECTS) $(IMAGELIBS)\n");
  fprintf(out, "\techo $(LIBCOMMAND) libfltk_s.a libfltk_s.o\n");
  fprintf(out, "\t$(RM) $@\n");
  fprintf(out, "\t$(LIBCOMMAND) libfltk_s.a libfltk_s.o\n");
  fprintf(out, "\t$(CHMOD) +x libfltk_s.a\n");
  fprintf(out, "\n");
  
  fprintf(out, "libfltk_gl.so.1.3: $(FLTK_GL_OBJECTS) libfltk.so.1.3\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ $(FLTK_GL_OBJECTS) -L. -lfltk\n");
  fprintf(out, "\t$(RM) libfltk_gl.so\n");
  fprintf(out, "\t$(LN) libfltk_gl.so.1.3 libfltk_gl.so\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk_gl.sl.1.3: $(FLTK_GL_OBJECTS) libfltk.sl.1.3\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ $(FLTK_GL_OBJECTS) -L. -lfltk\n");
  fprintf(out, "\t$(RM) libfltk_gl.sl\n");
  fprintf(out, "\t$(LN) libfltk_gl.sl.1.3 libfltk_gl.sl\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk_gl.1.3.dylib: $(FLTK_GL_OBJECTS) libfltk.1.3.dylib\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ \\\n");
  fprintf(out, "\t\t-install_name $(libdir)/$@ \\\n");
  fprintf(out, "\t\t-current_version 1.3.0 \\\n");
  fprintf(out, "\t\t-compatibility_version 1.3.0 \\\n");
  fprintf(out, "\t\t$(FLTK_GL_OBJECTS) -L. $(GLDLIBS) -lfltk\n");
  fprintf(out, "\t$(RM) libfltk_gl.dylib\n");
  fprintf(out, "\t$(LN) libfltk_gl.1.3.dylib libfltk_gl.dylib\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk_gl_s.a: $(FLTK_GL_OBJECTS)\n");
  fprintf(out, "\techo $(DSOCOMMAND) libfltk_gl_s.o ...\n");
  fprintf(out, "\t$(DSOCOMMAND) libfltk_gl_s.o $(FLTK_GL_OBJECTS)\n");
  fprintf(out, "\techo $(LIBCOMMAND) libfltk_gl_s.a libfltk_gl_s.o\n");
  fprintf(out, "\t$(RM) $@\n");
  fprintf(out, "\t$(LIBCOMMAND) libfltk_gl_s.a libfltk_gl_s.o\n");
  fprintf(out, "\t$(CHMOD) +x libfltk_gl_s.a\n");
  fprintf(out, "\n");
  
  fprintf(out, "libfltk_images.so.1.3: $(FLTK_IMAGES_OBJECTS) libfltk.so.1.3\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ $(FLTK_IMAGES_OBJECTS) -L. $(IMAGELIBS) -lfltk\n");
  fprintf(out, "\t$(RM) libfltk_images.so\n");
  fprintf(out, "\t$(LN) libfltk_images.so.1.3 libfltk_images.so\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk_images.sl.1.3: $(FLTK_IMAGES_OBJECTS) libfltk.sl.1.3\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ $(FLTK_IMAGES_OBJECTS) -L. $(IMAGELIBS) -lfltk\n");
  fprintf(out, "\t$(RM) libfltk_images.sl\n");
  fprintf(out, "\t$(LN) libfltk_images.sl.1.3 libfltk_images.sl\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk_images.1.3.dylib: $(FLTK_IMAGES_OBJECTS) libfltk.1.3.dylib\n");
  fprintf(out, "\techo $(DSOCOMMAND) $@ ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $@ \\\n");
  fprintf(out, "\t\t-install_name $(libdir)/$@ \\\n");
  fprintf(out, "\t\t-current_version 1.3.0 \\\n");
  fprintf(out, "\t\t-compatibility_version 1.3.0 \\\n");
  fprintf(out, "\t\t$(FLTK_IMAGES_OBJECTS)  -L. $(LDLIBS) $(IMAGELIBS) -lfltk\n");
  fprintf(out, "\t$(RM) libfltk_images.dylib\n");
  fprintf(out, "\t$(LN) libfltk_images.1.3.dylib libfltk_images.dylib\n");
  fprintf(out, "\n");
  fprintf(out, "libfltk_images_s.a: $(FLTK_IMAGES_OBJECTS)\n");
  fprintf(out, "\techo $(DSOCOMMAND) libfltk_images_s.o ...\n");
  fprintf(out, "\t$(DSOCOMMAND) libfltk_images_s.o $(FLTK_IMAGES_OBJECTS)\n");
  fprintf(out, "\techo $(LIBCOMMAND) libfltk_images_s.a libfltk_images_s.o\n");
  fprintf(out, "\t$(RM) $@\n");
  fprintf(out, "\t$(LIBCOMMAND) libfltk_images_s.a libfltk_images_s.o\n");
  fprintf(out, "\t$(CHMOD) +x libfltk_images_s.a\n");
  fprintf(out, "\n");
  
  fprintf(out, "#-----------------------------------------------------------------\n");
  fprintf(out, "# - the import libraries libfltk*.dll.a and the .dll files\n");
  fprintf(out, "#   are created from the libfltk*.a files. They are built\n");
  fprintf(out, "#   into the src dir.\n");
  fprintf(out, "# - The _images, _gl and dlls must be linked\n");
  fprintf(out, "#   against the import libraries in the src dir.\n");
  fprintf(out, "#-----------------------------------------------------------------\n");
  fprintf(out, "\n");
  fprintf(out, "#-----------------------------------------------------------------\n");
  fprintf(out, "# cygwin GDI shared libraries\n");
  fprintf(out, "#-----------------------------------------------------------------\n");
  fprintf(out, "\n");
  fprintf(out, "cygfltknox-1.3.dll: $(FLTK_LIBNAME)\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(FLTK_LIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(FLTK_LIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk.dll.a $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "cygfltknox_gl-1.3.dll: $(FLTK_GL_LIBNAME) cygfltknox-1.3.dll\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(FLTK_GL_LIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(FLTK_GL_LIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk_gl.dll.a \\\n");
  fprintf(out, "\t\t-L. -lfltk $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "cygfltknox_images-1.3.dll: $(FLTK_IMAGES_LIBNAME) cygfltknox-1.3.dll\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(FLTK_IMAGES_LIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(FLTK_IMAGES_LIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk_images.dll.a \\\n");
  fprintf(out, "\t\t-L. -lfltk -Wl,--exclude-libs -Wl,libfltk_png.a \\\n");
  fprintf(out, "\t\t\t$(IMAGELIBS) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "#-----------------------------------------------------------------\n");
  fprintf(out, "# cygwin X11 shared libraries\n");
  fprintf(out, "#-----------------------------------------------------------------\n");
  fprintf(out, "\n");
  fprintf(out, "cygfltk-1.3.dll: $(FLTK_LIBNAME)\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(FLTK_LIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(FLTK_LIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk.dll.a $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "cygfltk_gl-1.3.dll: $(FLTK_GL_LIBNAME) cygfltk-1.3.dll\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(FLTK_GL_LIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(FLTK_GL_LIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk_gl.dll.a \\\n");
  fprintf(out, "\t\t-L. -lfltk $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "cygfltk_images-1.3.dll: $(FLTK_IMAGES_LIBNAME) cygfltk-1.3.dll\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(FLTK_IMAGES_LIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(FLTK_IMAGES_LIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk_images.dll.a \\\n");
  fprintf(out, "\t\t-L. -lfltk -Wl,--exclude-libs -Wl,libfltk_png.a \\\n");
  fprintf(out, "\t\t\t$(IMAGELIBS) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "mgwfltknox-1.3.dll: $(FLTK_LIBNAME)\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(FLTK_LIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(FLTK_LIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk.dll.a $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "mgwfltknox_gl-1.3.dll: $(FLTK_GL_LIBNAME) mgwfltknox-1.3.dll\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(FLTK_GL_LIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(FLTK_GL_LIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk_gl.dll.a \\\n");
  fprintf(out, "\t\t-L. -lfltk $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "#-----------------------------------------------------\n");
  fprintf(out, "# See STR #1585 for --exclude-libs\n");
  fprintf(out, "#-----------------------------------------------------\n");
  fprintf(out, "\n");
  fprintf(out, "mgwfltknox_images-1.3.dll: $(FLTK_IMAGES_LIBNAME) mgwfltknox-1.3.dll\n");
  fprintf(out, "\techo $(DSOCOMMAND) $(FLTK_IMAGES_LIBNAME) ...\n");
  fprintf(out, "\t$(DSOCOMMAND) $(FLTK_IMAGES_LIBNAME) -Wl,--no-whole-archive \\\n");
  fprintf(out, "\t\t-Wl,--out-implib=libfltk_images.dll.a \\\n");
  fprintf(out, "\t\t-L. -lfltk -Wl,--exclude-libs -Wl,libfltk_png.a \\\n");
  fprintf(out, "\t\t\t$(IMAGELIBS) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "clean:\n");
  fprintf(out, "\t-$(RM) *.o xutf8/*.o *.dll.a core.* *~ *.bak *.bck\n");
  fprintf(out, "\t-$(RM) $(FLTK_DSONAME) $(FLTK_GL_DSONAME) $(FLTK_IMAGES_DSONAME) \\\n");
  fprintf(out, "\t\t$(FLTK_LIBNAME) $(FLTK_GL_LIBNAME) \\\n");
  fprintf(out, "\t\t$(FLTK_IMAGES_LIBNAME) \\\n");
  fprintf(out, "\t\tlibfltk.so libfltk_gl.so libfltk_images.so \\\n");
  fprintf(out, "\t\tlibfltk.sl libfltk_gl.sl libfltk_images.sl \\\n");
  fprintf(out, "\t\tlibfltk.dylib \\\n");
  fprintf(out, "\t\tlibfltk_gl.dylib libfltk_images.dylib \\\n");
  fprintf(out, "\t\tcmap core\n");
  fprintf(out, "\n");
  fprintf(out, "depend:\t$(FLTK_CPPFILES) $(FLTK_MMFILES) $(FLTK_GL_CPPFILES) $(FLTK_IMAGES_CPPFILES) $(FLTK_CFILES)\n");
  fprintf(out, "\tmakedepend -Y -I.. -f makedepend $(FLTK_CPPFILES) $(FLTK_MMFILES) \\\n");
  fprintf(out, "\t\t$(FLTK_GL_CPPFILES) $(FLTK_IMAGES_CPPFILES) $(FLTK_CFILES)\n");
  fprintf(out, "\n");
  fprintf(out, "# Automatically generated dependencies... generated on a Linux/Unix host !\n");
  fprintf(out, "include makedepend\n");
  fprintf(out, "\n");
  fprintf(out, "# These dependencies aren't part of the makedepend file since\n");
  fprintf(out, "# they are part of the WIN32 and MacOS code base...\n");
  fprintf(out, "# Please add only non-Linux/Unix files or such that are optional\n");
  fprintf(out, "# (like \"*xft*\") here:\n");
  fprintf(out, "Fl_get_key.o:\tFl_get_key_mac.cxx Fl_get_key_win32.cxx\n");
  fprintf(out, "Fl_Native_File_Chooser.o : Fl_Native_File_Chooser_WIN32.cxx\n");
  fprintf(out, "Fl_Native_File_Chooser_MAC.o:\tFl_Native_File_Chooser_MAC.mm\n");
  fprintf(out, "Fl.o:\t\tFl_win32.cxx\n");
  fprintf(out, "Fl_cocoa.o:\tFl_cocoa.mm\n");
  fprintf(out, "fl_color.o:\tfl_color_mac.cxx fl_color_win32.cxx\n");
  fprintf(out, "fl_dnd.o:\tfl_dnd_win32.cxx fl_dnd_x.cxx\n");
  fprintf(out, "fl_draw_image.o: fl_draw_image_mac.cxx fl_draw_image_win32.cxx\n");
  fprintf(out, "fl_font.o:\tfl_font_mac.cxx fl_font_x.cxx fl_font_xft.cxx fl_font_win32.cxx\n");
  fprintf(out, "fl_read_image.o: fl_read_image_mac.cxx fl_read_image_win32.cxx\n");
  fprintf(out, "fl_set_fonts.o:\tfl_set_fonts_mac.cxx fl_set_fonts_x.cxx \\\n");
  fprintf(out, "\t\tfl_set_fonts_xft.cxx fl_set_fonts_win32.cxx\n");
  fprintf(out, "Fl_Printer.o: Fl_GDI_Printer.cxx Fl_PostScript.cxx\n");
  fprintf(out, "Fl_Quartz_Printer.o:\tFl_Quartz_Printer.mm\n");
  fprintf(out, "fl_arci.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_arg.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_ask.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Bitmap.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_color.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_cursor.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_dnd.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Double_Window.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_draw_image.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_draw_image_mac.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_draw_image_win32.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_draw_pixmap.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_encoding_latin1.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_encoding_mac_roman.o:   ../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_File_Chooser2.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_font.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_get_key.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_get_system_colors.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Gl_Choice.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Gl_Overlay.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Gl_Window.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_grab.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Image.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_line_style.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Menu_Window.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_overlay.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_overlay_visual.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Overlay_Window.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_own_colormap.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Pixmap.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Printer.o:  ../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_read_image.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_read_image_mac.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_read_image_win32.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_rect.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_scroll_area.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_set_font.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_set_fonts.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_shortcut.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "fl_vertex.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_visual.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Window_fullscreen.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_Window_iconize.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "Fl_x.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "gl_draw.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "gl_start.o:\t../fltk3/osx.h ../fltk3/win32.h\n");
  fprintf(out, "\n");
  fprintf(out, "################################################################\n");
  fprintf(out, "\n");
  fprintf(out, "install: $(FLTK_LIBNAME) $(FLTK_DSONAME) \\\n");
  fprintf(out, "\t$(FLTK_GL_LIBNAME) $(FLTK_GL_DSONAME) \\\n");
  fprintf(out, "\t$(FLTK_IMAGES_LIBNAME) $(FLTK_IMAGES_DSONAME) \n");
  fprintf(out, "\techo \"Installing libraries in $(DESTDIR)$(libdir)...\"\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)$(libdir)\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)$(bindir)\n");
  fprintf(out, "\t$(RM) $(DESTDIR)$(libdir)/$(FLTK_LIBBASENAME)\n");
  fprintf(out, "\t$(INSTALL_LIB) $(FLTK_LIBNAME) $(DESTDIR)$(libdir)\n");
  fprintf(out, "\t$(INSTALL_LIB) $(FLTK_IMAGES_LIBNAME) $(DESTDIR)$(libdir)\n");
  fprintf(out, "\t$(RANLIB) $(DESTDIR)$(libdir)/$(FLTK_LIBBASENAME)\n");
  fprintf(out, "\tif test x$(FLTK_GL_LIBNAME) != x; then \\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) $(FLTK_GL_LIBNAME) $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(RANLIB) $(DESTDIR)$(libdir)/$(FLTK_GL_LIBBASENAME); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\t$(RANLIB) $(DESTDIR)$(libdir)/$(FLTK_IMAGES_LIBBASENAME)\n");
  fprintf(out, "\tif test x$(FLTK_DSONAME) = xlibfltk.so.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.so*;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk.so.1.3 $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk.so.1.3 $(DESTDIR)$(libdir)/libfltk.so;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_DSONAME) = xlibfltk.sl.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.sl*;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk.sl.1.3 $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk.sl.1.3 $(DESTDIR)$(libdir)/libfltk.sl;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_DSONAME) = xlibfltk.1.3.dylib; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.*dylib;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk.1.3.dylib $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk.1.3.dylib $(DESTDIR)$(libdir)/libfltk.dylib;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_DSONAME) = xlibfltk_s.a; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_s.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_s.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_DSONAME) = xcygfltknox-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(FLTK_DSONAME);\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) $(FLTK_DSONAME) $(DESTDIR)$(bindir); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.dll.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk.dll.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_DSONAME) = xmgwfltknox-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(FLTK_DSONAME);\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) $(FLTK_DSONAME) $(DESTDIR)$(bindir); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.dll.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk.dll.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_GL_DSONAME) = xlibfltk_gl.so.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.so*;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_gl.so.1.3 $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk_gl.so.1.3 $(DESTDIR)$(libdir)/libfltk_gl.so;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_GL_DSONAME) = xlibfltk_gl.sl.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.sl*;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_gl.sl.1.3 $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk_gl.sl.1.3 $(DESTDIR)$(libdir)/libfltk_gl.sl;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_GL_DSONAME) = xlibfltk_gl.1.3.dylib; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.*dylib;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_gl.1.3.dylib $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk_gl.1.3.dylib $(DESTDIR)$(libdir)/libfltk_gl.dylib;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_GL_DSONAME) = xlibfltk_gl_s.a; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl_s.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_gl_s.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_GL_DSONAME) = xcygfltknox_gl-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(FLTK_GL_DSONAME);\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) $(FLTK_GL_DSONAME) $(DESTDIR)$(bindir); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.dll.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_gl.dll.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_GL_DSONAME) = xmgwfltknox_gl-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(FLTK_GL_DSONAME);\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) $(FLTK_GL_DSONAME) $(DESTDIR)$(bindir); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.dll.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_gl.dll.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_IMAGES_DSONAME) = xlibfltk_images.so.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.so*;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_images.so.1.3 $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk_images.so.1.3 $(DESTDIR)$(libdir)/libfltk_images.so;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_IMAGES_DSONAME) = xlibfltk_images.sl.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.sl*;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_images.sl.1.3 $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk_images.sl.1.3 $(DESTDIR)$(libdir)/libfltk_images.sl;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_IMAGES_DSONAME) = xlibfltk_images.1.3.dylib; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.*dylib;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_images.1.3.dylib $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\t\t$(LN) libfltk_images.1.3.dylib $(DESTDIR)$(libdir)/libfltk_images.dylib;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_IMAGES_DSONAME) = xlibfltk_images_s.a; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images_s.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_images_s.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_IMAGES_DSONAME) = xcygfltknox_images-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(FLTK_IMAGES_DSONAME); \\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) $(FLTK_IMAGES_DSONAME) $(DESTDIR)$(bindir); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.dll.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_images.dll.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_IMAGES_DSONAME) = xmgwfltknox_images-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(FLTK_IMAGES_DSONAME); \\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) $(FLTK_IMAGES_DSONAME) $(DESTDIR)$(bindir); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.dll.a;\\\n");
  fprintf(out, "\t\t$(INSTALL_LIB) libfltk_images.dll.a $(DESTDIR)$(libdir); \\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "\n");
  fprintf(out, "uninstall:\n");
  fprintf(out, "\techo \"Uninstalling libraries...\"\n");
  fprintf(out, "\t$(RM) $(DESTDIR)$(libdir)/$(FLTK_LIBBASENAME)\n");
  fprintf(out, "\tif test x$(FLTK_DSONAME) = xlibfltk.so.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.so*;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_DSONAME) = xlibfltk.sl.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.sl*;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_DSONAME) = xlibfltk.1.3.dylib; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.*dylib;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_DSONAME) = xlibfltk_s.a; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_s.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_DSONAME) = xcygfltknox-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(FLTK_DSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_DSONAME) = xcygfltk-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(FLTK_DSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_DSONAME) = xmgwfltknox-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(FLTK_DSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_GL_LIBNAME) != x; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/$(FLTK_GL_LIBBASENAME);\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_GL_DSONAME) = xlibfltk_gl.so.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.so*;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_GL_DSONAME) = xlibfltk_gl.sl.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.sl*;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_GL_DSONAME) = xlibfltk_gl.1.3.dylib; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.*dylib;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_GL_DSONAME) = xlibfltk_gl_s.a; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl_s.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_GL_DSONAME) = xcygfltknox_gl-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(FLTK_GL_DSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_GL_DSONAME) = xcygfltk_gl-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(FLTK_GL_DSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_GL_DSONAME) = xmgwfltknox_gl-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(FLTK_GL_DSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_gl.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_IMAGES_LIBNAME) != x; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/$(FLTK_IMAGES_LIBBASENAME);\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_IMAGES_DSONAME) = xlibfltk_images.so.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.so*;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_IMAGES_DSONAME) = xlibfltk_images.sl.1.3; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.sl*;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_IMAGES_DSONAME) = xlibfltk_images.1.3.dylib; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.*dylib;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_IMAGES_DSONAME) = xlibfltk_images_s.a; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images_s.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_IMAGES_DSONAME) = xcygfltknox_images-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(FLTK_IMAGES_DSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_IMAGES_DSONAME) = xcygfltk_images-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(FLTK_IMAGES_DSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\tif test x$(FLTK_IMAGES_DSONAME) = xmgwfltknox_images-1.3.dll; then\\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$(FLTK_IMAGES_DSONAME); \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(libdir)/libfltk_images.dll.a;\\\n");
  fprintf(out, "\tfi\n");
  fprintf(out, "\n");
  fprintf(out, "#\n");
  fprintf(out, "# End of \"$Id: Makefile.tmpl 8897 2011-08-02 09:27:30Z matt $\".\n");
  fprintf(out, "#\n");
  fprintf(out, "# DO NOT DELETE\n");
  
  return 0;
}


static int write_test_makefile(FILE *out, Fl_Workspace_Type *workspace, const char *path, const char *base_dir, const char *tgt_base, Fl_Target_Type *first_target) {

  fprintf(out, "#\n");
  fprintf(out, "# \"$Id: Makefile 8740 2011-05-26 14:43:46Z matt $\"\n");
  fprintf(out, "#\n");
  fprintf(out, "# Test/example program makefile for the Fast Light Tool Kit (FLTK).\n");
  fprintf(out, "#\n");
  fprintf(out, "# Copyright 1998-2010 by Bill Spitzak and others.\n");
  fprintf(out, "#\n");
  fprintf(out, "# This library is free software; you can redistribute it and/or\n");
  fprintf(out, "# modify it under the terms of the GNU Library General Public\n");
  fprintf(out, "# License as published by the Free Software Foundation; either\n");
  fprintf(out, "# version 2 of the License, or (at your option) any later version.\n");
  fprintf(out, "#\n");
  fprintf(out, "# This library is distributed in the hope that it will be useful,\n");
  fprintf(out, "# but WITHOUT ANY WARRANTY; without even the implied warranty of\n");
  fprintf(out, "# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n");
  fprintf(out, "# Library General Public License for more details.\n");
  fprintf(out, "#\n");
  fprintf(out, "# You should have received a copy of the GNU Library General Public\n");
  fprintf(out, "# License along with this library; if not, write to the Free Software\n");
  fprintf(out, "# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307\n");
  fprintf(out, "# USA.\n");
  fprintf(out, "#\n");
  fprintf(out, "# Please report all bugs and problems on the following page:\n");
  fprintf(out, "#\n");
  fprintf(out, "#      http://www.fltk.org/str.php\n");
  fprintf(out, "#\n");
  fprintf(out, "\n");
  fprintf(out, "include ../makeinclude\n");
  fprintf(out, "\n");
  fprintf(out, "CPPFILES =\\\n");
  fprintf(out, "\tunittests.cxx \\\n");
  fprintf(out, "\tadjuster.cxx \\\n");
  fprintf(out, "\tarc.cxx \\\n");
  fprintf(out, "\task.cxx \\\n");
  fprintf(out, "\tbitmap.cxx \\\n");
  fprintf(out, "\tblocks.cxx \\\n");
  fprintf(out, "\tboxtype.cxx \\\n");
  fprintf(out, "\tbrowser.cxx \\\n");
  fprintf(out, "\tbutton.cxx \\\n");
  fprintf(out, "\tbuttons.cxx \\\n");
  fprintf(out, "\tcairo_test.cxx \\\n");
  fprintf(out, "\tcheckers.cxx \\\n");
  fprintf(out, "\tclock.cxx \\\n");
  fprintf(out, "\tcolbrowser.cxx \\\n");
  fprintf(out, "\tcolor_chooser.cxx \\\n");
  fprintf(out, "\tcube.cxx \\\n");
  fprintf(out, "\tCubeMain.cxx \\\n");
  fprintf(out, "\tCubeView.cxx \\\n");
  fprintf(out, "\tcursor.cxx \\\n");
  fprintf(out, "\tcurve.cxx \\\n");
  fprintf(out, "\tdemo.cxx \\\n");
  fprintf(out, "\tdevice.cxx \\\n");
  fprintf(out, "\tdoublebuffer.cxx \\\n");
  fprintf(out, "\teditor.cxx \\\n");
  fprintf(out, "\tfast_slow.cxx \\\n");
  fprintf(out, "\tfile_chooser.cxx \\\n");
  fprintf(out, "\tfonts.cxx \\\n");
  fprintf(out, "\tfractals.cxx \\\n");
  fprintf(out, "\tfullscreen.cxx \\\n");
  fprintf(out, "\tgl_overlay.cxx \\\n");
  fprintf(out, "\tglpuzzle.cxx \\\n");
  fprintf(out, "\thello.cxx \\\n");
  fprintf(out, "\thelp.cxx \\\n");
  fprintf(out, "\ticonize.cxx \\\n");
  fprintf(out, "\timage.cxx \\\n");
  fprintf(out, "\tinactive.cxx \\\n");
  fprintf(out, "\tinput.cxx \\\n");
  fprintf(out, "\tinput_choice.cxx \\\n");
  fprintf(out, "\tkeyboard.cxx \\\n");
  fprintf(out, "\tlabel.cxx \\\n");
  fprintf(out, "\tline_style.cxx \\\n");
  fprintf(out, "\tlist_visuals.cxx \\\n");
  fprintf(out, "\tmandelbrot.cxx \\\n");
  fprintf(out, "\tmenubar.cxx \\\n");
  fprintf(out, "\tmessage.cxx \\\n");
  fprintf(out, "\tminimum.cxx \\\n");
  fprintf(out, "\tnative-filechooser.cxx \\\n");
  fprintf(out, "\tnavigation.cxx \\\n");
  fprintf(out, "\toutput.cxx \\\n");
  fprintf(out, "\toverlay.cxx \\\n");
  fprintf(out, "\tpack.cxx \\\n");
  fprintf(out, "\tpixmap_browser.cxx \\\n");
  fprintf(out, "\tpixmap.cxx \\\n");
  fprintf(out, "\tpreferences.cxx \\\n");
  fprintf(out, "\tdevice.cxx \\\n");
  fprintf(out, "\tradio.cxx \\\n");
  fprintf(out, "\tresizebox.cxx \\\n");
  fprintf(out, "\tresize.cxx \\\n");
  fprintf(out, "\trotated_text.cxx \\\n");
  fprintf(out, "\tscroll.cxx \\\n");
  fprintf(out, "\tshape.cxx \\\n");
  fprintf(out, "\tsubwindow.cxx \\\n");
  fprintf(out, "\tsudoku.cxx \\\n");
  fprintf(out, "\tsymbols.cxx \\\n");
  fprintf(out, "\ttable.cxx \\\n");
  fprintf(out, "\ttabs.cxx \\\n");
  fprintf(out, "\tthreads.cxx \\\n");
  fprintf(out, "\ttile.cxx \\\n");
  fprintf(out, "\ttiled_image.cxx \\\n");
  fprintf(out, "\ttree.cxx \\\n");
  fprintf(out, "\tvaluators.cxx \\\n");
  fprintf(out, "\tutf8.cxx\n");
  fprintf(out, "\n");
  fprintf(out, "ALL =\t\\\n");
  fprintf(out, "\tunittests$(EXEEXT) \\\n");
  fprintf(out, "\tadjuster$(EXEEXT) \\\n");
  fprintf(out, "\tarc$(EXEEXT) \\\n");
  fprintf(out, "\task$(EXEEXT) \\\n");
  fprintf(out, "\tbitmap$(EXEEXT) \\\n");
  fprintf(out, "\tblocks$(EXEEXT) \\\n");
  fprintf(out, "\tboxtype$(EXEEXT) \\\n");
  fprintf(out, "\tbrowser$(EXEEXT) \\\n");
  fprintf(out, "\tbutton$(EXEEXT) \\\n");
  fprintf(out, "\tbuttons$(EXEEXT) \\\n");
  fprintf(out, "\tcairo_test$(EXEEXT) \\\n");
  fprintf(out, "\tcheckers$(EXEEXT) \\\n");
  fprintf(out, "\tclock$(EXEEXT) \\\n");
  fprintf(out, "\tcolbrowser$(EXEEXT) \\\n");
  fprintf(out, "\tcolor_chooser$(EXEEXT) \\\n");
  fprintf(out, "\tcursor$(EXEEXT) \\\n");
  fprintf(out, "\tcurve$(EXEEXT) \\\n");
  fprintf(out, "\tdemo$(EXEEXT) \\\n");
  fprintf(out, "\tdevice$(EXEEXT) \\\n");
  fprintf(out, "\tdoublebuffer$(EXEEXT) \\\n");
  fprintf(out, "\teditor$(EXEEXT) \\\n");
  fprintf(out, "\tfast_slow$(EXEEXT) \\\n");
  fprintf(out, "\tfile_chooser$(EXEEXT) \\\n");
  fprintf(out, "\tfonts$(EXEEXT) \\\n");
  fprintf(out, "\thello$(EXEEXT) \\\n");
  fprintf(out, "\thelp$(EXEEXT) \\\n");
  fprintf(out, "\ticonize$(EXEEXT) \\\n");
  fprintf(out, "\timage$(EXEEXT) \\\n");
  fprintf(out, "\tinactive$(EXEEXT) \\\n");
  fprintf(out, "\tinput$(EXEEXT) \\\n");
  fprintf(out, "\tinput_choice$(EXEEXT) \\\n");
  fprintf(out, "\tkeyboard$(EXEEXT) \\\n");
  fprintf(out, "\tlabel$(EXEEXT) \\\n");
  fprintf(out, "\tline_style$(EXEEXT) \\\n");
  fprintf(out, "\tlist_visuals$(EXEEXT) \\\n");
  fprintf(out, "\tmandelbrot$(EXEEXT) \\\n");
  fprintf(out, "\tmenubar$(EXEEXT) \\\n");
  fprintf(out, "\tmessage$(EXEEXT) \\\n");
  fprintf(out, "\tminimum$(EXEEXT) \\\n");
  fprintf(out, "\tnative-filechooser$(EXEEXT) \\\n");
  fprintf(out, "\tnavigation$(EXEEXT) \\\n");
  fprintf(out, "\toutput$(EXEEXT) \\\n");
  fprintf(out, "\toverlay$(EXEEXT) \\\n");
  fprintf(out, "\tpack$(EXEEXT) \\\n");
  fprintf(out, "\tpixmap$(EXEEXT) \\\n");
  fprintf(out, "\tpixmap_browser$(EXEEXT) \\\n");
  fprintf(out, "\tpreferences$(EXEEXT) \\\n");
  fprintf(out, "\tdevice$(EXEEXT) \\\n");
  fprintf(out, "\tradio$(EXEEXT) \\\n");
  fprintf(out, "\tresize$(EXEEXT) \\\n");
  fprintf(out, "\tresizebox$(EXEEXT) \\\n");
  fprintf(out, "\trotated_text$(EXEEXT) \\\n");
  fprintf(out, "\tscroll$(EXEEXT) \\\n");
  fprintf(out, "\tsubwindow$(EXEEXT) \\\n");
  fprintf(out, "\tsudoku$(EXEEXT) \\\n");
  fprintf(out, "\tsymbols$(EXEEXT) \\\n");
  fprintf(out, "\ttable$(EXEEXT) \\\n");
  fprintf(out, "\ttabs$(EXEEXT) \\\n");
  fprintf(out, "\t$(THREADS) \\\n");
  fprintf(out, "\ttile$(EXEEXT) \\\n");
  fprintf(out, "\ttiled_image$(EXEEXT) \\\n");
  fprintf(out, "\ttree$(EXEEXT) \\\n");
  fprintf(out, "\tvaluators$(EXEEXT) \\\n");
  fprintf(out, "\tcairotest$(EXEEXT) \\\n");
  fprintf(out, "\tutf8$(EXEEXT) \n");
  fprintf(out, "\n");
  fprintf(out, "\n");
  fprintf(out, "GLALL = \\\n");
  fprintf(out, "\tcube$(EXEEXT) \\\n");
  fprintf(out, "\tCubeView$(EXEEXT) \\\n");
  fprintf(out, "\tfractals$(EXEEXT) \\\n");
  fprintf(out, "\tfullscreen$(EXEEXT) \\\n");
  fprintf(out, "\tgl_overlay$(EXEEXT) \\\n");
  fprintf(out, "\tglpuzzle$(EXEEXT) \\\n");
  fprintf(out, "\tshape$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "all:\t$(ALL) $(GLDEMOS)\n");
  fprintf(out, "\n");
  fprintf(out, "gldemos:\t$(GLALL)\n");
  fprintf(out, "\n");
  fprintf(out, "depend:\t$(CPPFILES)\n");
  fprintf(out, "\tmakedepend -Y -I.. -f makedepend $(CPPFILES)\n");
  fprintf(out, "\n");
  fprintf(out, "# Automatically generated dependencies...\n");
  fprintf(out, "include makedepend\n");
  fprintf(out, "\n");
  fprintf(out, "clean:\n");
  fprintf(out, "\t$(RM) $(ALL) $(GLALL) core\n");
  fprintf(out, "\t$(RM) *.o core.* *~ *.bck *.bak\n");
  fprintf(out, "\t$(RM) CubeViewUI.cxx CubeViewUI.h\n");
  fprintf(out, "\t$(RM) fast_slow.cxx fast_slow.h\n");
  fprintf(out, "\t$(RM) inactive.cxx inactive.h\n");
  fprintf(out, "\t$(RM) keyboard_ui.cxx keyboard_ui.h\n");
  fprintf(out, "\t$(RM) mandelbrot_ui.cxx mandelbrot_ui.h\n");
  fprintf(out, "\t$(RM) preferences.cxx preferences.h\n");
  fprintf(out, "\t$(RM) radio.cxx radio.h\n");
  fprintf(out, "\t$(RM) resize.cxx resize.h\n");
  fprintf(out, "\t$(RM) tabs.cxx tabs.h\n");
  fprintf(out, "\t$(RM) tree.cxx tree.h\n");
  fprintf(out, "\t$(RM) valuators.cxx valuators.h\n");
  fprintf(out, "\t$(OSX_ONLY) $(RM) blocks.app/Contents/MacOS/blocks$(EXEEXT)\n");
  fprintf(out, "\t$(OSX_ONLY) $(RM) checkers.app/Contents/MacOS/checkers$(EXEEXT)\n");
  fprintf(out, "\t$(OSX_ONLY) $(RM) sudoku.app/Contents/MacOS/sudoku$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "install:\tall\n");
  fprintf(out, "\techo \"Installing example programs to $(DESTDIR)$(docdir)/examples...\"\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)$(docdir)/examples\n");
  fprintf(out, "\tfor file in *.h *.cxx *.fl demo.menu; do \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) $$file $(DESTDIR)$(docdir)/examples; \\\n");
  fprintf(out, "\tdone\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)$(docdir)/examples/pixmaps\n");
  fprintf(out, "\tfor file in pixmaps/*.xbm pixmaps/*.xpm; do \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) $$file $(DESTDIR)$(docdir)/examples/pixmaps; \\\n");
  fprintf(out, "\tdone\n");
  fprintf(out, "\n");
  fprintf(out, "install-linux:\n");
  fprintf(out, "\techo Installing games to $(DESTDIR)$(bindir)...\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)$(bindir)\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/usr/share/applications\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/usr/share/icons/hicolor/32x32/apps\n");
  fprintf(out, "\t-$(INSTALL_DIR) $(DESTDIR)/usr/share/icons/hicolor/128x128/apps\n");
  fprintf(out, "\tfor game in blocks checkers sudoku; do \\\n");
  fprintf(out, "\t\t$(INSTALL_BIN) $$game $(DESTDIR)$(bindir); \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) desktop/$$game.desktop  $(DESTDIR)/usr/share/applications; \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) desktop/$$game-32.png $(DESTDIR)/usr/share/icons/hicolor/32x32/apps/$$game.png; \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) desktop/$$game-128.png $(DESTDIR)/usr/share/icons/hicolor/128x128/apps/$$game.png; \\\n");
  fprintf(out, "\tdone\n");
  fprintf(out, "\n");
  fprintf(out, "install-osx:\n");
  fprintf(out, "\techo Installing games in $(DESTDIR)/Applications...\n");
  fprintf(out, "\tfor game in blocks checkers sudoku; do \\\n");
  fprintf(out, "\t\tif test ! -d $(DESTDIR)/Applications/$$game.app; then \\\n");
  fprintf(out, "\t\t\t$(INSTALL_DIR) $(DESTDIR)/Applications/$$game.app; \\\n");
  fprintf(out, "\t\t\t$(INSTALL_DIR) $(DESTDIR)/Applications/$$game.app/Contents; \\\n");
  fprintf(out, "\t\t\t$(INSTALL_DIR) $(DESTDIR)/Applications/$$game.app/Contents/MacOS; \\\n");
  fprintf(out, "\t\t\t$(INSTALL_DIR) $(DESTDIR)/Applications/$$game.app/Contents/Resources; \\\n");
  fprintf(out, "\t\tfi; \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) $$game.app/Contents/Info.plist $(DESTDIR)/Applications/$$game.app/Contents; \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) $$game.app/Contents/PkgInfo $(DESTDIR)/Applications/$$game.app/Contents; \\\n");
  fprintf(out, "\t\t$(INSTALL_BIN) $$game.app/Contents/MacOS/$$game $(DESTDIR)/Applications/$$game.app/Contents/MacOS; \\\n");
  fprintf(out, "\t\t$(INSTALL_DATA) $$game.app/Contents/Resources/$$game.icns $(DESTDIR)/Applications/$$game.app/Contents/Resources; \\\n");
  fprintf(out, "\tdone\n");
  fprintf(out, "\n");
  fprintf(out, "uninstall:\n");
  fprintf(out, "\techo \"Removing examples programs from $(DESTDIR)$(docdir)/examples...\"\n");
  fprintf(out, "\t-$(RMDIR) $(DESTDIR)$(docdir)/examples\n");
  fprintf(out, "\n");
  fprintf(out, "uninstall-linux:\n");
  fprintf(out, "\techo Removing games from $(DESTDIR)$(bindir)...\n");
  fprintf(out, "\tfor game in blocks checkers sudoku; do \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)$(bindir)/$$game; \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)/usr/share/applications/$$game.desktop; \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)/usr/share/icons/hicolor/32x32/apps/$$game.png; \\\n");
  fprintf(out, "\t\t$(RM) $(DESTDIR)/usr/share/icons/hicolor/128x128/apps/$$game.png; \\\n");
  fprintf(out, "\tdone\n");
  fprintf(out, "\n");
  fprintf(out, "uninstall-osx:\n");
  fprintf(out, "\techo Removing games from $(DESTDIR)/Applications...\n");
  fprintf(out, "\t$(RMDIR) $(DESTDIR)/Applications/blocks.app\n");
  fprintf(out, "\t$(RMDIR) $(DESTDIR)/Applications/checkers.app\n");
  fprintf(out, "\t$(RMDIR) $(DESTDIR)/Applications/sudoku.app\n");
  fprintf(out, "\n");
  fprintf(out, "# FLUID file rules\n");
  fprintf(out, ".fl.cxx .fl.h:\t../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\techo Generating $@ and header from $<...\n");
  fprintf(out, "\t../fluid/fluid$(EXEEXT) -c $<\n");
  fprintf(out, "\n");
  fprintf(out, "# All demos depend on the FLTK library...\n");
  fprintf(out, "$(ALL): $(FLTK_LIBNAME)\n");
  fprintf(out, "\n");
  fprintf(out, "# General demos...\n");
  fprintf(out, "unittests$(EXEEXT): unittests.o\n");
  fprintf(out, "\n");
  fprintf(out, "unittests.cxx: unittest_about.cxx unittest_points.cxx unittest_lines.cxx unittest_circles.cxx \\\n");
  fprintf(out, "\tunittest_rects.cxx unittest_text.cxx unittest_viewport.cxx unittest_images.cxx\n");
  fprintf(out, "\n");
  fprintf(out, "adjuster$(EXEEXT): adjuster.o\n");
  fprintf(out, "\n");
  fprintf(out, "arc$(EXEEXT): arc.o\n");
  fprintf(out, "\n");
  fprintf(out, "ask$(EXEEXT): ask.o\n");
  fprintf(out, "\n");
  fprintf(out, "bitmap$(EXEEXT): bitmap.o\n");
  fprintf(out, "\n");
  fprintf(out, "boxtype$(EXEEXT): boxtype.o\n");
  fprintf(out, "\n");
  fprintf(out, "browser$(EXEEXT): browser.o\n");
  fprintf(out, "\n");
  fprintf(out, "button$(EXEEXT): button.o\n");
  fprintf(out, "\n");
  fprintf(out, "buttons$(EXEEXT): buttons.o\n");
  fprintf(out, "\n");
  fprintf(out, "blocks$(EXEEXT): blocks.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) blocks.o -o $@ $(AUDIOLIBS) $(LINK_FLTK) $(LDLIBS)\n");
  fprintf(out, "\t$(OSX_ONLY) $(INSTALL_BIN) blocks$(EXEEXT) blocks.app/Contents/MacOS\n");
  fprintf(out, "\n");
  fprintf(out, "checkers$(EXEEXT): checkers.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) checkers.o -o $@ $(LINK_FLTK) $(LDLIBS)\n");
  fprintf(out, "\t$(OSX_ONLY) $(INSTALL_BIN) checkers$(EXEEXT) checkers.app/Contents/MacOS\n");
  fprintf(out, "\n");
  fprintf(out, "clock$(EXEEXT): clock.o\n");
  fprintf(out, "\n");
  fprintf(out, "colbrowser$(EXEEXT): colbrowser.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ colbrowser.o $(LINK_FLTK) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "color_chooser$(EXEEXT): color_chooser.o\n");
  fprintf(out, "\n");
  fprintf(out, "cursor$(EXEEXT): cursor.o\n");
  fprintf(out, "\n");
  fprintf(out, "curve$(EXEEXT): curve.o\n");
  fprintf(out, "\n");
  fprintf(out, "demo$(EXEEXT): demo.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ demo.o $(LINK_FLTK) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "device$(EXEEXT): device.o $(FLTK_IMAGES_LIBNAME)\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) device.o -o $@ $(LINK_FLTK_IMAGES) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "doublebuffer$(EXEEXT): doublebuffer.o\n");
  fprintf(out, "\n");
  fprintf(out, "editor$(EXEEXT): editor.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) editor.o -o $@ $(LINK_FLTK_IMAGES) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "fast_slow$(EXEEXT): fast_slow.o\n");
  fprintf(out, "fast_slow.cxx:\tfast_slow.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "file_chooser$(EXEEXT): file_chooser.o $(FLTK_IMAGES_LIBNAME)\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) file_chooser.o -o $@ $(LINK_FLTK_IMAGES) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "fonts$(EXEEXT): fonts.o\n");
  fprintf(out, "\n");
  fprintf(out, "hello$(EXEEXT): hello.o\n");
  fprintf(out, "\n");
  fprintf(out, "help$(EXEEXT): help.o $(FLTK_IMAGES_LIBNAME)\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) help.o -o $@ $(LINK_FLTK_IMAGES) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "iconize$(EXEEXT): iconize.o\n");
  fprintf(out, "\n");
  fprintf(out, "image$(EXEEXT): image.o\n");
  fprintf(out, "\n");
  fprintf(out, "inactive$(EXEEXT): inactive.o\n");
  fprintf(out, "inactive.cxx:\tinactive.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "input$(EXEEXT): input.o\n");
  fprintf(out, "\n");
  fprintf(out, "input_choice$(EXEEXT): input_choice.o\n");
  fprintf(out, "\n");
  fprintf(out, "keyboard$(EXEEXT): keyboard_ui.o keyboard.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ keyboard.o keyboard_ui.o $(LINK_FLTK) $(LDLIBS)\n");
  fprintf(out, "keyboard_ui.o:\tkeyboard_ui.h\n");
  fprintf(out, "keyboard_ui.cxx:\tkeyboard_ui.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "label$(EXEEXT): label.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ label.o $(LINK_FLTK) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "line_style$(EXEEXT): line_style.o\n");
  fprintf(out, "\n");
  fprintf(out, "list_visuals$(EXEEXT): list_visuals.o\n");
  fprintf(out, "\n");
  fprintf(out, "mandelbrot$(EXEEXT): mandelbrot_ui.o mandelbrot.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ mandelbrot.o mandelbrot_ui.o $(LINK_FLTK) $(LDLIBS)\n");
  fprintf(out, "mandelbrot_ui.o:\tmandelbrot_ui.h\n");
  fprintf(out, "mandelbrot_ui.cxx:\tmandelbrot_ui.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "menubar$(EXEEXT): menubar.o\n");
  fprintf(out, "\n");
  fprintf(out, "message$(EXEEXT): message.o\n");
  fprintf(out, "\n");
  fprintf(out, "minimum$(EXEEXT): minimum.o\n");
  fprintf(out, "\n");
  fprintf(out, "native-filechooser$(EXEEXT): native-filechooser.o $(FLTK_IMAGES_LIBNAME)\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) native-filechooser.o -o $@ $(LINK_FLTK_IMAGES) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "navigation$(EXEEXT): navigation.o\n");
  fprintf(out, "\n");
  fprintf(out, "output$(EXEEXT): output.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ output.o $(LINK_FLTK) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "overlay$(EXEEXT): overlay.o\n");
  fprintf(out, "\n");
  fprintf(out, "pack$(EXEEXT): pack.o\n");
  fprintf(out, "\n");
  fprintf(out, "pixmap$(EXEEXT): pixmap.o\n");
  fprintf(out, "\n");
  fprintf(out, "pixmap_browser$(EXEEXT): pixmap_browser.o $(FLTK_IMAGES_LIBNAME)\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) pixmap_browser.o -o $@ $(LINK_FLTK_IMAGES) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "preferences$(EXEEXT):\tpreferences.o\n");
  fprintf(out, "preferences.cxx:\tpreferences.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "device$(EXEEXT): device.o\n");
  fprintf(out, "\n");
  fprintf(out, "radio$(EXEEXT): radio.o\n");
  fprintf(out, "radio.cxx:\tradio.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "resize$(EXEEXT): resize.o\n");
  fprintf(out, "resize.cxx:\tresize.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "resizebox$(EXEEXT): resizebox.o\n");
  fprintf(out, "\n");
  fprintf(out, "rotated_text$(EXEEXT): rotated_text.o\n");
  fprintf(out, "\n");
  fprintf(out, "scroll$(EXEEXT): scroll.o\n");
  fprintf(out, "\n");
  fprintf(out, "subwindow$(EXEEXT): subwindow.o\n");
  fprintf(out, "\n");
  fprintf(out, "sudoku: sudoku.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) sudoku.o -o $@ $(AUDIOLIBS) $(LINK_FLTK_IMAGES) $(LDLIBS)\n");
  fprintf(out, "\t$(OSX_ONLY) $(INSTALL_BIN) sudoku$(EXEEXT) sudoku.app/Contents/MacOS\n");
  fprintf(out, "\n");
  fprintf(out, "sudoku.exe: sudoku.o sudoku.rc\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(RC) sudoku.rc sudokures.o\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) sudoku.o sudokures.o -o $@ $(AUDIOLIBS) $(LINK_FLTK_IMAGES) $(LDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "symbols$(EXEEXT): symbols.o\n");
  fprintf(out, "\n");
  fprintf(out, "table$(EXEEXT): table.o\n");
  fprintf(out, "\n");
  fprintf(out, "tabs$(EXEEXT): tabs.o\n");
  fprintf(out, "tabs.cxx:\ttabs.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "threads$(EXEEXT): threads.o\n");
  fprintf(out, "# This ensures that we have this dependency even if threads are not\n");
  fprintf(out, "# enabled in the current tree...\n");
  fprintf(out, "threads.o:\tthreads.h\n");
  fprintf(out, "\n");
  fprintf(out, "tile$(EXEEXT): tile.o\n");
  fprintf(out, "\n");
  fprintf(out, "tiled_image$(EXEEXT): tiled_image.o\n");
  fprintf(out, "\n");
  fprintf(out, "tree$(EXEEXT): tree.o\n");
  fprintf(out, "tree.cxx:\ttree.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "valuators$(EXEEXT): valuators.o\n");
  fprintf(out, "valuators.cxx:\tvaluators.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "# All OpenGL demos depend on the FLTK and FLTK_GL libraries...\n");
  fprintf(out, "$(GLALL): $(FLTK_LIBNAME) $(FLTK_GL_LIBNAME)\n");
  fprintf(out, "\n");
  fprintf(out, "# OpenGL demos...\n");
  fprintf(out, "CubeView$(EXEEXT): CubeMain.o CubeView.o CubeViewUI.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ \\\n");
  fprintf(out, "\t\tCubeMain.o CubeView.o CubeViewUI.o \\\n");
  fprintf(out, "\t\t$(LINK_FLTK_GL) $(LINK_FLTK) $(GLDLIBS)\n");
  fprintf(out, "CubeMain.o: CubeViewUI.h CubeView.h CubeViewUI.cxx\n");
  fprintf(out, "CubeView.o: CubeView.h\n");
  fprintf(out, "CubeViewUI.o:\tCubeViewUI.cxx CubeViewUI.h\n");
  fprintf(out, "CubeViewUI.cxx:\tCubeViewUI.fl ../fluid/fluid$(EXEEXT)\n");
  fprintf(out, "\n");
  fprintf(out, "cube$(EXEEXT): cube.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ cube.o $(LINK_FLTK_GL) $(LINK_FLTK) $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "fractals$(EXEEXT): fractals.o fracviewer.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ fractals.o fracviewer.o $(LINK_FLTK_GL) $(LINK_FLTK) $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "fullscreen$(EXEEXT): fullscreen.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ fullscreen.o $(LINK_FLTK_GL) $(LINK_FLTK) $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "glpuzzle$(EXEEXT): glpuzzle.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ glpuzzle.o $(LINK_FLTK_GL) $(LINK_FLTK) $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "gl_overlay$(EXEEXT): gl_overlay.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ gl_overlay.o $(LINK_FLTK_GL) $(LINK_FLTK) $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "shape$(EXEEXT): shape.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(LDFLAGS) -o $@ shape.o $(LINK_FLTK_GL) $(LINK_FLTK) $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "cairo_test$(EXEEXT): cairo_test.o\n");
  fprintf(out, "\techo Linking $@...\n");
  fprintf(out, "\t$(CXX) $(ARCHFLAGS) $(CAIROFLAGS) $(LDFLAGS) -o $@ cairo_test.o $(LINK_FLTK) $(LINKFLTKCAIRO) $(GLDLIBS)\n");
  fprintf(out, "\n");
  fprintf(out, "#\n");
  fprintf(out, "# End of \"$Id: Makefile 8740 2011-05-26 14:43:46Z matt $\".\n");
  fprintf(out, "#\n");

  return 0;
}
#endif



static int write_makefile(Fl_Workspace_Type *workspace, const char *path, Fl_Target_Type *first_target) {

  char buf[2048], base_dir[2048], tgt_base[2048];
  strcpy(base_dir, filename);
  *((char*)fltk3::filename_name(base_dir)) = 0; // keep only the path
  strcpy(tgt_base, base_dir);
  strcat(tgt_base, path); strcat(tgt_base, "/");
  strcpy(buf, tgt_base);
  strcat(buf, "Makefile");
  FILE *out = fopen(buf, "wb");

  if (strcmp(path, "test")==0) {
    write_test_makefile(out, workspace, path, base_dir, tgt_base, first_target);
  } else if (strcmp(path, "fluid")==0) {
    write_fluid_makefile(out, workspace, path, base_dir, tgt_base, first_target);
  } else if (strcmp(path, "src")==0) {
    write_fltk_makefile(out, workspace, path, base_dir, tgt_base, first_target);
  } 
  
  fclose(out);
    
  return 0;
}


int write_fltk_makefiles() {
  Fl_Target_Type *tgt;
  Fl_Workspace_Type *workspace = (Fl_Workspace_Type*)Fl_Type::first;
  
  char buf[2048], base_dir[2048];
  strcpy(base_dir, filename);
  *((char*)fltk3::filename_name(base_dir)) = 0; // keep only the path
  
  strcpy(buf, base_dir);
  strcat(buf, "makeinclude.in");  
  FILE *out = fopen(buf, "wb");
  write_makeinclude_in(out, workspace, 0, 0, 0, 0);
  fclose(out);
  
  strcpy(buf, base_dir);
  strcat(buf, "configure.in");  
  out = fopen(buf, "wb");
  write_configure_in(out, workspace, 0, 0, 0, 0);
  fclose(out);
  
  // clear all flags that mark the targets that we wrote already
  for (tgt=Fl_Target_Type::first_target(workspace); tgt; tgt = tgt->next_target(workspace)) {
    tgt->clear_flags(1);
  }  

  // walk through all targets an find the directories that need Makefiles
  for (;;) {
    const char *current_path = 0;
    char done = 1;
    for (tgt=Fl_Target_Type::first_target(workspace); tgt; tgt = tgt->next_target(workspace)) {
      if (tgt->builds_in(FL_ENV_MAKE) && (tgt->flags()&1)==0) { // target not yet written
        if (current_path==0) {
          current_path = tgt->makefile_path();
          write_makefile(workspace, current_path, tgt);
          done = 0;
          tgt->set_flags(1);
        } else if (strcmp(current_path, tgt->makefile_path())==0) {
          tgt->set_flags(1);
        }
      }
    }
    if (done) break;
  }

  return 0;
}



//
// End of "$Id: file.cxx 8870 2011-07-26 21:19:35Z matt $".
//
